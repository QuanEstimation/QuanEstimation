
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docs of QuanEstimation">
      
      
        <meta name="author" content="QuanEstimation">
      
      
        <link rel="canonical" href="https://quanestimation.github.io/QuanEstimation/guide/guide_Mopt/">
      
      
        <link rel="prev" href="../guide_Sopt/">
      
      
        <link rel="next" href="../guide_Compopt/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Measurement optimization - QuanEstimation Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/style.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/julia_api.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#measurement-optimization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="QuanEstimation Docs" class="md-header__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.92 7.92 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.92 7.92 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.92 7.92 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.92 7.92 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69zM12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuanEstimation Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Measurement optimization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../guide_import/" class="md-tabs__link">
          
  
  
  Users Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../API/python/classes/" class="md-tabs__link">
          
  
  
  API documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../citing/" class="md-tabs__link">
        
  
  
    
  
  Citing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/" class="md-tabs__link">
        
  
  
    
  
  Developers

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="QuanEstimation Docs" class="md-nav__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.92 7.92 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.92 7.92 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.92 7.92 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.92 7.92 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69zM12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"/></svg>

    </a>
    QuanEstimation Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Users Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Users Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameterization process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_bounds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum metrological tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrological resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Copt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Sopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Measurement optimization
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Measurement optimization
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pso" class="md-nav__link">
    <span class="md-ellipsis">
      PSO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de" class="md-nav__link">
    <span class="md-ellipsis">
      DE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ad" class="md-nav__link">
    <span class="md-ellipsis">
      AD
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    <span class="md-ellipsis">
      Bibliography
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Compopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comprehensive optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_adaptive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adaptive measurement schemes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../output_files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Output files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/julia/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Julia
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../citing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Citing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developers
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pso" class="md-nav__link">
    <span class="md-ellipsis">
      PSO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de" class="md-nav__link">
    <span class="md-ellipsis">
      DE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ad" class="md-nav__link">
    <span class="md-ellipsis">
      AD
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    <span class="md-ellipsis">
      Bibliography
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="measurement-optimization"><strong>Measurement optimization</strong><a class="headerlink" href="#measurement-optimization" title="Permanent link">&para;</a></h1>
<p>In QuanEstimation, three measurement optimization scenarios are considered. The first one
is to optimize a set of rank-one projective measurement, it can be written in a specific
basis <span class="arithmatex">\(\{|\phi_i\rangle\}\)</span> with <span class="arithmatex">\(|\phi_i\rangle=\sum_j C_{ij}|j\rangle\)</span> in the Hilbert space 
as <span class="arithmatex">\(\{|\phi_i\rangle\langle\phi_i|\}\)</span>. In this case, the goal is to search a set of optimal 
coefficients <span class="arithmatex">\(C_{ij}\)</span>. The second scenario is to find the optimal linear combination of 
an input measurement <span class="arithmatex">\(\{\Pi_j\}\)</span>. The third scenario is to find the optimal rotated 
measurement of an input measurement. After rotation, the new measurement is
<span class="arithmatex">\(\{U\Pi_i U^{\dagger}\}\)</span>, where <span class="arithmatex">\(U=\prod_k \exp(i s_k\lambda_k)\)</span> with <span class="arithmatex">\(\lambda_k\)</span> a SU(<span class="arithmatex">\(N\)</span>) 
generator and <span class="arithmatex">\(s_k\)</span> a real number in the regime <span class="arithmatex">\([0,2\pi]\)</span>. In this scenario, the goal is 
to search a set of optimal coefficients <span class="arithmatex">\(s_k\)</span>. Here different algorithms are invoked to 
search the optimal measurement include particle swarm optimization (PSO) <a href="#Kennedy1995">[1]</a>, 
differential evolution (DE) <a href="#Storn1997">[2]</a>, and automatic differentiation (AD) 
<a href="#Baydin2018">[3]</a>. The codes for execute measurement optimization are</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python</label><label for="__tabbed_1_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">Hc</span><span class="o">=</span><span class="p">[],</span> <span class="n">ctrl</span><span class="o">=</span><span class="p">[],</span> <span class="n">decay</span><span class="o">=</span><span class="p">[],</span> \
           <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
<code>mtype</code> represents the type of measurement optimization which defaults to <code>"projection"</code>. 
In this setting, rank-one projective measurement optimization will be performed <code>minput</code> 
will keep empty in this scenario. For the other two measurement optimization scenarios 
<code>mtype="input"</code>. If the users want to find the optimal linear combination of an input 
measurement, the variable <code>minput</code> should be input as <code>minput=["LC", [Pi1,Pi2,...], m]</code> 
with <code>[Pi1,Pi2,...]</code> a set of POVM and <code>m</code> the number of operators of the output 
measurement. For finding the optimal linear combination of an input measurement, the 
variable <code>minput</code> becomes <code>minput=["rotation", [Pi1,Pi2,...]]</code>. <code>savefile</code> means whether 
to save all the measurements. If set <code>False</code> the measurements in the final episode and 
the values of the objective function in all episodes will be saved, if <code>savefile=True</code> 
the measurements and the values of the objective function obtained in all episodes will 
be saved during the training. <code>method</code> represents the algorithm used to optimize the 
measurements, options are: "PSO", "DE" and "AD". <code>**kwargs</code> is the keyword and default 
value corresponding to the optimization algorithm which will be introduced in detail 
below.</p>
<p>If the dynamics of the system can be described by the master equation, then the dynamics data 
<code>tspan</code>, <code>rho0</code>, <code>H0</code> and <code>dH</code> shoule be input. <code>tspan</code> is the time length for the evolution, 
<code>rho0</code> represents the density matrix of the initial state, <code>H0</code> and <code>dH</code> are the free 
Hamiltonian and its derivatives on the unknown parameters to be estimated. <code>H0</code> is a matrix 
when the free Hamiltonian is time-independent and a list of matrices with the length equal to 
<code>tspan</code> when it is time-dependent. <code>dH</code> should be input as <span class="arithmatex">\([\partial_a{H_0}, \partial_b{H_0}, \cdots]\)</span>. 
<code>Hc</code> and <code>ctrl</code> are two lists represent the control Hamiltonians and the corresponding control 
coefficients. <code>decay</code> contains decay operators <span class="arithmatex">\((\Gamma_1,\Gamma_2, \cdots)\)</span> and the 
corresponding decay rates <span class="arithmatex">\((\gamma_1, \gamma_2, \cdots)\)</span> with the input rule 
decay=[[<span class="arithmatex">\(\Gamma_1\)</span>, <span class="arithmatex">\(\gamma_1\)</span>], [<span class="arithmatex">\(\Gamma_2\)</span>, <span class="arithmatex">\(\gamma_2\)</span>],...]. The default values for <code>decay</code>, 
<code>Hc</code> and <code>ctrl</code> are empty which means the dynamics is unitary and only governed by the free 
Hamiltonian. <code>dyn_method="expm"</code> represents the method for solving the dynamics is 
matrix exponential, it can also be set as <code>dyn_method="ode"</code> which means the dynamics 
(differential equation) is directly solved with the ODE solvers.</p>
<p>The objective function for measurement optimization are CFI and <span class="arithmatex">\(\mathrm{Tr}(W\mathcal{I}^
{-1})\)</span> with <span class="arithmatex">\(\mathcal{I}\)</span> the CFIM. <span class="arithmatex">\(W\)</span> corresponds to <code>W</code> in the objective function is the 
weight matrix which defaults to the identity matrix.</p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Projection</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DE</span><span class="p">(</span><span class="n">kwargs</span><span class="o">...</span><span class="p">)</span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">;</span><span class="w"> </span><span class="n">Hc</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">ctrl</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">dyn_method</span><span class="o">=</span><span class="ss">:Expm</span><span class="p">)</span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CFIM_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
<code>mtype</code> represents the type of measurement optimization which defaults to <code>"Projection"</code>. 
In this setting, rank-one projective measurement optimization will be performed. For the other 
two measurement optimization scenarios this variable becomes <code>mtype="LC"</code> and <code>mtype="Rotation"</code>. 
If the users want to find the optimal linear combination of an input measurement, the input 
rule of <code>opt</code> is <code>MeasurementOpt(mtype=:LC,POVM_basis=[Pi1,Pi2,...],M_num=m)</code> with 
<code>[Pi1,Pi2,...]</code> a set of POVM and <code>m</code> the number of operators of the output measurement. 
For finding the optimal linear combination of an input measurement, the code <code>opt</code> is 
<code>MeasurementOpt(mtype=:LC,POVM_basis=[Pi1,Pi2,...])</code>.  <code>seed</code> is the random seed which can 
ensure the reproducibility of results.</p>
<p>If the dynamics of the system can be described by the master equation, then the dynamics data 
<code>tspan</code>, <code>rho0</code>, <code>H0</code> and <code>dH</code> shoule be input. <code>tspan</code> is the time length for the evolution, 
<code>rho0</code> represents the density matrix of the initial state, <code>H0</code> and <code>dH</code> are the free 
Hamiltonian and its derivatives on the unknown parameters to be estimated. <code>H0</code> is a matrix 
when the free Hamiltonian is time-independent and a list of matrices with the length equal to 
<code>tspan</code> when it is time-dependent. <code>dH</code> should be input as <span class="arithmatex">\([\partial_a{H_0}, \partial_b{H_0}, \cdots]\)</span>. 
<code>Hc</code> and <code>ctrl</code> are two lists represent the control Hamiltonians and the corresponding control 
coefficients. <code>decay</code> contains decay operators <span class="arithmatex">\((\Gamma_1,\Gamma_2, \cdots)\)</span> and the 
corresponding decay rates <span class="arithmatex">\((\gamma_1, \gamma_2, \cdots)\)</span> with the input rule 
decay=[[<span class="arithmatex">\(\Gamma_1\)</span>, <span class="arithmatex">\(\gamma_1\)</span>], [<span class="arithmatex">\(\Gamma_2\)</span>, <span class="arithmatex">\(\gamma_2\)</span>],...]. The default values for <code>decay</code>, 
<code>Hc</code> and <code>ctrl</code> are <code>missing</code> which means the dynamics is unitary and only governed by the free 
Hamiltonian. <code>dyn_method=:Expm</code> represents the method for solving the dynamics is 
matrix exponential, it can also be set as <code>dyn_method=:Ode</code> which means the dynamics 
(differential equation) is directly solved with the ODE solvers.</p>
<p>The objective function for measurement optimization are CFI and <span class="arithmatex">\(\mathrm{Tr}(W\mathcal{I}^
{-1})\)</span> with <span class="arithmatex">\(\mathcal{I}\)</span> the CFIM. <span class="arithmatex">\(W\)</span> corresponds to <code>W</code> in the objective function is the 
weight matrix which defaults to the identity matrix. The variable <code>savefile</code> means whether to 
save all the measurements. If set <code>false</code> the measurements in the final episode and the values 
of the objective function in all episodes will be saved, if <code>savefile=true</code> the measurements 
and the values of the objective function obtained in all episodes will be saved during the 
training. The algorithm used for optimizing the measurements are PSO, DE and AD. <code>kwargs...</code> 
is the keywords and default values corresponding to the optimization algorithm which will be 
introduced in detail below.</p>
</div>
</div>
</div>
<hr />
<h2 id="pso"><strong>PSO</strong><a class="headerlink" href="#pso" title="Permanent link">&para;</a></h2>
<p>The code for measurement optimization with PSO is as follows</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Python</label><label for="__tabbed_2_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \ 
          <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of PSO can be seen in the following table</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"p_num"</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: center;">"measurement0"</td>
<td style="text-align: center;">[ ]</td>
</tr>
<tr>
<td style="text-align: center;">"max_episode"</td>
<td style="text-align: center;">[1000,100]</td>
</tr>
<tr>
<td style="text-align: center;">"c0"</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr>
<td style="text-align: center;">"c1"</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr>
<td style="text-align: center;">"c2"</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr>
<td style="text-align: center;">"seed"</td>
<td style="text-align: center;">1234</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> is the number of particles, <code>c0</code>, <code>c1</code> and <code>c2</code> are the PSO parameters 
representing the inertia weight, cognitive learning factor and social learning factor, 
respectively. <code>max_episode</code> accepts both integers and arrays with two elements. If it is 
an integer, for example <code>max_episode=1000</code>, it means the program will continuously run 
1000 episodes. However, if it is an array, for example <code>max_episode=[1000,100]</code>, the 
program will run 1000 episodes in total but replace control coefficients of all the 
particles with global best every 100 episodes. <code>seed</code> is the random seed which can 
ensure the reproducibility of the results. <code>measurement0</code> in the algorithm is a list 
representing the initial guesses of measurements. In the case of projective measurement 
optimization, the entry of <code>measurement0</code> is a list of arrays with the length equal to 
the dimension of the system. In the cases of finding the optimal linear combination and 
the optimal rotation of a given set of measurement, the entry of <code>measurement0</code> is a 
2D-array and array, respectively. Here, an example of generating <code>measurement0</code> is given 
as follows</p>
<p><strong>Example 7.1</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">projection</label><label for="__tabbed_3_2">LC</label><label for="__tabbed_3_3">rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># the dimension of the system</span>
<span class="n">dim</span> <span class="o">=</span> <span class="mi">6</span>
<span class="c1"># generation of the entry of `measurement0`</span>
<span class="n">C</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span> 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
    <span class="n">r_ini</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">r_ini</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r_ini</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
    <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.0</span><span class="n">j</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gramschmidt</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
<span class="n">measurement0</span> <span class="o">=</span> <span class="p">[</span><span class="n">C</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># the dimension of the system</span>
<span class="n">dim</span> <span class="o">=</span> <span class="mi">6</span>
<span class="c1"># a given set of measurement</span>
<span class="n">POVM_basis</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="c1"># the number of operators of the output measurement</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># generation of the entry of `measurement0`</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">POVM_basis</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)])</span>
<span class="n">measurement0</span> <span class="o">=</span> <span class="p">[</span><span class="n">B</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># the dimension of the system</span>
<span class="n">dim</span> <span class="o">=</span> <span class="mi">6</span>
<span class="c1"># a given set of measurement</span>
<span class="n">POVM_basis</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="c1"># generation of the entry of `measurement0`</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">dim</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">measurement0</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
<p>In this algorithm, the length of <code>measurement0</code> should be less than or equal to <code>p_num</code>.</p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span>
<span class="w">          </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of PSO can be seen in the following table</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"p_num"</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: center;">"ini_particle"</td>
<td style="text-align: center;">missing</td>
</tr>
<tr>
<td style="text-align: center;">"max_episode"</td>
<td style="text-align: center;">[1000,100]</td>
</tr>
<tr>
<td style="text-align: center;">"c0"</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr>
<td style="text-align: center;">"c1"</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr>
<td style="text-align: center;">"c2"</td>
<td style="text-align: center;">2.0</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> is the number of particles, <code>c0</code>, <code>c1</code>, and <code>c2</code> are the PSO parameters representing 
the inertia weight, cognitive learning factor, and social learning factor, respectively. 
<code>max_episode</code> accepts both integers and arrays with two elements. If it is an integer, 
for example <code>max_episode=1000</code>, it means the program will continuously run 1000 episodes. 
However, if it is an array, for example <code>max_episode=[1000,100]</code>, the program will run 1000 
episodes in total but replace control coefficients of all the particles with global best 
every 100 episodes. <code>ini_particle</code> in the algorithm is a list representing the initial guesses 
of measurements, In the case of projective measurement optimization, the entry of <code>ini_particle</code> 
is a list of arrays with the length equal to the dimension of the system. In the cases of 
finding the optimal linear combination and the optimal rotation of a given set of measurement, 
the entry of <code>ini_particle</code> is a 2D-array and array, respectively. Here, an example of 
generating <code>ini_particle</code> is given as follows</p>
<p><strong>Example 7.1</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Projection</label><label for="__tabbed_4_2">LC</label><label for="__tabbed_4_3">Rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="c"># the dimension of the system</span>
<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<span class="c"># generation of the entry of `measurement0`</span>
<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="kt">ComplexF64</span><span class="p">[]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">dim</span><span class="p">]</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">dim</span>
<span class="w">    </span><span class="n">r_ini</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ones</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r_ini</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">r_ini</span><span class="p">)</span>
<span class="w">    </span><span class="n">ϕ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="w">    </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="nb">im</span><span class="o">*</span><span class="n">ϕ</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">ϕ</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">ϕ</span><span class="p">)]</span><span class="w"> </span>
<span class="k">end</span>
<span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">gramschmidt</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">measurement0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">([</span><span class="n">C</span><span class="p">],)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="c"># the dimension of the system</span>
<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<span class="c"># a given set of measurement</span>
<span class="n">POVM_basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="c"># the number of operators of the output measurement</span>
<span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="c"># generation of the entry of `measurement0`</span>
<span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">rand</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">POVM_basis</span><span class="p">))</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span><span class="p">]</span>
<span class="n">measurement0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">([</span><span class="n">B</span><span class="p">],)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="c"># the dimension of the system</span>
<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<span class="c"># a given set of measurement</span>
<span class="n">POVM_basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="c"># generation of the entry of `measurement0`</span>
<span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">dim</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">measurement0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">([</span><span class="n">s</span><span class="p">],)</span>
</code></pre></div>
</div>
</div>
</div>
<p>In this algorithm, the length of <code>measurement0</code> should be less than or equal to <code>p_num</code>.</p>
</div>
</div>
</div>
<h2 id="de"><strong>DE</strong><a class="headerlink" href="#de" title="Permanent link">&para;</a></h2>
<p>The code for measurement optimization with DE is as follows</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python</label><label for="__tabbed_5_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
          <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of DE can be seen in the following table</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"p_num"</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: center;">"measurement0"</td>
<td style="text-align: center;">[ ]</td>
</tr>
<tr>
<td style="text-align: center;">"max_episode"</td>
<td style="text-align: center;">1000</td>
</tr>
<tr>
<td style="text-align: center;">"c"</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr>
<td style="text-align: center;">"cr"</td>
<td style="text-align: center;">0.5</td>
</tr>
<tr>
<td style="text-align: center;">"seed"</td>
<td style="text-align: center;">1234</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> represents the number of populations, <code>c</code> and <code>cr</code> are the mutation constant and the 
crossover constant. Here <code>max_episode</code> is an integer representing the number of episodes, 
the variable <code>measurement0</code> is the same with <code>measurement0</code> in PSO.</p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span>
<span class="w">         </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
    The keywords and the default values of DE can be seen in the following table</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"p_num"</td>
<td style="text-align: center;">10</td>
</tr>
<tr>
<td style="text-align: center;">"ini_population"</td>
<td style="text-align: center;">[ ]</td>
</tr>
<tr>
<td style="text-align: center;">"max_episode"</td>
<td style="text-align: center;">1000</td>
</tr>
<tr>
<td style="text-align: center;">"c"</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr>
<td style="text-align: center;">"cr"</td>
<td style="text-align: center;">0.5</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> represents the number of populations, <code>c</code> and <code>cr</code> are the mutation constant 
and the crossover constant. Here <code>max_episode</code> is an integer representing the number of 
episodes, the variable <code>ini_population</code> is the same with <code>ini_particle</code> in PSO.</p>
</div>
</div>
</div>
<h2 id="ad"><strong>AD</strong><a class="headerlink" href="#ad" title="Permanent link">&para;</a></h2>
<p>The code for measurement optimization with AD is as follows</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python</label><label for="__tabbed_6_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">com</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \ 
          <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of AD can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"Adam"</td>
<td style="text-align: center;">False</td>
</tr>
<tr>
<td style="text-align: center;">"measurement0"</td>
<td style="text-align: center;">[ ]</td>
</tr>
<tr>
<td style="text-align: center;">"max_episode"</td>
<td style="text-align: center;">300</td>
</tr>
<tr>
<td style="text-align: center;">"epsilon"</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr>
<td style="text-align: center;">"beta1"</td>
<td style="text-align: center;">0.90</td>
</tr>
<tr>
<td style="text-align: center;">"beta2"</td>
<td style="text-align: center;">0.99</td>
</tr>
</tbody>
</table>
<p>The measurements will update according to the learning rate <code>"epsilon"</code> for <code>Adam=False</code>, 
However,  Adam algorithm can be introduced to update the measurements which can be realized by 
setting <code>Adam=True</code>. In this case, the Adam parameters include learning rate, the exponential 
decay rate for the first moment estimates, and the second moment estimates can be set by the 
user via <code>epsilon</code>, <code>beta1</code>, and <code>beta2</code>. The input rule of <code>measurement0</code> is the same with 
that in PSO, but the length of <code>measurement0</code> is equal to one.</p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span>
<span class="w">         </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of AD can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th style="text-align: center;"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th style="text-align: center;"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">"Adam"</td>
<td style="text-align: center;">false</td>
</tr>
<tr>
<td style="text-align: center;">"max_episode"</td>
<td style="text-align: center;">300</td>
</tr>
<tr>
<td style="text-align: center;">"epsilon"</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr>
<td style="text-align: center;">"beta1"</td>
<td style="text-align: center;">0.90</td>
</tr>
<tr>
<td style="text-align: center;">"beta2"</td>
<td style="text-align: center;">0.99</td>
</tr>
</tbody>
</table>
<p>The measurements will update according to the learning rate <code>"epsilon"</code> for <code>Adam=False</code>, 
However,  Adam algorithm can be introduced to update the measurements which can be realized by 
setting <code>Adam=true</code>. In this case, the Adam parameters include learning rate, the exponential 
decay rate for the first moment estimates, and the second moment estimates can be set by the 
user via <code>epsilon</code>, <code>beta1</code>, and <code>beta2</code>.</p>
</div>
</div>
</div>
<p><strong>Example 7.2</strong><br />
<a id="example7_2"></a>
A single qubit system whose dynamics is governed by</p>
<div class="arithmatex">\[\begin{align}
\partial_t\rho=-i[H, \rho]+ \gamma_{+}\left(\sigma_{+}\rho\sigma_{-}-\frac{1}{2}\{\sigma_{-}
\sigma_{+},\rho\}\right)+ \gamma_{-}\left(\sigma_{-}\rho\sigma_{+}-\frac{1}{2}\{\sigma_{+}
\sigma_{-},\rho\}\right),
\end{align}\]</div>
<p>where <span class="arithmatex">\(H = \frac{1}{2}\omega \sigma_3\)</span> is the free Hamiltonian with <span class="arithmatex">\(\omega\)</span> the frequency, 
<span class="arithmatex">\(\sigma_{\pm}=(\sigma_1 \pm \sigma_2)/2\)</span> and <span class="arithmatex">\(\gamma_{+}\)</span>, <span class="arithmatex">\(\gamma_{-}\)</span> are decay rates.
Here <span class="arithmatex">\(\sigma_{i}\)</span> for <span class="arithmatex">\((i=1,2,3)\)</span> is the  Pauli matrix.</p>
<p>In this case, the probe state is taken as <span class="arithmatex">\(\frac{1}{\sqrt{2}}(|0\rangle +|1\rangle)\)</span>, 
<span class="arithmatex">\(|0\rangle\)</span> <span class="arithmatex">\((|1\rangle)\)</span> is the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> with respect to the eigenvalue 
<span class="arithmatex">\(1\)</span> <span class="arithmatex">\((-1)\)</span>. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python</label><label for="__tabbed_7_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">H0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span>
<span class="c1"># derivative of the free Hamiltonian on omega</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>  
<span class="n">sm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">sp</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="n">sm</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c1"># generation of a set of POVM basis</span>
<span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">rho0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">POVM_basis</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="8:3"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><input id="__tabbed_8_3" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">projection</label><label for="__tabbed_8_2">LC</label><label for="__tabbed_8_3">rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">DE</label><label for="__tabbed_9_2">PSO</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> \
             <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="10:3"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><input id="__tabbed_10_3" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">DE</label><label for="__tabbed_10_2">PSO</label><label for="__tabbed_10_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="n">M_num</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="n">M_num</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># measurement optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="n">M_num</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="11:3"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">DE</label><label for="__tabbed_11_2">PSO</label><label for="__tabbed_11_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> \
             <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
             <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">m</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
<span class="c1"># objective function: CFI</span>
<span class="n">m</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
<span class="c1"># convert the &quot;.csv&quot; file to the &quot;.npy&quot; file</span>
<span class="n">M_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;measurements.csv&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">csv2npy_measurements</span><span class="p">(</span><span class="n">M_</span><span class="p">,</span> <span class="n">M_num</span><span class="p">)</span>
<span class="c1"># load the measurements</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;measurements.npy&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">StableRNGs</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">DelimitedFiles</span>

<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c"># free Hamiltonian</span>
<span class="n">omega</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span>
<span class="c"># derivative of the free Hamiltonian on omega</span>
<span class="n">dH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span>
<span class="c"># dissipation</span>
<span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">sm</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">]]</span>
<span class="c"># generation of a set of POVM basis</span>
<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="n">POVM_basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="n">M_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">10.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">2500</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="12:3"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><input id="__tabbed_12_3" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">Projection</label><label for="__tabbed_12_2">LC</label><label for="__tabbed_12_3">Rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Projection</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">DE</label><label for="__tabbed_13_2">PSO</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:LC</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">POVM_basis</span><span class="o">=</span><span class="n">POVM_basis</span><span class="p">,</span><span class="w"> </span><span class="n">M_num</span><span class="o">=</span><span class="n">M_num</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="14:3"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><input id="__tabbed_14_3" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">DE</label><label for="__tabbed_14_2">PSO</label><label for="__tabbed_14_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: AD</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Rotation</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">POVM_basis</span><span class="o">=</span><span class="n">POVM_basis</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="15:3"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><input id="__tabbed_15_3" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">DE</label><label for="__tabbed_15_2">PSO</label><label for="__tabbed_15_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: AD</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">tspan</span><span class="w"> </span><span class="p">,</span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                   </span><span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span><span class="w"> </span><span class="n">dyn_method</span><span class="o">=</span><span class="ss">:Expm</span><span class="p">)</span>
<span class="c"># objective function: CFI</span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
<span class="c"># run the measurement optimization problem</span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>

<span class="c"># convert the flattened data into a list of matrix</span>
<span class="n">M_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readdlm</span><span class="p">(</span><span class="s">&quot;measurements.csv&quot;</span><span class="p">,</span><span class="sc">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="kt">Complex</span><span class="p">{</span><span class="kt">Float64</span><span class="p">})</span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">reshape</span><span class="p">(</span><span class="n">M_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="w"> </span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">M_num</span><span class="p">]</span><span class="w"> </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="kt">Int</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">M_</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">M_num</span><span class="p">)][</span><span class="k">end</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>Example 7.3</strong><br />
<a id="example7_3"></a>
In the multiparameter scenario, the dynamics of electron and nuclear coupling in NV<span class="arithmatex">\(^{-}\)</span> can be expressed as
\begin{align}
\partial_t\rho=-i[H_0,\rho]+\frac{\gamma}{2}(S_3\rho S_3-S^2_3\rho-\rho S^2_3)
\end{align}</p>
<p>with <span class="arithmatex">\(\gamma\)</span> the dephasing rate. And
\begin{align}
H_0/\hbar=DS^2_3+g_{\mathrm{S}}\vec{B}\cdot\vec{S}+g_{\mathrm{I}}\vec{B}\cdot\vec{I}+\vec{S}^{\,\mathrm{T}}\mathcal{A}\vec{I}
\end{align}</p>
<p>is the free evolution Hamiltonian, where <span class="arithmatex">\(\vec{S}=(S_1,S_2,S_3)^{\mathrm{T}}\)</span> and <span class="arithmatex">\(\vec{I}=(I_1,I_2,I_3)^{\mathrm{T}}\)</span> 
with <span class="arithmatex">\(S_i=s_i\otimes I\)</span> and <span class="arithmatex">\(I_i=I\otimes \sigma_i\)</span> <span class="arithmatex">\((i=1,2,3)\)</span> the electron and nuclear operators. 
<span class="arithmatex">\(s_1, s_2, s_3\)</span> are spin-1 operators with </p>
<div class="arithmatex">\[\begin{eqnarray}
s_1 = \frac{1}{\sqrt{2}}\left(\begin{array}{ccc}
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 0
\end{array}\right),
s_2 = \frac{1}{\sqrt{2}}\left(\begin{array}{ccc}
0 &amp; -i &amp; 0\\
i &amp; 0 &amp; -i\\
0 &amp; i &amp; 0
\end{array}\right), \nonumber
\end{eqnarray}\]</div>
<p>and <span class="arithmatex">\(s_3=\mathrm{diag}(1,0,-1)\)</span> and <span class="arithmatex">\(\sigma_i (i=1,2,3)\)</span> is Pauli matrix. <span class="arithmatex">\(\mathcal{A}=\mathrm{diag}
(A_1,A_1,A_2)\)</span> is the hyperfine tensor with <span class="arithmatex">\(A_1\)</span> and <span class="arithmatex">\(A_2\)</span> the axial and transverse magnetic hyperfine coupling coefficients.
The coefficients <span class="arithmatex">\(g_{\mathrm{S}}=g_\mathrm{e}\mu_\mathrm{B}/\hbar\)</span> and <span class="arithmatex">\(g_{\mathrm{I}}=g_\mathrm{n}\mu_\mathrm{n}/\hbar\)</span>, 
where <span class="arithmatex">\(g_\mathrm{e}\)</span> (<span class="arithmatex">\(g_\mathrm{n}\)</span>) is the <span class="arithmatex">\(g\)</span> factor of the electron (nuclear), <span class="arithmatex">\(\mu_\mathrm{B}\)</span> (<span class="arithmatex">\(\mu_\mathrm{n}\)</span>) is 
the Bohr (nuclear) magneton and <span class="arithmatex">\(\hbar\)</span> is the Plank's constant. <span class="arithmatex">\(\vec{B}\)</span> is the magnetic field which be estimated.</p>
<p>In this case,the initial state is taken as <span class="arithmatex">\(\frac{1}{\sqrt{2}}(|1\rangle+|\!-\!1\rangle)\otimes|\!\!\uparrow\rangle\)</span>, 
where <span class="arithmatex">\(\frac{1}{\sqrt{2}}(|1\rangle+|\!-\!1\rangle)\)</span> is an electron state with <span class="arithmatex">\(|1\rangle\)</span> (<span class="arithmatex">\(|\!-\!1\rangle\)</span>) the 
eigenstate of <span class="arithmatex">\(s_3\)</span> with respect to the eigenvalue <span class="arithmatex">\(1\)</span> (<span class="arithmatex">\(-1\)</span>). <span class="arithmatex">\(|\!\!\uparrow\rangle\)</span> is a nuclear state and 
the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> with respect to the eigenvalue 1. <span class="arithmatex">\(W\)</span> is set to be <span class="arithmatex">\(I\)</span>.</p>
<p>Here three types of measurement optimization are considerd, projective measurement, linear combination of a given set of positive operator-valued measure (POVM) and optimal rotated measurement of an input measurement.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">Python</label><label for="__tabbed_16_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">rho0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">rho0</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho0</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">ide2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">ide3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide3</span><span class="p">,</span> <span class="n">sx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide3</span><span class="p">,</span> <span class="n">sy</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide3</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">ide2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">ide2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">ide2</span><span class="p">)</span>
<span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">,</span> <span class="n">B3</span> <span class="o">=</span> <span class="mf">5.0e-4</span><span class="p">,</span> <span class="mf">5.0e-4</span><span class="p">,</span> <span class="mf">5.0e-4</span>
<span class="c1"># All numbers are divided by 100 in this example </span>
<span class="c1"># for better calculation accurancy</span>
<span class="n">cons</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.87</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">gS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">28.03</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">gI</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">4.32</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">A1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.65</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">A2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.03</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">H0</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">s3</span><span class="p">),</span> <span class="n">ide2</span><span class="p">)</span> <span class="o">+</span> <span class="n">gS</span><span class="o">*</span><span class="p">(</span><span class="n">B1</span><span class="o">*</span><span class="n">S1</span><span class="o">+</span><span class="n">B2</span><span class="o">*</span><span class="n">S2</span><span class="o">+</span><span class="n">B3</span><span class="o">*</span><span class="n">S3</span><span class="p">)</span> \
     <span class="o">+</span> <span class="n">gI</span><span class="o">*</span><span class="p">(</span><span class="n">B1</span><span class="o">*</span><span class="n">I1</span><span class="o">+</span><span class="n">B2</span><span class="o">*</span><span class="n">I2</span><span class="o">+</span><span class="n">B3</span><span class="o">*</span><span class="n">I3</span><span class="p">)</span> <span class="o">+</span> <span class="n">A1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">sx</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span> \
     <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="c1"># derivatives of the free Hamiltonian on B1, B2, and B3</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="n">gS</span><span class="o">*</span><span class="n">S1</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">I1</span><span class="p">,</span> <span class="n">gS</span><span class="o">*</span><span class="n">S2</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">I2</span><span class="p">,</span> <span class="n">gS</span><span class="o">*</span><span class="n">S3</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">I3</span><span class="p">]</span>
<span class="c1"># control Hamiltonians </span>
<span class="n">Hc</span> <span class="o">=</span> <span class="p">[</span><span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">S3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">cons</span><span class="p">]]</span>
<span class="c1"># generation of a set of POVM basis</span>
<span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">)</span>
<span class="n">POVM_basis</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> \
              <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="17:3"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><input id="__tabbed_17_3" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">projection</label><label for="__tabbed_17_2">LC</label><label for="__tabbed_17_3">rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">DE</label><label for="__tabbed_18_2">PSO</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> \
             <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="19:3"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><input id="__tabbed_19_3" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">DE</label><label for="__tabbed_19_2">PSO</label><label for="__tabbed_19_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="n">M_num</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="n">M_num</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># measurement optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="n">M_num</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="20:3"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><input id="__tabbed_20_3" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">DE</label><label for="__tabbed_20_2">PSO</label><label for="__tabbed_20_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> \
             <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
             <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span> <span class="o">=</span> <span class="n">dim</span>
<span class="c1"># measurement optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">m</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
<span class="c1"># objective function: tr(WI^{-1})</span>
<span class="n">m</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
<span class="c1"># convert the &quot;.csv&quot; file to the &quot;.npy&quot; file</span>
<span class="n">M_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;measurements.csv&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">csv2npy_measurements</span><span class="p">(</span><span class="n">M_</span><span class="p">,</span> <span class="n">M_num</span><span class="p">)</span>
<span class="c1"># load the measurements</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;measurements.npy&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">DelimitedFiles</span>

<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="kt">ComplexF64</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span>
<span class="n">rho0</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="mf">0.5</span>
<span class="c"># Hamiltonian</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">Is</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1</span><span class="p">,</span><span class="w"> </span><span class="n">I2</span><span class="p">,</span><span class="w"> </span><span class="n">I3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">sx</span><span class="p">),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">sy</span><span class="p">),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">sz</span><span class="p">)]</span>
<span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">,</span><span class="w"> </span><span class="n">S3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">))]</span>
<span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B1</span><span class="p">,</span><span class="w"> </span><span class="n">B2</span><span class="p">,</span><span class="w"> </span><span class="n">B3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.0e-4</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0e-4</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0e-4</span><span class="p">]</span>
<span class="c"># All numbers are divided by 100 in this example </span>
<span class="c"># for better calculation accurancy</span>
<span class="n">cons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">2.87</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">gS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">28.03</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">gI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">4.32</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">A1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">3.65</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">A2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">3.03</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">([</span><span class="n">D</span><span class="o">*</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">gS</span><span class="o">*</span><span class="n">B</span><span class="o">.*</span><span class="n">S</span><span class="p">),</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">gI</span><span class="o">*</span><span class="n">B</span><span class="o">.*</span><span class="n">Is</span><span class="p">),</span>
<span class="w">          </span><span class="n">A1</span><span class="o">*</span><span class="p">(</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">sx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">)),</span><span class="w"> </span><span class="n">A2</span><span class="o">*</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">)])</span>
<span class="c"># derivatives of the free Hamiltonian on B1, B2 and B3</span>
<span class="n">dH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gS</span><span class="o">*</span><span class="n">S</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">Is</span>
<span class="c"># control Hamiltonians </span>
<span class="n">Hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">,</span><span class="w"> </span><span class="n">S3</span><span class="p">]</span>
<span class="c"># dissipation</span>
<span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">S3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="nb">pi</span><span class="o">/</span><span class="n">cons</span><span class="p">]]</span>
<span class="c"># generation of a set of POVM basis</span>
<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="n">POVM_basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="o">&#39;</span><span class="w"> </span>
<span class="w">              </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">dim</span><span class="p">]</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="21:3"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><input id="__tabbed_21_2" name="__tabbed_21" type="radio" /><input id="__tabbed_21_3" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">Projection</label><label for="__tabbed_21_2">LC</label><label for="__tabbed_21_3">Rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim</span>
<span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Projection</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="22:2"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><input id="__tabbed_22_2" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">DE</label><label for="__tabbed_22_2">PSO</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:LC</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">POVM_basis</span><span class="o">=</span><span class="n">POVM_basis</span><span class="p">,</span><span class="w"> </span><span class="n">M_num</span><span class="o">=</span><span class="n">M_num</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="23:3"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><input id="__tabbed_23_2" name="__tabbed_23" type="radio" /><input id="__tabbed_23_3" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">DE</label><label for="__tabbed_23_2">PSO</label><label for="__tabbed_23_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: AD</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">M_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim</span>
<span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Rotation</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">POVM_basis</span><span class="o">=</span><span class="n">POVM_basis</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="24:3"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><input id="__tabbed_24_2" name="__tabbed_24" type="radio" /><input id="__tabbed_24_3" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">DE</label><label for="__tabbed_24_2">PSO</label><label for="__tabbed_24_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: AD</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">tspan</span><span class="w"> </span><span class="p">,</span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                   </span><span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span><span class="w"> </span><span class="n">dyn_method</span><span class="o">=</span><span class="ss">:Expm</span><span class="p">)</span>
<span class="c"># objective function: CFI</span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
<span class="c"># run the measurement optimization problem</span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="n">M_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readdlm</span><span class="p">(</span><span class="s">&quot;measurements.csv&quot;</span><span class="p">,</span><span class="sc">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="kt">Complex</span><span class="p">{</span><span class="kt">Float64</span><span class="p">})</span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">reshape</span><span class="p">(</span><span class="n">M_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="w"> </span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">M_num</span><span class="p">]</span><span class="w"> </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="kt">Int</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">M_</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">M_num</span><span class="p">)][</span><span class="k">end</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
<p>If the parameterization process is implemented with the Kraus operators, then the corresponding 
parameters should be input via</p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:2"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><input id="__tabbed_25_2" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">Python</label><label for="__tabbed_25_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Projection</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DE</span><span class="p">(</span><span class="n">kwargs</span><span class="o">...</span><span class="p">)</span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kraus</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">dK</span><span class="p">)</span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CFIM_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>where <code>K</code> and <code>dK</code> are the Kraus operators and its derivatives with respect to the 
unknown parameters.</p>
<p><strong>Example 7.4</strong><br />
The Kraus operators for the amplitude damping channel are</p>
<div class="arithmatex">\[\begin{eqnarray}
K_1 = \left(\begin{array}{cc}
1 &amp; 0  \\
0 &amp; \sqrt{1-\gamma}
\end{array}\right),
K_2 = \left(\begin{array}{cc}
0 &amp; \sqrt{\gamma} \\
0 &amp; 0
\end{array}\right), \nonumber
\end{eqnarray}\]</div>
<p>where <span class="arithmatex">\(\gamma\)</span> is the unknown parameter to be estimated which represents the decay 
probability. In this example, the probe state is taken as <span class="arithmatex">\(|+\rangle\langle+|\)</span> with 
<span class="arithmatex">\(|+\rangle=\frac{1}{\sqrt{2}}(|0\rangle+|1\rangle)\)</span>. Here <span class="arithmatex">\(|0\rangle\)</span> <span class="arithmatex">\((|1\rangle)\)</span> is 
the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> (Pauli matrix) with respect to the eigenvalue <span class="arithmatex">\(1\)</span> <span class="arithmatex">\((-1)\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:2"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><input id="__tabbed_26_2" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">Python</label><label for="__tabbed_26_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># Kraus operators for the amplitude damping channel</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">K1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]])</span>
<span class="n">K2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">)],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="n">K1</span><span class="p">,</span> <span class="n">K2</span><span class="p">]</span>
<span class="c1"># derivatives of Kraus operators on gamma</span>
<span class="n">dK1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]])</span>
<span class="n">dK2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">)],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">dK</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dK1</span><span class="p">],</span> <span class="p">[</span><span class="n">dK2</span><span class="p">]]</span>
<span class="c1"># measurement</span>
<span class="n">POVM_basis</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">))</span>
<span class="n">M_num</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="27:3"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><input id="__tabbed_27_2" name="__tabbed_27" type="radio" /><input id="__tabbed_27_3" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">projection</label><label for="__tabbed_27_2">LC</label><label for="__tabbed_27_3">rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="28:2"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><input id="__tabbed_28_2" name="__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="__tabbed_28_1">DE</label><label for="__tabbed_28_2">PSO</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> \
             <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> \
                   <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="29:3"><input checked="checked" id="__tabbed_29_1" name="__tabbed_29" type="radio" /><input id="__tabbed_29_2" name="__tabbed_29" type="radio" /><input id="__tabbed_29_3" name="__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="__tabbed_29_1">DE</label><label for="__tabbed_29_2">PSO</label><label for="__tabbed_29_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LC&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="30:3"><input checked="checked" id="__tabbed_30_1" name="__tabbed_30" type="radio" /><input id="__tabbed_30_2" name="__tabbed_30" type="radio" /><input id="__tabbed_30_3" name="__tabbed_30" type="radio" /><div class="tabbed-labels"><label for="__tabbed_30_1">DE</label><label for="__tabbed_30_2">PSO</label><label for="__tabbed_30_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> \
             <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
             <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># measurement optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;measurement0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">minput</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span> <span class="n">POVM_basis</span><span class="p">],</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">m</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
<span class="c1"># objective function: CFI</span>
<span class="n">m</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
<span class="c1"># convert the &quot;.csv&quot; file to the &quot;.npy&quot; file</span>
<span class="n">M_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;measurements.csv&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">csv2npy_measurements</span><span class="p">(</span><span class="n">M_</span><span class="p">,</span> <span class="n">M_num</span><span class="p">)</span>
<span class="c1"># load the measurements</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;measurements.npy&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">DelimitedFiles</span>

<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c"># Kraus operators for the amplitude damping channel</span>
<span class="n">gamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span>
<span class="n">K1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]</span>
<span class="n">K2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">K1</span><span class="p">,</span><span class="w"> </span><span class="n">K2</span><span class="p">]</span>
<span class="c"># derivatives of Kraus operators on gamma</span>
<span class="n">dK1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]</span>
<span class="n">dK2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">dK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">dK1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">dK2</span><span class="p">]]</span>
<span class="c"># measurement</span>
<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">POVM_basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="n">M_num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="31:3"><input checked="checked" id="__tabbed_31_1" name="__tabbed_31" type="radio" /><input id="__tabbed_31_2" name="__tabbed_31" type="radio" /><input id="__tabbed_31_3" name="__tabbed_31" type="radio" /><div class="tabbed-labels"><label for="__tabbed_31_1">Projection</label><label for="__tabbed_31_2">LC</label><label for="__tabbed_31_3">Rotation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Projection</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="32:2"><input checked="checked" id="__tabbed_32_1" name="__tabbed_32" type="radio" /><input id="__tabbed_32_2" name="__tabbed_32" type="radio" /><div class="tabbed-labels"><label for="__tabbed_32_1">DE</label><label for="__tabbed_32_2">PSO</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:LC</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">POVM_basis</span><span class="o">=</span><span class="n">POVM_basis</span><span class="p">,</span><span class="w"> </span><span class="n">M_num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="33:3"><input checked="checked" id="__tabbed_33_1" name="__tabbed_33" type="radio" /><input id="__tabbed_33_2" name="__tabbed_33" type="radio" /><input id="__tabbed_33_3" name="__tabbed_33" type="radio" /><div class="tabbed-labels"><label for="__tabbed_33_1">DE</label><label for="__tabbed_33_2">PSO</label><label for="__tabbed_33_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: AD</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MeasurementOpt</span><span class="p">(</span><span class="n">mtype</span><span class="o">=</span><span class="ss">:Rotation</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                    </span><span class="n">POVM_basis</span><span class="o">=</span><span class="n">POVM_basis</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="34:3"><input checked="checked" id="__tabbed_34_1" name="__tabbed_34" type="radio" /><input id="__tabbed_34_2" name="__tabbed_34" type="radio" /><input id="__tabbed_34_3" name="__tabbed_34" type="radio" /><div class="tabbed-labels"><label for="__tabbed_34_1">DE</label><label for="__tabbed_34_2">PSO</label><label for="__tabbed_34_3">AD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: DE</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: PSO</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># measurement optimization algorithm: AD</span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                        </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">dK</span><span class="p">)</span>
<span class="c"># objective function: CFI</span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
<span class="c"># run the measurement optimization problem</span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="c"># convert the flattened data into a list of matrix</span>
<span class="n">M_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readdlm</span><span class="p">(</span><span class="s">&quot;measurements.csv&quot;</span><span class="p">,</span><span class="sc">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="kt">Complex</span><span class="p">{</span><span class="kt">Float64</span><span class="p">})</span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">reshape</span><span class="p">(</span><span class="n">M_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">],</span><span class="w"> </span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">M_num</span><span class="p">]</span><span class="w"> </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="kt">Int</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">M_</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">M_num</span><span class="p">)][</span><span class="k">end</span><span class="p">]</span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<h2 id="bibliography"><strong>Bibliography</strong><a class="headerlink" href="#bibliography" title="Permanent link">&para;</a></h2>
<p><a id="Kennedy1995">[1]</a>
J. Kennedy and R. Eberhar,
Particle swarm optimization,
<a href="https://doi.org/10.1109/ICNN.1995.488968">Proc. 1995 IEEE International Conference on Neural Networks <strong>4</strong>, 1942-1948 (1995).
</a></p>
<p><a id="Storn1997">[2]</a>
R. Storn and K. Price,
Differential Evolution-A Simple and Efficient Heuristic for global
Optimization over Continuous Spaces,
<a href="https://doi.org/10.1023/A:1008202821328">J. Global Optim. <strong>11</strong>, 341 (1997).</a></p>
<p><a id="Baydin2018">[3]</a>
A. G. Baydin, B. A. Pearlmutter, A. A. Radul, and J. M. Siskind,
Automatic differentiation in machine learning: a survey,
<a href="http://jmlr.org/papers/v18/17-468.html">J. Mach. Learn. Res. <strong>18</strong>, 1-43 (2018).</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/mathjaxhelper.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>