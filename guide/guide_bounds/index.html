
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docs of QuanEstimation">
      
      
        <meta name="author" content="QuanEstimation">
      
      
        <link rel="canonical" href="https://quanestimation.github.io/QuanEstimation/guide/guide_bounds/">
      
      
        <link rel="prev" href="../guide_dynamics/">
      
      
        <link rel="next" href="../guide_resources/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Quantum metrological tools - QuanEstimation Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/style.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/julia_api.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quantum-metrological-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="QuanEstimation Docs" class="md-header__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.92 7.92 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.92 7.92 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.92 7.92 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.92 7.92 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69zM12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuanEstimation Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Quantum metrological tools
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../guide_import/" class="md-tabs__link">
          
  
  
  Users Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../API/python/classes/" class="md-tabs__link">
          
  
  
  API documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../citing/" class="md-tabs__link">
        
  
  
    
  
  Citing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../developers/" class="md-tabs__link">
        
  
  
    
  
  Developers

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="QuanEstimation Docs" class="md-nav__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.92 7.92 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.92 7.92 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.92 7.92 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.92 7.92 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69zM12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"/></svg>

    </a>
    QuanEstimation Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Users Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Users Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameterization process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Quantum metrological tools
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Quantum metrological tools
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quantum-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Cramér-Rao bounds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holevo-cramer-rao-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Holevo Cramér-Rao bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nagaoka-hayashi-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Nagaoka-Hayashi bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian Cramér-Rao bounds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-ziv-zakai-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Ziv-Zakai bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian estimation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    <span class="md-ellipsis">
      Bibliography
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrological resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Copt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Sopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Mopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Measurement optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Compopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comprehensive optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide_adaptive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adaptive measurement schemes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../output_files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Output files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../API/julia/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Julia
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../citing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Citing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developers
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quantum-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Cramér-Rao bounds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holevo-cramer-rao-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Holevo Cramér-Rao bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nagaoka-hayashi-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Nagaoka-Hayashi bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian Cramér-Rao bounds
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-ziv-zakai-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Ziv-Zakai bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian estimation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    <span class="md-ellipsis">
      Bibliography
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="quantum-metrological-tools"><strong>Quantum metrological tools</strong><a class="headerlink" href="#quantum-metrological-tools" title="Permanent link">&para;</a></h1>
<p>QuanEstimation can be used to calculate several well-used metrological tools including 
Quantum Cramér-Rao bounds, Holevo Cramér-Rao bound, Bayesian Cramér-Rao bounds, Quantum 
Ziv-Zakai bound and perform Bayesian estimation.</p>
<p>Notes: When calculating with Python and Julia (i.e., calcute the inverse and eigenvalues 
of matrices), the results may vary due to the inconsistency of the retained effective digits. 
This difference has no effect on optimization. If users want to get consistent results, the same number of significant digits for calculation should be input, 
(i.e., keep 8 decimal places).</p>
<h2 id="quantum-cramer-rao-bounds"><strong>Quantum Cramér-Rao bounds</strong><a class="headerlink" href="#quantum-cramer-rao-bounds" title="Permanent link">&para;</a></h2>
<p>In quantum metrology, quantum Cramér-Rao bounds are well used metrological tools for 
parameter estimation. It can be expressed as <a href="#Helstrom1976">[1,2,3]</a>
\begin{align}
\mathrm{cov}\left(\hat{\textbf{x}}, {\Pi_y}\right) \geq \frac{1}{n}\mathcal{I}^{-1}
\left({\Pi_y}\right) \geq \frac{1}{n} \mathcal{F}^{-1},
\end{align}</p>
<p>where <span class="arithmatex">\(\mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})=\sum_y\mathrm{Tr}(\rho\Pi_y)(\hat{\textbf{x}}
-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}\)</span> is the covariance matrix for the 
unknown parameters <span class="arithmatex">\(\hat{\textbf{x}}=(\hat{x}_0,\hat{x}_1,\dots)^{\mathrm{T}}\)</span> to be estimated. 
<span class="arithmatex">\(\{\Pi_y\}\)</span> is a set of positive operator-valued measure (POVM) and <span class="arithmatex">\(\rho\)</span> represents the 
parameterized density matrix. <span class="arithmatex">\(n\)</span> is the repetition of the experiment, <span class="arithmatex">\(\mathcal{I}\)</span> and 
<span class="arithmatex">\(\mathcal{F}\)</span> are the classical Fisher information matrix (CFIM) and quantum Fisher information 
matrix (QFIM), respectively. The <span class="arithmatex">\(ab\)</span>th entry of CFIM is defined as
\begin{align}
\mathcal{I}_{ab}=\sum_y\frac{1}{p(y|\textbf{x})}[\partial_a p(y|\textbf{x})][\partial_b 
p(y|\textbf{x})]
\end{align}</p>
<p>with <span class="arithmatex">\(p(y|\textbf{x})=\mathrm{Tr}(\rho\Pi_y)\)</span>. The most well-used type of the QFIM is 
SLD-based QFIM of the form
\begin{align}
\mathcal{F}_{ab}=\frac{1}{2}\mathrm{Tr}[\rho (L_aL_b+ L_bL_a)]
\end{align}</p>
<p>with <span class="arithmatex">\(\mathcal{F}_{ab}\)</span> the <span class="arithmatex">\(ab\)</span>th entry of <span class="arithmatex">\(\mathcal{F}\)</span> and <span class="arithmatex">\(L_{a}(L_{b})\)</span> the symmetric 
logarithmic derivative (SLD) operator for <span class="arithmatex">\(x_{a}(x_b)\)</span>. The SLD operator is determined by
\begin{align}
\partial_{a}\rho=\frac{1}{2}(\rho L_{a}+L_{a}\rho).
\end{align}</p>
<p>The <span class="arithmatex">\(ij\)</span>th entry of SLD can be calculated by
\begin{align}
\langle\lambda_i|L_{a}|\lambda_j\rangle=\frac{2\langle\lambda_i| \partial_{a}\rho 
|\lambda_j\rangle}
{\lambda_i+\lambda_j}, ~~\lambda_i (\lambda_j)\neq 0 .
\end{align}</p>
<p>For <span class="arithmatex">\(\lambda_i (\lambda_j)=0\)</span>, the above equation is set to be zero.</p>
<p>Besides, there are right logarithmic derivative (RLD) and left logarithmic derivative (LLD) 
defined by <span class="arithmatex">\(\partial_{a}\rho=\rho \mathcal{R}_a\)</span> and <span class="arithmatex">\(\partial_{a}\rho=\mathcal{R}_a^{\dagger}
\rho\)</span> with the  corresponding QFIM  <span class="arithmatex">\(\mathcal{F}_{ab}=\mathrm{Tr}(\rho \mathcal{R}_a 
\mathcal{R}^{\dagger}_b)\)</span>. The RLD and LLD operators are calculated via</p>
<div class="arithmatex">\[\begin{align}
\langle\lambda_i| \mathcal{R}_{a} |\lambda_j\rangle
&amp;= \frac{1}{\lambda_i}\langle\lambda_i| \partial_{a}\rho |\lambda_j\rangle,~~\lambda_i\neq 0, \\
\langle\lambda_i| \mathcal{R}_{a}^{\dagger} |\lambda_j\rangle
&amp;= \frac{1}{\lambda_j}\langle\lambda_i| \partial_{a}\rho |\lambda_j\rangle,~~\lambda_j\neq 0.
\end{align}\]</div>
<p>In QuanEstimation, three types of the logarithmic derivatives can be solved by calling the 
codes</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python</label><label for="__tabbed_1_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">rep</span><span class="o">=</span><span class="s">&quot;original&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">rep</span><span class="o">=</span><span class="s">&quot;original&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">rep</span><span class="o">=</span><span class="s">&quot;original&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div></p>
</div>
</div>
</div>
<p>where <code>rho</code> and <code>drho</code> are the density matrix of the state and its derivatives with respect to
the unknown parameters to be estimated. <code>drho</code> should be input as <span class="arithmatex">\([\partial_a{\rho}, 
\partial_b{\rho}, \cdots]\)</span>. For single parameter estimation (the length of <code>drho</code> is equal to 
one), the output is a matrix and for multiparameter estimation (the length of <code>drho</code> is more 
than one), it returns a list. There are two output choices for the logarithmic derivatives 
basis which can be setting through <code>rep</code>. The default basis (<code>rep="original"</code>) of the logarithmic 
derivatives is the same with <code>rho</code> and the users can also request the logarithmic derivatives 
written in the eigenspace of <code>rho</code> by <code>rep="eigen"</code>. <code>eps</code> represents the machine epsilon which 
defaults to <span class="arithmatex">\(10^{-8}\)</span>.</p>
<p>In QuanEstimation, the QFI and QFIM can be calculated via the following function</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Python</label><label for="__tabbed_2_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<code>LDtype</code> represents the types of QFI (QFIM) can be set. Options are <code>LDtype=SLD</code> (default), 
<code>LDtype=RLD</code> and <code>LDtype=LLD</code>. This function will return QFI (QFIM) if <code>exportLD=False</code>,
however, if the users set <code>exportLD=True</code>, it will return logarithmic derivatives apart 
from QFI (QFIM).</p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">,</span><span class="w"> </span><span class="n">exportLD</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<code>LDtype</code> represents the types of QFI (QFIM) can be set. Options are <code>LDtype=SLD</code> (default), 
<code>LDtype=RLD</code> and <code>LDtype=LLD</code>. This function will return QFI (QFIM) if <code>exportLD=false</code>,
however, if the users set <code>exportLD=true</code>, it will return logarithmic derivatives apart 
from QFI (QFIM).</p>
</div>
</div>
</div>
<p><strong>Example 3.1</strong><br />
<a id="example3_1"></a>
The Hamiltonian of a single qubit system is <span class="arithmatex">\(H=\frac{1}{2}\omega \sigma_3\)</span> with <span class="arithmatex">\(\omega\)</span> 
the frequency and <span class="arithmatex">\(\sigma_3\)</span> a Pauli matrix. The dynamics of the system is governed by</p>
<div class="arithmatex">\[\begin{align}
\partial_t\rho=-i[H, \rho]+ \gamma_{+}\left(\sigma_{+}\rho\sigma_{-}-\frac{1}{2}\{\sigma_{-}
\sigma_{+},\rho\}\right)+ \gamma_{-}\left(\sigma_{-}\rho\sigma_{+}-\frac{1}{2}\{\sigma_{+}
\sigma_{-},\rho\}\right),
\end{align}\]</div>
<p>where <span class="arithmatex">\(\sigma_{\pm}=\frac{1}{2}(\sigma_1 \pm \sigma_2)\)</span> with <span class="arithmatex">\(\sigma_{1}\)</span>, <span class="arithmatex">\(\sigma_{2}\)</span> Pauli 
matrices and <span class="arithmatex">\(\gamma_{+}\)</span>, <span class="arithmatex">\(\gamma_{-}\)</span> are decay rates. The probe state is taken as <span class="arithmatex">\(|+\rangle\)</span> 
with <span class="arithmatex">\(|+\rangle=\frac{1}{\sqrt{2}}(|0\rangle+|1\rangle)\)</span>. Here <span class="arithmatex">\(|0\rangle\)</span> and <span class="arithmatex">\(|1\rangle\)</span> are 
the eigenstates of <span class="arithmatex">\(\sigma_3\)</span> with respect to the eigenvalues <span class="arithmatex">\(1\)</span> and <span class="arithmatex">\(-1\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Python</label><label for="__tabbed_3_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">H0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span>
<span class="c1"># derivative of the free Hamiltonian on omega</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>  
<span class="n">sm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">sp</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="n">sm</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="c1"># dynamics</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">Lindblad</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="p">)</span>
<span class="n">rho</span><span class="p">,</span> <span class="n">drho</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
<span class="c1"># calculation of the QFI</span>
<span class="n">F</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2000</span><span class="p">):</span>
    <span class="c1"># QFI</span>
    <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">])</span>
    <span class="n">F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">F_tp</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c"># free Hamiltonian</span>
<span class="n">omega</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span>
<span class="c"># derivative of the free Hamiltonian on omega</span>
<span class="n">dH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span>
<span class="c"># dissipation</span>
<span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">sm</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">]]</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">50.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="c"># dynamics</span>
<span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="p">)</span>
<span class="c"># calculation of the QFI</span>
<span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float64</span><span class="p">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span>
<span class="w">    </span><span class="c"># QFI</span>
<span class="w">    </span><span class="n">F_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span><span class="w"> </span><span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">])</span>
<span class="w">    </span><span class="n">append!</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="n">F_tp</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
</div>
</div>
</div>
<p>If the parameterization process is excuted via the Kraus operators, the QFI (QFIM) can be 
calculated by calling the function</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Python</label><label for="__tabbed_4_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QFIM_Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QFIM_Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">dK</span><span class="p">;</span><span class="w"> </span><span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">,</span><span class="w"> </span><span class="n">exportLD</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>where <code>K</code> and <code>dK</code> are the Kraus operators and the derivatives with respect to the unknown 
parameters to be estimated.</p>
<p><strong>Example 3.2</strong><br />
The Kraus operators for the amplitude damping channel are</p>
<div class="arithmatex">\[\begin{eqnarray}
K_1 = \left(\begin{array}{cc}
1 &amp; 0  \\
0 &amp; \sqrt{1-\gamma}
\end{array}\right),
K_2 = \left(\begin{array}{cc}
0 &amp; \sqrt{\gamma} \\
0 &amp; 0
\end{array}\right), \nonumber
\end{eqnarray}\]</div>
<p>where <span class="arithmatex">\(\gamma\)</span> is unknown parameter to be estimated which represents the decay probability. 
In this example, the probe state is taken as <span class="arithmatex">\(|+\rangle\langle+|\)</span> with <span class="arithmatex">\(|+\rangle:=\frac{1}
{\sqrt{2}}(|0\rangle+|1\rangle)\)</span>. <span class="arithmatex">\(|0\rangle\)</span> <span class="arithmatex">\((|1\rangle)\)</span> is the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> 
(Pauli matrix) with respect to the eigenvalue <span class="arithmatex">\(1\)</span> <span class="arithmatex">\((-1)\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Python</label><label for="__tabbed_5_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># Kraus operators for the amplitude damping channel</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">K1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]])</span>
<span class="n">K2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">)],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="n">K1</span><span class="p">,</span> <span class="n">K2</span><span class="p">]</span>
<span class="c1"># derivatives of Kraus operators on gamma</span>
<span class="n">dK1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]])</span>
<span class="n">dK2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">)],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">dK</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dK1</span><span class="p">],</span> <span class="p">[</span><span class="n">dK2</span><span class="p">]]</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">QFIM_Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">+</span><span class="mi">0</span><span class="nb">im</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="mf">0.5</span><span class="p">]</span>
<span class="c"># Kraus operators for the amplitude damping channel</span>
<span class="n">gamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span>
<span class="n">K1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]</span>
<span class="n">K2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">K1</span><span class="p">,</span><span class="w"> </span><span class="n">K2</span><span class="p">]</span>
<span class="c"># derivatives of Kraus operators on gamma</span>
<span class="n">dK1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]</span>
<span class="n">dK2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.5</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">dK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">dK1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">dK2</span><span class="p">]]</span>
<span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">dK</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>The FI (FIM) for a set of the probabilities <code>p</code> can be calculated by</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Python</label><label for="__tabbed_6_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">FIM</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">FIM</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">;</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>where <code>dp</code> is a list representing the derivatives of the probabilities <code>p</code> with respect to 
the unknown parameters.</p>
<p><strong>Example 3.3</strong>  </p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Python</label><label for="__tabbed_7_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">]</span>
<span class="n">dp</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.54</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.54</span><span class="p">]]</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">FIM</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.54</span><span class="p">,</span><span class="w"> </span><span class="mf">0.46</span><span class="p">]</span>
<span class="n">dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="mf">0.54</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">0.54</span><span class="p">]]</span>
<span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">FIM</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>The FI can also be calculated based on the experiment data</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Python</label><label for="__tabbed_8_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">FI_Expt</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">FI_Expt</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">,</span><span class="w"> </span><span class="n">dx</span><span class="p">;</span><span class="w"> </span><span class="n">ftype</span><span class="o">=</span><span class="ss">:norm</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p><code>y1</code> and <code>y2</code> are two arrays representing the experimental data obtained at <span class="arithmatex">\(x\)</span> and <span class="arithmatex">\(x+\delta x\)</span>, respectively.  <span class="arithmatex">\(\delta x\)</span> is a known small drift corresponds to <code>dx</code>. 
<code>ftype</code> represents the distribution that the data follows, which can be choosen in "norm", 
"gamma", "rayleigh", and "poisson".  <code>ftype="norm"</code> represents the normal (Gaussian) distribution
with the probability density function
\begin{align}
f(x)=\frac{1}{\sigma\sqrt{2\pi}}e^{-(x-\mu)^2/2\sigma^2}
\end{align}
for distribution fitting, where <span class="arithmatex">\(\mu\)</span> and <span class="arithmatex">\(\sigma\)</span> are the mean and variance of the distribution, 
respectively. </p>
<p><code>ftype="gamma"</code> represents the gamma distribution of the form
\begin{align}
f(x)=\frac{x^{\alpha-1}e^{-\beta x}\beta^\alpha}{\Gamma(\alpha)}
\end{align}
with <span class="arithmatex">\(\alpha\)</span> the shape and <span class="arithmatex">\(\beta\)</span> the rate of the distribution. <span class="arithmatex">\(\Gamma(\alpha)\)</span> is the gamma function.</p>
<p>If the data follows a rayleigh distribution, the data can be fit through setting 
<code>ftype="rayleigh"</code>. The probability density function of the rayleigh distribution is
\begin{align}
f(x)=\frac{x-\mu}{\sigma^2}e^{-(x-\mu)^2/2\sigma^2}
\end{align}
with <span class="arithmatex">\(\mu\)</span> and <span class="arithmatex">\(\sigma\)</span> the mean and variance of the distribution.</p>
<p><code>ftype="poisson"</code> represents a discrete Poisson distribution with the probability mass function
\begin{align}
f(k)=\frac{\lambda^k e^{-\lambda}}{k!},
\end{align}
where <span class="arithmatex">\(k=0,1,2,\cdots\)</span> represents the number of occurrences, <span class="arithmatex">\(\lambda\)</span> represents the variance
of the data, <span class="arithmatex">\(!\)</span> is the factorial function. </p>
<p>In quantum metrology, the CFI (CFIM) are solved by</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Python</label><label for="__tabbed_9_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
Here <code>M</code> represents a set of positive operator-valued measure (POVM) with default value <code>[]</code>. 
In this function, a set of rank-one symmetric informationally complete POVM (SIC-POVM) is used 
when <code>M=[]</code>. SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>. </p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
Here <code>M</code> represents a set of positive operator-valued measure (POVM) with default value <code>missing</code>. 
In this function, a set of rank-one symmetric informationally complete POVM (SIC-POVM) is used 
when <code>M=missing</code>. SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>. </p>
</div>
</div>
</div>
<p><strong>Example 3.4</strong><br />
<a id="example2_4"></a>
The Hamiltonian of a single qubit system is <span class="arithmatex">\(H=\frac{1}{2}\omega \sigma_3\)</span> with <span class="arithmatex">\(\omega\)</span> 
the frequency and <span class="arithmatex">\(\sigma_3\)</span> a Pauli matrix. The dynamics of the system is governed by
\begin{align}
\partial_t\rho=-i[H, \rho]+ \gamma_{+}\left(\sigma_{+}\rho\sigma_{-}-\frac{1}{2}{\sigma_{-}
\sigma_{+}, \rho}\right)+ \gamma_{-}\left(\sigma_{-}\rho\sigma_{+}-\frac{1}{2}{\sigma_{+}
\sigma_{-},\rho}\right),
\end{align}</p>
<p>where <span class="arithmatex">\(\sigma_{\pm}=\frac{1}{2}(\sigma_1 \pm \sigma_2)\)</span> with <span class="arithmatex">\(\sigma_{1}\)</span>, <span class="arithmatex">\(\sigma_{2}\)</span> Pauli 
matrices and <span class="arithmatex">\(\gamma_{+}\)</span>, <span class="arithmatex">\(\gamma_{-}\)</span> are decay rates. The probe state is taken as <span class="arithmatex">\(|+\rangle\)</span> 
and the measurement for CFI is <span class="arithmatex">\(\{|+\rangle\langle+|, |-\rangle\langle-|\}\)</span> with
<span class="arithmatex">\(|\pm\rangle=\frac{1}{\sqrt{2}}(|0\rangle\pm|1\rangle)\)</span>. Here <span class="arithmatex">\(|0\rangle\)</span> and <span class="arithmatex">\(|1\rangle\)</span> are 
the eigenstates of <span class="arithmatex">\(\sigma_3\)</span> with respect to the eigenvalues <span class="arithmatex">\(1\)</span> and <span class="arithmatex">\(-1\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Python</label><label for="__tabbed_10_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">H0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span>
<span class="c1"># derivative of the free Hamiltonian on omega</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>  
<span class="n">sm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">sp</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="n">sm</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c1"># measurement</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">]</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="c1"># dynamics</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">Lindblad</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="p">)</span>
<span class="n">rho</span><span class="p">,</span> <span class="n">drho</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
<span class="c1"># calculation of the CFI</span>
<span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2000</span><span class="p">):</span>
    <span class="c1"># CFI</span>
    <span class="n">I_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
    <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">I_tp</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c"># free Hamiltonian</span>
<span class="n">omega</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span>
<span class="c"># derivative of the free Hamiltonian on omega</span>
<span class="n">dH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span>
<span class="c"># dissipation</span>
<span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">sm</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">]]</span>
<span class="c"># measurement</span>
<span class="n">M1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w">  </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span>
<span class="n">M2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="n">M2</span><span class="p">]</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">50.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="c"># dynamics</span>
<span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="p">)</span>
<span class="c"># calculation of the CFI</span>
<span class="n">Im</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float64</span><span class="p">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span>
<span class="w">    </span><span class="c"># CFI</span>
<span class="w">    </span><span class="n">I_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span><span class="w"> </span><span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span><span class="w"> </span><span class="n">M</span><span class="p">)</span>
<span class="w">    </span><span class="n">append!</span><span class="p">(</span><span class="n">Im</span><span class="p">,</span><span class="w"> </span><span class="n">I_tp</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
</div>
</div>
</div>
<p>In Bloch representation, the SLD based QFI (QFIM) is calculated by</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">Python</label><label for="__tabbed_11_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QFIM_Bloch</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QFIM_Bloch</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">dr</span><span class="p">;</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p><code>r</code> and <code>dr</code> are the parameterized Bloch vector and its derivatives of with respect to the 
unknown parameters to be estimated.</p>
<p><strong>Example 3.5</strong><br />
The arbitrary single-qubit state can be written as 
\begin{align}
|\psi\rangle=\cos\frac{\theta}{2}|0\rangle+e^{i\phi}\sin\frac{\theta}{2}|1\rangle
\end{align}</p>
<p>with <span class="arithmatex">\(\theta\)</span> and <span class="arithmatex">\(\phi\)</span> the parameters to be estimated. The Bloch vector for this state is
<span class="arithmatex">\(r=(\sin\theta\cos\phi, \sin\theta\sin\phi, \cos\theta)^{\mathrm{T}}\)</span> and the derivatives 
with respect to <span class="arithmatex">\(\theta\)</span> and <span class="arithmatex">\(\phi\)</span> are 
<span class="arithmatex">\(\partial_\theta r=(\cos\theta\cos\phi, \cos\theta\sin\phi, -\sin\theta)^{\mathrm{T}}\)</span> and 
<span class="arithmatex">\(\partial_\phi r=(-\sin\theta\sin\phi, \sin\theta\cos\phi, 0)^{\mathrm{T}}\)</span></p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">Python</label><label for="__tabbed_12_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> \
              <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> \
              <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
<span class="n">dr_theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> \
                     <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> \
                     <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span>
<span class="n">dr_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> \
                   <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> \
                   <span class="mf">0.</span><span class="p">])</span>
<span class="n">dr</span> <span class="o">=</span> <span class="p">[</span><span class="n">dr_theta</span><span class="p">,</span> <span class="n">dr_phi</span><span class="p">]</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">QFIM_Bloch</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>

<span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="nb">pi</span>
<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<span class="n">dr_theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<span class="n">dr_phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">dr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">dr_theta</span><span class="p">,</span><span class="w"> </span><span class="n">dr_phi</span><span class="p">]</span>
<span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_Bloch</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">dr</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>The package can also calculte the SLD based QFI (QFIM) with Gaussian states. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">Python</label><label for="__tabbed_13_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QFIM_Gauss</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">dR</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">dD</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QFIM_Gauss</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">dR</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="n">dD</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>The variable <code>R</code> is the expected value <span class="arithmatex">\(\left(\langle[\textbf{R}]_i\rangle\right)\)</span> of 
<span class="arithmatex">\(\textbf{R}\)</span> with respect to <span class="arithmatex">\(\rho\)</span>, it is an array representing the first-order moment. 
Here <span class="arithmatex">\(\textbf{R}=(q_1,p_1,q_2,p_2,\dots)^{\mathrm{T}}\)</span> with <span class="arithmatex">\(q_i=\frac{1}{\sqrt{2}}
(a_i+a^{\dagger}_i)\)</span> and <span class="arithmatex">\(p_i=\frac{1}{i\sqrt{2}}(a_i-a^{\dagger}_i)\)</span> represents a vector 
of quadrature operators. <code>dR</code> is a list of derivatives of <code>R</code> with respect to the unknown 
parameters. The <span class="arithmatex">\(i\)</span>th entry of <code>dR</code> is <span class="arithmatex">\(\partial_{\textbf{x}} \langle[\textbf{R}]_i\rangle\)</span>. 
<code>D</code> and <code>dD</code> represent the second-order moment matrix with the <span class="arithmatex">\(ij\)</span>th entry <span class="arithmatex">\(D_{ij}=\langle 
[\textbf{R}]_i [\textbf{R}]_j+[\textbf{R}]_j [\textbf{R}]_i\rangle/2\)</span> and its derivatives with 
respect tp the unknown parameters.</p>
<p><strong>Example 3.6</strong><br />
The first and second moments <a href="#Safranek2019">[13]</a> are</p>
<div class="arithmatex">\[\begin{eqnarray}
\langle[\textbf{R}]_i\rangle = \left(\begin{array}{cc}
0   \\
0  
\end{array}\right),
D = \lambda\left(\begin{array}{cc}
\cosh 2r &amp; -\sinh 2r \\
-\sinh 2r &amp; -\sinh 2r
\end{array}\right), \nonumber
\end{eqnarray}\]</div>
<p>where <span class="arithmatex">\(\lambda=\coth\frac{\beta}{2}\)</span>.  <span class="arithmatex">\(r\)</span> and <span class="arithmatex">\(\beta\)</span> are the parameters to be estimated.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">Python</label><label for="__tabbed_14_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">r</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">Lambda</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">beta</span><span class="p">)</span>
<span class="c1"># the first-order moment</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="n">dR</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
<span class="c1"># the second-order moment</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Lambda</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)],</span> \
                     <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)]])</span>
<span class="n">dD_r</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)],</span> \
                          <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)]])</span>
<span class="n">dD_Lambda</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Lambda</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)],</span> \
                                        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)]])</span>
<span class="n">dD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD_r</span><span class="p">,</span> <span class="n">dD_Lambda</span><span class="p">])</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">QFIM_Gauss</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">dR</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">dD</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>

<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">Lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coth</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">beta</span><span class="p">)</span>
<span class="c"># the first-order moment</span>
<span class="n">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
<span class="n">dR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
<span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lambda</span><span class="o">*</span><span class="p">[</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">);</span><span class="w"> </span><span class="o">-</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)]</span>
<span class="n">dD_r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="o">*</span><span class="p">[</span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">);</span><span class="w"> </span><span class="o">-</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)]</span>
<span class="n">dD_Lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Lambda</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="o">-</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">);</span><span class="w"> </span><span class="n">sinh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">cosh</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)]</span>
<span class="n">dD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">dD_r</span><span class="p">,</span><span class="w"> </span><span class="n">dD_Lambda</span><span class="p">]</span>
<span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_Gauss</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">dR</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="n">dD</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<h2 id="holevo-cramer-rao-bound"><strong>Holevo Cramér-Rao bound</strong><a class="headerlink" href="#holevo-cramer-rao-bound" title="Permanent link">&para;</a></h2>
<p>Holevo Cramér-Rao bound (HCRB) is of the form <a href="#Holevo1973">[4,5]</a>
\begin{align}
\mathrm{Tr}(W\mathrm{cov}(\hat{\textbf{x}},{\Pi_y}))\geq \min_{\textbf{X},V} \mathrm{Tr}(WV),
\end{align}
where <span class="arithmatex">\(W\)</span> is the weight matrix and <span class="arithmatex">\(V\geq Z(\textbf{X})\)</span> with <span class="arithmatex">\([Z(\textbf{X})]_{ab}=\mathrm{Tr}
(\rho X_a X_b)\)</span>. <span class="arithmatex">\(\textbf{X}=[X_0,X_1,\cdots]\)</span> with <span class="arithmatex">\(X_i:=\sum_y (\hat{x}_i(y)-x_i)\Pi_y\)</span>. 
The HCRB can be calculated via semidefinite programming as </p>
<div class="arithmatex">\[\begin{align}
&amp; \min_{\textbf{X},V}~\mathrm{Tr}(WV),  \nonumber \\
&amp; \mathrm{subject}~\mathrm{to}
\begin{cases}
\left(\begin{array}{cc}
V &amp; \Lambda^{\mathrm{T}}R^{\dagger} \\
R\Lambda &amp; I\\
\end{array}\right)\geq 0, \\
\sum_i[\Lambda]_{ai}\mathrm{Tr}(\lambda_i\partial_b\rho)=\delta_{ab}.
\end{cases}
\end{align}\]</div>
<p>Here <span class="arithmatex">\(X_i\)</span> is expanded in a specific basis <span class="arithmatex">\(\{\lambda_i\}\)</span> as <span class="arithmatex">\(X_i=\sum_j [\Lambda]_{ij}\lambda_j\)</span>, 
the Hermitian matrix <span class="arithmatex">\(Z(\textbf{X})\)</span> satisfies <span class="arithmatex">\(Z(\textbf{X})=\Lambda^{\mathrm{T}}R^{\dagger}
R\Lambda\)</span>. In QuanEstimation, the HCRB can be solved by</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">Python</label><label for="__tabbed_15_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">HCRB</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">HCRB</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">;</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
</div>
</div>
</div>
<p>where <code>rho</code> and <code>drho</code> are the density matrix of the state and its derivatives with respect to
the unknown parameters to be estimated, respectively. <code>W</code> represents the weight matrix defaults 
to identity matrix and <code>eps</code> is the machine epsilon with default value <span class="arithmatex">\(10^{-8}\)</span>.</p>
<h2 id="nagaoka-hayashi-bound"><strong>Nagaoka-Hayashi bound</strong><a class="headerlink" href="#nagaoka-hayashi-bound" title="Permanent link">&para;</a></h2>
<p>Nagaoka-Hayashi bound (NHB) is another available bound in quantum parameter estimation and 
it is tighter than HCRB in general. The NHB can be expressed as <a href="#Conlon2021">[6-8]</a>
\begin{equation}
\mathrm{Tr}(W\mathrm{cov}(\hat{\textbf{x}},{\Pi_y}))\geq \min_{\textbf{X},\mathcal{Q}} \mathrm{Tr}\left((W\otimes\rho)\mathcal{Q}\right)
\end{equation}</p>
<p>with <span class="arithmatex">\(W\)</span> the weight matrix and <span class="arithmatex">\(\mathcal{Q}\)</span> a matrix satisfying <span class="arithmatex">\(\mathcal{Q}\geq\textbf{X}^{\mathrm{T}}\textbf{X}\)</span>. 
The NHB can be solved by the semidefinite programming as</p>
<div class="arithmatex">\[\begin{align}
&amp; \min_{\textbf{X},\mathcal{Q}}~\mathrm{Tr}\left((W\otimes\rho)\mathcal{Q}\right),  \nonumber \\
&amp; \mathrm{subject}~\mathrm{to}~
\begin{cases}
\left(\begin{array}{cc}
\mathcal{Q} &amp; \textbf{X}^{\mathrm{T}} \\
\textbf{X} &amp; I\\
\end{array}\right)\geq 0, \\
\mathrm{Tr}(\rho X_a)=0,\,\forall a, \\
\mathrm{Tr}(X_a\partial_b\rho)=\delta_{ab},\,\forall a, b.\\
\end{cases}
\end{align}\]</div>
<p>In QuanEstimation, the NHB can be solved by</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">Python</label><label for="__tabbed_16_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">NHB</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">NHB</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<p><strong>Example 3.7</strong><br />
<a id="example3_7"></a>
The Hamiltonian of a two-qubit system with <span class="arithmatex">\(XX\)</span> coupling is 
\begin{align}
H=\omega_1\sigma_3^{(1)}+\omega_2\sigma_3^{(2)}+g\sigma_1^{(1)}\sigma_1^{(2)},
\end{align}</p>
<p>where <span class="arithmatex">\(\omega_1\)</span>, <span class="arithmatex">\(\omega_2\)</span> are the frequencies of the first and second qubit, <span class="arithmatex">\(\sigma_i^{(1)}
=\sigma_i\otimes I\)</span> and <span class="arithmatex">\(\sigma_i^{(2)}=I\otimes\sigma_i\)</span> for <span class="arithmatex">\(i=1,2,3\)</span>. <span class="arithmatex">\(\sigma_1\)</span>, 
<span class="arithmatex">\(\sigma_2\)</span>, <span class="arithmatex">\(\sigma_3\)</span> are Pauli matrices and <span class="arithmatex">\(I\)</span> denotes the identity matrix. The dynamics 
is described by the master equation 
\begin{align}
\partial_t\rho=-i[H, \rho]+\sum_{i=1,2}\gamma_i\left(\sigma_3^{(i)}\rho\sigma_3^{(i)}-\rho\right)
\end{align}</p>
<p>with <span class="arithmatex">\(\gamma_i\)</span> the decay rate for the <span class="arithmatex">\(i\)</span>th qubit.</p>
<p>The probe state is taken as <span class="arithmatex">\(\frac{1}{\sqrt{2}}(|00\rangle+|11\rangle)\)</span> and the weight matrix 
is set to be identity. The measurement for <span class="arithmatex">\(\mathrm{Tr}(W\mathcal{I^{-1}})\)</span> is <span class="arithmatex">\(\{\Pi_1\)</span>, 
<span class="arithmatex">\(\Pi_2\)</span>, <span class="arithmatex">\(I-\Pi_1-\Pi_2\}\)</span> with <span class="arithmatex">\(\Pi_1=0.85|00\rangle\langle 00|\)</span> and <span class="arithmatex">\(\Pi_2=0.4|\!+
\!+\rangle\langle+\!+\!|\)</span>. Here <span class="arithmatex">\(|\pm\rangle:=\frac{1}{\sqrt{2}}(|0\rangle\pm|1\rangle)\)</span> with 
<span class="arithmatex">\(|0\rangle\)</span> <span class="arithmatex">\((|1\rangle)\)</span> the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> with respect to the eigenvalue <span class="arithmatex">\(1\)</span> (<span class="arithmatex">\(-1\)</span>).</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">Python</label><label for="__tabbed_17_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">psi0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">psi0</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">omega1</span><span class="p">,</span> <span class="n">omega2</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">ide</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>   
<span class="n">H0</span> <span class="o">=</span> <span class="n">omega1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="n">ide</span><span class="p">)</span><span class="o">+</span><span class="n">omega2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span><span class="o">+</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sx</span><span class="p">)</span>
<span class="c1"># derivatives of the free Hamiltonian on omega2 and g</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide</span><span class="p">,</span> <span class="n">sz</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sx</span><span class="p">)]</span> 
<span class="c1"># dissipation</span>
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="n">ide</span><span class="p">),</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide</span><span class="p">,</span><span class="n">sz</span><span class="p">),</span> <span class="mf">0.05</span><span class="p">]]</span>
<span class="c1"># measurement</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">0.85</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">m1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>
<span class="n">M2</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="n">M1</span><span class="o">-</span><span class="n">M2</span><span class="p">]</span>
<span class="c1"># weight matrix</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="c1"># dynamics</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">Lindblad</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="p">)</span>
<span class="n">rho</span><span class="p">,</span> <span class="n">drho</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
<span class="c1"># calculation of the HCRB and NHB</span>
<span class="n">f_HCRB</span><span class="p">,</span> <span class="n">f_NHB</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tspan</span><span class="p">)):</span>
    <span class="c1"># HCRB</span>
    <span class="n">f_tp1</span> <span class="o">=</span> <span class="n">HCRB</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="n">W</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">)</span>
    <span class="n">f_HCRB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_tp1</span><span class="p">)</span>
    <span class="c1"># NHB</span>
    <span class="n">f_tp2</span> <span class="o">=</span> <span class="n">NHB</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="n">W</span><span class="p">)</span>
    <span class="n">f_NHB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_tp2</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>

<span class="c"># initial state</span>
<span class="n">psi0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="p">]</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">psi0</span><span class="o">*</span><span class="n">psi0</span><span class="o">&#39;</span>
<span class="c"># free Hamiltonian</span>
<span class="n">omega1</span><span class="p">,</span><span class="w"> </span><span class="n">omega2</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">omega1</span><span class="o">*</span><span class="n">kron</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">omega2</span><span class="o">*</span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">sz</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g</span><span class="o">*</span><span class="n">kron</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">sx</span><span class="p">)</span>
<span class="c"># derivatives of the free Hamiltonian with respect to omega2 and g</span>
<span class="n">dH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">sz</span><span class="p">),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">sx</span><span class="p">)]</span>
<span class="c"># dissipation</span>
<span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">kron</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="mf">0.05</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">sz</span><span class="p">),</span><span class="w"> </span><span class="mf">0.05</span><span class="p">]]</span>
<span class="c"># measurement</span>
<span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">M1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.85</span><span class="o">*</span><span class="n">m1</span><span class="o">*</span><span class="n">m1</span><span class="o">&#39;</span>
<span class="n">M2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="n">M2</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="n">M1</span><span class="o">-</span><span class="n">M2</span><span class="p">]</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">5.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="c"># dynamics</span>
<span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="p">)</span>
<span class="c"># weight matrix</span>
<span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span>
<span class="c"># calculation of the HCRB and NHB</span>
<span class="n">f_HCRB</span><span class="p">,</span><span class="w"> </span><span class="n">f_NHB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="p">[]</span>
<span class="k">for</span><span class="w"> </span><span class="n">ti</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span>
<span class="w">    </span><span class="c"># HCRB</span>
<span class="w">    </span><span class="n">f_tp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">HCRB</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span><span class="w"> </span><span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span><span class="w"> </span><span class="n">W</span><span class="p">)</span>
<span class="w">    </span><span class="n">append!</span><span class="p">(</span><span class="n">f_HCRB</span><span class="p">,</span><span class="w"> </span><span class="n">f_tp1</span><span class="p">)</span>
<span class="w">    </span><span class="c"># NHB</span>
<span class="w">    </span><span class="n">f_tp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">NHB</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span><span class="w"> </span><span class="n">drho</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span><span class="w"> </span><span class="n">W</span><span class="p">)</span>
<span class="w">    </span><span class="n">append!</span><span class="p">(</span><span class="n">f_NHB</span><span class="p">,</span><span class="w"> </span><span class="n">f_tp2</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<h2 id="bayesian-cramer-rao-bounds"><strong>Bayesian Cramér-Rao bounds</strong><a class="headerlink" href="#bayesian-cramer-rao-bounds" title="Permanent link">&para;</a></h2>
<p>The Bayesion version of the classical Fisher information (matrix) and quantum Fisher information 
(matrix) can be calculated by <br></p>
<center> $\mathcal{I}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{I}\mathrm{d}\textbf{x}$ </center>
<p><br>
and <br></p>
<center> $\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}\mathrm{d}\textbf{x},$</center>
<p><br>
where <span class="arithmatex">\(p(\textbf{x})\)</span> is the prior distribution, <span class="arithmatex">\(\mathcal{I}\)</span> and <span class="arithmatex">\(\mathcal{F}\)</span> are CFI (CFIM) 
and QFI (QFIM) of all types, respectively.</p>
<p>In QuanEstimation, BCFI (BCFIM) and BQFI (BQFIM) can be solved via</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">Python</label><label for="__tabbed_18_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">BCFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">BQFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
where <code>x</code> represents the regimes of the parameters for the integral, it should be input as a 
list of arrays. <code>p</code> is an array representing the prior distribution. The input varibles <code>rho</code> 
and <code>drho</code> are two multidimensional lists with the dimensions as <code>x</code>. For example, for three 
parameter (<span class="arithmatex">\(x_0, x_1, x_2\)</span>) estimation, the <span class="arithmatex">\(ijk\)</span>th entry of <code>rho</code> and <code>drho</code> are <span class="arithmatex">\(\rho\)</span> and 
<span class="arithmatex">\([\partial_0\rho, \partial_1\rho, \partial_2\rho]\)</span> with respect to the values <span class="arithmatex">\([x_0]_i\)</span>, 
<span class="arithmatex">\([x_1]_j\)</span> and <span class="arithmatex">\([x_2]_k\)</span>, respectively.<code>LDtype</code> represents the types of QFI (QFIM) can be set,
options are <code>LDtype=SLD</code> (default), <code>LDtype=RLD</code> and <code>LDtype=LLD</code>. <code>M</code> represents a set of 
positive operator-valued measure (POVM) with default value <code>[]</code>. In QuanEstimation, a set of 
rank-one symmetric informationally complete POVM (SIC-POVM) is load when <code>M=[]</code>. SIC-POVM is 
calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state which can be downloaded 
from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>.</p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">BCFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">BQFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
where <code>x</code> represents the regimes of the parameters for the integral, it should be input as a 
list of arrays. <code>p</code> is an array representing the prior distribution. The input varibles <code>rho</code> 
and <code>drho</code> are two multidimensional lists with the dimensions as <code>x</code>. For example, for three 
parameter (<span class="arithmatex">\(x_0, x_1, x_2\)</span>) estimation, the <span class="arithmatex">\(ijk\)</span>th entry of <code>rho</code> and <code>drho</code> are <span class="arithmatex">\(\rho\)</span> and 
<span class="arithmatex">\([\partial_0\rho, \partial_1\rho, \partial_2\rho]\)</span> with respect to the values <span class="arithmatex">\([x_0]_i\)</span>, 
<span class="arithmatex">\([x_1]_j\)</span> and <span class="arithmatex">\([x_2]_k\)</span>, respectively.<code>LDtype</code> represents the types of QFI (QFIM) can be set,
options are <code>LDtype=SLD</code> (default), <code>LDtype=RLD</code> and <code>LDtype=LLD</code>. <code>M</code> represents a set of 
positive operator-valued measure (POVM) with default value <code>missing</code>. In QuanEstimation, a set of 
rank-one symmetric informationally complete POVM (SIC-POVM) is load when <code>M=missing</code>. SIC-POVM is 
calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state which can be downloaded 
from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>.</p>
</div>
</div>
</div>
<p>In the Bayesian scenarios, the covariance matrix with a prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> is 
defined as
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})=\int p(\textbf{x})\sum_y\mathrm{Tr}(\rho\Pi_y)
(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}\mathrm{d}\textbf{x},
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}\)</span> are the unknown parameters to be estimated and 
the integral <span class="arithmatex">\(\int\mathrm{d}\textbf{x}:=\int\mathrm{d}x_0\int\mathrm{d}x_1\cdots\)</span>. <span class="arithmatex">\(\{\Pi_y\}\)</span> is 
a set of POVM and <span class="arithmatex">\(\rho\)</span> represents the parameterized density matrix. Two types of Bayesian 
Cramér-Rao bound (BCRB) are calculated in this package, the first one is 
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \int p(\textbf{x})\left(B\mathcal{I}^{-1}B
+\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x},
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{b}\)</span> and <span class="arithmatex">\(\textbf{b}'\)</span> are the vectors of biase and its derivatives with respect to 
<span class="arithmatex">\(\textbf{x}\)</span>. <span class="arithmatex">\(B\)</span> is a diagonal matrix with the <span class="arithmatex">\(i\)</span>th entry <span class="arithmatex">\(B_{ii}=1+[\textbf{b}']_{i}\)</span> and 
<span class="arithmatex">\(\mathcal{I}\)</span> is the CFIM. The second one is
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \mathcal{B}\,\mathcal{I}_{\mathrm{Bayes}}^{-1}\,
\mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x},
\end{align}</p>
<p>where <span class="arithmatex">\(\mathcal{B}=\int p(\textbf{x})B\mathrm{d}\textbf{x}\)</span> is the average of <span class="arithmatex">\(B\)</span> and 
<span class="arithmatex">\(\mathcal{I}_{\mathrm{Bayes}}\)</span> is the average of the CFIM.</p>
<p>The third one is 
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \int p(\textbf{x})
\mathcal{G}\left(\mathcal{I}_p+\mathcal{I}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}
\end{align}</p>
<p>with <span class="arithmatex">\([\mathcal{I}_{p}]_{ab}:=[\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]\)</span> and
<span class="arithmatex">\(\mathcal{G}_{ab}:=[\partial_b\ln p(\textbf{x})][\textbf{b}]_a+B_{aa}\delta_{ab}\)</span>.</p>
<p>Three types of Bayesian Quantum Cramér-Rao bound (BCRB) are calculated, the first one is 
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq\int p(\textbf{x})\left(B\mathcal{F}^{-1}B
+\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x}
\end{align}</p>
<p>with <span class="arithmatex">\(\mathcal{F}\)</span> the QFIM for all types. The second one is
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \mathcal{B}\,\mathcal{F}_{\mathrm{Bayes}}^{-1}\,
\mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x}
\end{align}</p>
<p>with <span class="arithmatex">\(\mathcal{F}_{\mathrm{Bayes}}\)</span> the average of the QFIM.</p>
<p>The third one is 
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \int p(\textbf{x})
\mathcal{G}\left(\mathcal{I}_p+\mathcal{F}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}.
\end{align}</p>
<p>In QuanEstimation, the BCRB and BQCRB are calculated via</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">Python</label><label for="__tabbed_19_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">BCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">b</span><span class="o">=</span><span class="p">[],</span> <span class="n">db</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">BQCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">[],</span> <span class="n">db</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
where <code>b</code> and <code>db</code> are the vectors of biases and its derivatives on the unknown parameters. 
For unbiased estimates, <code>b=[]</code> and <code>db=[]</code>. In QuanEstimation, the users can set the types of 
BCRB and BQCRB via the variable <code>btype</code>. </p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">BCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">db</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">BQCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">db</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
where <code>b</code> and <code>db</code> are the vectors of biases and its derivatives on the unknown parameters. 
For unbiased estimates, <code>b=missing</code> and <code>db=missing</code>. In QuanEstimation, the users can set 
the types of BCRB and BQCRB via the variable <code>btype</code>. </p>
</div>
</div>
</div>
<p>For single parameter estimation, Ref <a href="#Liu2016">[9]</a> calculates the optimal biased bound based 
on the first type of the BQCRB, it can be realized numerically via</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">Python</label><label for="__tabbed_20_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">OBB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">d2rho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">OBB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">,</span><span class="w"> </span><span class="n">d2rho</span><span class="p">;</span><span class="w"> </span><span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p><code>d2rho</code> is a list representing the second order derivatives of <code>rho</code> on <code>x</code>.</p>
<p>Van Trees in 1968 <a href="#vanTrees1968">[10]</a> provides a well used Bayesian version of Cramér-Rao 
bound known as Van Trees bound (VTB). </p>
<center> $\mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \left(\mathcal{I}_{\mathrm{prior}}
+\mathcal{I}_{\mathrm{Bayes}}\right)^{-1},$ </center>

<p>where <span class="arithmatex">\(\mathcal{I}_{\mathrm{prior}}=\int p(\textbf{x})\mathcal{I}_{p}\mathrm{d}\textbf{x}\)</span> 
is the CFIM for <span class="arithmatex">\(p(\textbf{x})\)</span> and <span class="arithmatex">\(\mathcal{I}_{\mathrm{Bayes}}\)</span> is the average of the CFIM.</p>
<p>The quantum version (QVTB) provided by Tsang, Wiseman 
and Caves <a href="#Tsang2011">[12]</a>. </p>
<center> $\mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \left(\mathcal{I}_{\mathrm{prior}}
+\mathcal{F}_{\mathrm{Bayes}}\right)^{-1}$ </center>

<p>with <span class="arithmatex">\(\mathcal{F}_{\mathrm{Bayes}}\)</span> the average of the QFIM of all types.</p>
<p>The functions to calculate the VTB and QVTB are</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:2"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><input id="__tabbed_21_2" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">Python</label><label for="__tabbed_21_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">VTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">QVTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">VTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">QVTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div></p>
</div>
</div>
</div>
<p>Here the variables in the codes are the same with <code>BCRB</code> and <code>BQCRB</code>.</p>
<h2 id="quantum-ziv-zakai-bound"><strong>Quantum Ziv-Zakai bound</strong><a class="headerlink" href="#quantum-ziv-zakai-bound" title="Permanent link">&para;</a></h2>
<p>The expression of Quantum Ziv-Zakai bound (QZZB) with a prior distribution <span class="arithmatex">\(p(x)\)</span> in a finite 
regime <span class="arithmatex">\([\alpha,\beta]\)</span> is</p>
<div class="arithmatex">\[\begin{eqnarray}
\mathrm{var}(\hat{x},\{\Pi_y\}) &amp;\geq &amp; \frac{1}{2}\int_0^\infty \mathrm{d}\tau\tau
\mathcal{V}\int_{-\infty}^{\infty} \mathrm{d}x\min\!\left\{p(x), p(x+\tau)\right\} \nonumber \\
&amp; &amp; \times\left(1-\frac{1}{2}||\rho(x)-\rho(x+\tau)||\right),
\end{eqnarray}\]</div>
<p>where <span class="arithmatex">\(||\cdot||\)</span> represents the trace norm and <span class="arithmatex">\(\mathcal{V}\)</span> is the "valley-filling" 
operator satisfying <span class="arithmatex">\(\mathcal{V}f(\tau)=\max_{h\geq 0}f(\tau+h)\)</span>. <span class="arithmatex">\(\rho(x)\)</span> is the 
parameterized density matrix. </p>
<p>In QuanEstimation, the QZZB can be calculated via the function:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:2"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><input id="__tabbed_22_2" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">Python</label><label for="__tabbed_22_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QZZB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">QZZB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">;</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>where <code>x</code> is a list of array representing the regime of the parameter for the integral, <code>p</code> is 
an array representing the prior distribution and <code>rho</code> is a multidimensional list representing 
the density matrix. <code>eps</code> is the machine epsilon with default value <span class="arithmatex">\(10^{-8}\)</span>.</p>
<hr />
<p><strong>Example 3.8</strong><br />
<a id="example3_8"></a>
The Hamiltonian of a qubit system under a magnetic field <span class="arithmatex">\(B\)</span> in the XZ plane is
\begin{align}
H=\frac{B\omega_0}{2}(\sigma_1\cos{x}+\sigma_3\sin{x})
\end{align}</p>
<p>with <span class="arithmatex">\(x\)</span> the unknown parameter and <span class="arithmatex">\(\sigma_{1}\)</span>, <span class="arithmatex">\(\sigma_{3}\)</span> Pauli matrices. The probe state 
is taken as <span class="arithmatex">\(\frac{1}{\sqrt{2}}(|0\rangle+|1\rangle)\)</span> with <span class="arithmatex">\(|0\rangle\)</span> (<span class="arithmatex">\(|1\rangle\)</span>) the 
eigenvstates of <span class="arithmatex">\(\sigma_3\)</span> with respect to the eigenvalues <span class="arithmatex">\(1\)</span> (<span class="arithmatex">\(-1\)</span>). The measurement 
for classical bounds is a set of rank-one symmetric informationally complete positive 
operator-valued measure (SIC-POVM).</p>
<p>Take the Gaussian prior distribution <span class="arithmatex">\(p(x)=\frac{1}{c\eta\sqrt{2\pi}}\exp\left({-\frac{(x-\mu)^2}
{2\eta^2}}\right)\)</span> on <span class="arithmatex">\([-\pi/2, \pi/2]\)</span> with <span class="arithmatex">\(\mu\)</span> and <span class="arithmatex">\(\eta\)</span> the expectation and standard 
deviation, respectively. Here <span class="arithmatex">\(c=\frac{1}{2}\big[\mathrm{erf}(\frac{\pi-2\mu}{2\sqrt{2}\eta})
+\mathrm{erf}(\frac{\pi+2\mu}{2\sqrt{2}\eta})\big]\)</span> is the normalized coefficient with 
<span class="arithmatex">\(\mathrm{erf}(x):=\frac{2}{\sqrt{\pi}}\int^x_0 e^{-t^2}\mathrm{d}t\)</span> the error function.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:2"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><input id="__tabbed_23_2" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">Python</label><label for="__tabbed_23_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">simps</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">B</span><span class="p">,</span> <span class="n">omega0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">H0_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="n">sx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># derivative of the free Hamiltonian on x</span>
<span class="n">dH_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="c1"># prior distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">eta</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="n">p_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> \
                            <span class="o">/</span><span class="p">(</span><span class="n">eta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="n">dp_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> \
                              <span class="o">/</span><span class="p">(</span><span class="n">eta</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="n">p_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mu</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="n">dp_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dp_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mu</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="c1"># normalization of the distribution</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">p_tp</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">p</span><span class="p">,</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">p_tp</span><span class="o">/</span><span class="n">c</span><span class="p">,</span> <span class="n">dp_tp</span><span class="o">/</span><span class="n">c</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># dynamics</span>
<span class="n">rho</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> \
       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="n">drho</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)]</span> \
         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">H0_tp</span> <span class="o">=</span> <span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dH_tp</span> <span class="o">=</span> <span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dynamics</span> <span class="o">=</span> <span class="n">Lindblad</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0_tp</span><span class="p">,</span> <span class="n">dH_tp</span><span class="p">)</span>
    <span class="n">rho_tp</span><span class="p">,</span> <span class="n">drho_tp</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
    <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_tp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">drho_tp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Classical Bayesian bounds</span>
<span class="n">f_BCRB1</span> <span class="o">=</span> <span class="n">BCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="p">[],</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">f_BCRB2</span> <span class="o">=</span> <span class="n">BCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="p">[],</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f_BCRB3</span> <span class="o">=</span> <span class="n">BCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">f_VTB</span> <span class="o">=</span> <span class="n">VTB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Quantum Bayesian bounds</span>
<span class="n">f_BQCRB1</span> <span class="o">=</span> <span class="n">BQCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="p">[],</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">f_BQCRB2</span> <span class="o">=</span> <span class="n">BQCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="p">[],</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f_BQCRB3</span> <span class="o">=</span> <span class="n">BQCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">f_QVTB</span> <span class="o">=</span> <span class="n">QVTB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">)</span>
<span class="n">f_QZZB</span> <span class="o">=</span> <span class="n">QZZB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">Trapz</span>

<span class="c"># free Hamiltonian</span>
<span class="k">function</span><span class="w"> </span><span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="n">sx</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">end</span>
<span class="c"># derivative of the free Hamiltonian on x</span>
<span class="k">function</span><span class="w"> </span><span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sx</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="k">end</span>
<span class="c"># prior distribution</span>
<span class="k">function</span><span class="w"> </span><span class="n">p_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">eta</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">eta</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">eta</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">))</span>
<span class="k">end</span>
<span class="k">function</span><span class="w"> </span><span class="n">dp_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">eta</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">eta</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">eta</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">))</span>
<span class="k">end</span>

<span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">omega0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c"># prior distribution</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="kt">Vector</span>
<span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">eta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span>
<span class="n">p_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">p_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">eta</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">dp_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">dp_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">eta</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="c"># normalization of the distribution</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trapz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p_tp</span><span class="p">)</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_tp</span><span class="o">/</span><span class="n">c</span>
<span class="n">dp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp_tp</span><span class="o">/</span><span class="n">c</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c"># dynamics</span>
<span class="n">rho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Matrix</span><span class="p">{</span><span class="kt">ComplexF64</span><span class="p">}}(</span><span class="nb">undef</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">drho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Matrix</span><span class="p">{</span><span class="kt">ComplexF64</span><span class="p">}}}(</span><span class="nb">undef</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">H0_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="n">dH_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="n">rho_tp</span><span class="p">,</span><span class="w"> </span><span class="n">drho_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0_tp</span><span class="p">,</span><span class="w"> </span><span class="n">dH_tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rho_tp</span><span class="p">[</span><span class="k">end</span><span class="p">],</span><span class="w"> </span><span class="n">drho_tp</span><span class="p">[</span><span class="k">end</span><span class="p">]</span>
<span class="k">end</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c"># Classical Bayesian bounds</span>
<span class="n">f_BCRB1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">f_BCRB2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">btype</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f_BCRB3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">;</span><span class="w"> </span><span class="n">btype</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">f_VTB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">VTB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c"># Quantum Bayesian bounds</span>
<span class="n">f_BQCRB1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BQCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">,</span><span class="w"> </span><span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">f_BQCRB2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BQCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">,</span><span class="w"> </span><span class="n">btype</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f_BQCRB3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BQCRB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">,</span><span class="w"> </span><span class="n">btype</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">f_QVTB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QVTB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">drho</span><span class="p">)</span>
<span class="n">f_QZZB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QZZB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">)</span>
</code></pre></div></p>
</div>
</div>
</div>
<hr />
<h2 id="bayesian-estimation"><strong>Bayesian estimation</strong><a class="headerlink" href="#bayesian-estimation" title="Permanent link">&para;</a></h2>
<p>In QuanEstimation, two types of Bayesian estimation are considered including maximum a 
posteriori estimation (MAP) and maximum likelihood estimation (MLE). In Bayesian estimation, 
the prior distribution 
is updated as
\begin{align}
p(\textbf{x}|y)=\frac{p(y|\textbf{x})p(\textbf{x})}{\int p(y|\textbf{x})p(\textbf{x})
\mathrm{d}\textbf{x}}
\end{align}</p>
<p>with <span class="arithmatex">\(p(\textbf{x})\)</span> the current prior distribution and <span class="arithmatex">\(y\)</span> the outcome of the experiment. 
In practice, the prior distribution is replaced with <span class="arithmatex">\(p(\textbf{x}|y)\)</span> and the estimated 
value of <span class="arithmatex">\(\textbf{x}\)</span> can be evaluated by</p>
<div class="tabbed-set tabbed-alternate" data-tabs="24:2"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><input id="__tabbed_24_2" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">Python</label><label for="__tabbed_24_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">Bayes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">estimator</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">MLE</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
where <code>x</code> is a list of arrays representing the regimes of the parameters for the integral and 
<code>p</code> is an array representing the prior distribution. For multiparameter estimation, <code>p</code> is 
multidimensional. The input varible <code>rho</code> is a multidimensional list with the dimensions as <code>x</code> 
representing the parameterized density matrix. <code>M</code> contains a set of positive operator-valued 
measure (POVM). In QuanEstimation, a set of rank-one symmetric informationally complete POVM 
(SIC-POVM) is used when <code>M=[]</code>. SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM 
fiducial state which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>. 
    <code>eatimator</code> in <code>Bayes()</code> representing the estimators which is defaulted by the mean value of the 
paramters. Also, it can be set as <code>MAP</code>. The posterior distributions (likelihood function) in the 
final iteration and the estimated values in all iterations will be saved in "pout.npy" ("Lout.npy") 
and "xout.npy" if <code>savefile=False</code>. However, if the users want to save all the posterior 
distributions (likelihood function) and the estimated values in all iterations, the variable 
<code>savefile</code> needs to be set to <code>True</code>.</p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="n">Bayes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">estimator</span><span class="o">=</span><span class="s">&quot;mean&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">MLE</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
where <code>x</code> is a list of arrays representing the regimes of the parameters for the integral and 
<code>p</code> is an array representing the prior distribution. For multiparameter estimation, <code>p</code> is 
multidimensional. The input varible <code>rho</code> is a multidimensional list with the dimensions as <code>x</code> 
representing the parameterized density matrix. <code>M</code> contains a set of positive operator-valued 
measure (POVM). In QuanEstimation, a set of rank-one symmetric informationally complete POVM 
(SIC-POVM) is used when <code>M=missing</code>. SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM 
fiducial state which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>. 
    <code>eatimator</code> in <code>Bayes()</code> representing the estimators which is defaulted by the mean value of the 
paramters. Also, it can be set as <code>MAP</code>. The posterior distributions (likelihood function) in the 
final iteration and the estimated values in all iterations will be saved in "pout.csv" ("Lout.csv") 
and "xout.csv" if <code>savefile=false</code>. However, if the users want to save all the posterior 
distributions (likelihood function) and the estimated values in all iterations, the variable 
<code>savefile</code> needs to be set to <code>true</code>.</p>
</div>
</div>
</div>
<p><strong>Example 3.9</strong><br />
<a id="example3_9"></a>
The Hamiltonian of a qubit system is 
\begin{align}
H=\frac{B\omega_0}{2}(\sigma_1\cos{x}+\sigma_3\sin{x}),
\end{align}</p>
<p>where <span class="arithmatex">\(B\)</span> is the magnetic field in the XZ plane, <span class="arithmatex">\(x\)</span> is the unknown parameter and <span class="arithmatex">\(\sigma_{1}\)</span>, 
<span class="arithmatex">\(\sigma_{3}\)</span> are the Pauli matrices. The probe state is taken as <span class="arithmatex">\(|\pm\rangle\)</span>. The measurement 
is <span class="arithmatex">\(\{|\!+\rangle\langle+\!|,|\!-\rangle\langle-\!|\}\)</span>. Here <span class="arithmatex">\(|\pm\rangle:=\frac{1}{\sqrt{2}}
(|0\rangle\pm|1\rangle)\)</span> with <span class="arithmatex">\(|0\rangle\)</span> <span class="arithmatex">\((|1\rangle)\)</span> the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> with respect 
to the eigenvalue <span class="arithmatex">\(1\)</span> <span class="arithmatex">\((-1)\)</span>. In this example, the prior distribution <span class="arithmatex">\(p(x)\)</span> is uniform on 
<span class="arithmatex">\([0, \pi/2]\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:2"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><input id="__tabbed_25_2" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">Python</label><label for="__tabbed_25_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">B</span><span class="p">,</span> <span class="n">omega0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">H0_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="n">sx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># derivative of the free Hamiltonian on x</span>
<span class="n">dH_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="c1"># measurement</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">]</span>
<span class="c1"># prior distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># dynamics</span>
<span class="n">rho</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> \
       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">H0</span> <span class="o">=</span> <span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dH</span> <span class="o">=</span> <span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dynamics</span> <span class="o">=</span> <span class="n">Lindblad</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">)</span>
    <span class="n">rho_tp</span><span class="p">,</span> <span class="n">drho_tp</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
    <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_tp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Generation of the experimental results</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)]</span>
<span class="n">res_rand</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="mi">125</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res_rand</span><span class="p">)):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">res_rand</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Maximum a posteriori estimation</span>
<span class="n">pout</span><span class="p">,</span> <span class="n">xout</span> <span class="o">=</span> <span class="n">Bayes</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="s2">&quot;MAP&quot;</span><span class="p">,</span> \
                   <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Maximum likelihood estimation</span>
<span class="n">Lout</span><span class="p">,</span> <span class="n">xout</span> <span class="o">=</span> <span class="n">MLE</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">StatsBase</span>

<span class="c"># free Hamiltonian</span>
<span class="k">function</span><span class="w"> </span><span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="n">sx</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">end</span>
<span class="c"># derivative of the free Hamiltonian on x</span>
<span class="k">function</span><span class="w"> </span><span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sx</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="k">end</span>

<span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">omega0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c"># measurement </span>
<span class="n">M1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w">  </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span>
<span class="n">M2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="n">M2</span><span class="p">]</span>
<span class="c"># prior distribution</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="kt">Vector</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="k">end</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c"># dynamics</span>
<span class="n">rho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Matrix</span><span class="p">{</span><span class="kt">ComplexF64</span><span class="p">}}(</span><span class="nb">undef</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">H0_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="n">dH_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="n">rho_tp</span><span class="p">,</span><span class="w"> </span><span class="n">drho_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0_tp</span><span class="p">,</span><span class="w"> </span><span class="n">dH_tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rho_tp</span><span class="p">[</span><span class="k">end</span><span class="p">]</span>
<span class="k">end</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c"># Generation of the experimental results</span>
<span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">500</span><span class="p">]</span>
<span class="n">res_rand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="mi">125</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">res_rand</span><span class="p">)</span>
<span class="w">    </span><span class="n">y</span><span class="p">[</span><span class="n">res_rand</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="k">end</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c"># Maximum a posteriori estimation</span>
<span class="n">pout</span><span class="p">,</span><span class="w"> </span><span class="n">xout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Bayes</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">estimator</span><span class="o">=</span><span class="s">&quot;MAP&quot;</span><span class="p">,</span>
<span class="w">                                  </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c"># Maximum likelihood estimation</span>
<span class="n">Lout</span><span class="p">,</span><span class="w"> </span><span class="n">xout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">MLE</span><span class="p">([</span><span class="n">x</span><span class="p">],</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div></p>
</div>
</div>
</div>
<p>The average Bayesian cost <a href="#Robert2007">[14]</a> for a quadratic cost function can be 
calculated via
\begin{equation}
\bar{C}:=\int p(\textbf{x})\sum_y p(y|\textbf{x})(\textbf{x}-\hat{\textbf{x}})^{\mathrm{T}}
W(\textbf{x}-\hat{\textbf{x}})\,\mathrm{d}\textbf{x}
\end{equation}</p>
<p>In QuanEstimation, this can be realized by calling</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:2"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><input id="__tabbed_26_2" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">Python</label><label for="__tabbed_26_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">BayesCost</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">xest</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">BayesCost</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">xest</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">;</span><span class="w"> </span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p><code>xest</code> represents the estimators for the parameters.</p>
<p>Besides, the average Bayesian cost bounded by <a href="#Rafal2020">[5]</a> 
\begin{equation}
\bar{C}\geq\int p(\textbf{x})\left(\textbf{x}^{\mathrm{T}}W\textbf{x}\right)\mathrm{d}\textbf{x}
-\sum_{ab}W_{ab}\mathrm{Tr}\left(\bar{\rho}\bar{L}_a \bar{L}_b\right),<br />
\label{eq:BCB}
\end{equation}</p>
<p>and for single-parameter scenario, this inequality reduces to
\begin{equation}
\bar{C}\geq \int p(x) x^2\,\mathrm{d}x-\mathrm{Tr}(\bar{\rho}\bar{L}^2). 
\end{equation}</p>
<p>The function for calculating the Bayesian cost bound (BCB) is</p>
<div class="tabbed-set tabbed-alternate" data-tabs="27:2"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><input id="__tabbed_27_2" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">Python</label><label for="__tabbed_27_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">BCB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">BCB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">;</span><span class="w"> </span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>Example 3.10</strong><br />
<a id="example3_10"></a>
The Hamiltonian of a qubit system is 
\begin{align}
H=\frac{B\omega_0}{2}(\sigma_1\cos{x}+\sigma_3\sin{x}),
\end{align}</p>
<p>where <span class="arithmatex">\(B\)</span> is the magnetic field in the XZ plane, <span class="arithmatex">\(x\)</span> is the unknown parameter and <span class="arithmatex">\(\sigma_{1}\)</span>, 
<span class="arithmatex">\(\sigma_{3}\)</span> are the Pauli matrices. The probe state is taken as <span class="arithmatex">\(|\pm\rangle\)</span>. The measurement 
is <span class="arithmatex">\(\{|\!+\rangle\langle+\!|,|\!-\rangle\langle-\!|\}\)</span>. Here <span class="arithmatex">\(|\pm\rangle:=\frac{1}{\sqrt{2}}
(|0\rangle\pm|1\rangle)\)</span> with <span class="arithmatex">\(|0\rangle\)</span> <span class="arithmatex">\((|1\rangle)\)</span> the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> with respect 
to the eigenvalue <span class="arithmatex">\(1\)</span> <span class="arithmatex">\((-1)\)</span>. In this example, the prior distribution <span class="arithmatex">\(p(x)\)</span> is uniform on 
<span class="arithmatex">\([0, \pi/2]\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="28:2"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><input id="__tabbed_28_2" name="__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="__tabbed_28_1">Python</label><label for="__tabbed_28_2">Julia</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">quanestimation</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">B</span><span class="p">,</span> <span class="n">omega0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">H0_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="n">sx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># derivative of the free Hamiltonian on x</span>
<span class="n">dH_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="c1"># measurement</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">]</span>
<span class="c1"># prior distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># dynamics</span>
<span class="n">rho</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> \
       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">H0</span> <span class="o">=</span> <span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dH</span> <span class="o">=</span> <span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dynamics</span> <span class="o">=</span> <span class="n">Lindblad</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">)</span>
    <span class="n">rho_tp</span><span class="p">,</span> <span class="n">drho_tp</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">expm</span><span class="p">()</span>
    <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_tp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># average Bayesian cost</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xest</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">])]</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">BayesCost</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">xest</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Bayesian cost Bound</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">BCB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">StatsBase</span>

<span class="c"># free Hamiltonian</span>
<span class="k">function</span><span class="w"> </span><span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="n">sx</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">end</span>
<span class="c"># derivative of the free Hamiltonian on x</span>
<span class="k">function</span><span class="w"> </span><span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">omega0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sx</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sz</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="k">end</span>

<span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">omega0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">pi</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span>
<span class="c"># initial state</span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="c"># measurement </span>
<span class="n">M1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w">  </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span>
<span class="n">M2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="n">M2</span><span class="p">]</span>
<span class="c"># prior distribution</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="kt">Vector</span>
<span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="k">end</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c"># dynamics</span>
<span class="n">rho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Matrix</span><span class="p">{</span><span class="kt">ComplexF64</span><span class="p">}}(</span><span class="nb">undef</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">H0_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H0_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="n">dH_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dH_func</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="w">    </span><span class="n">rho_tp</span><span class="p">,</span><span class="w"> </span><span class="n">drho_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0_tp</span><span class="p">,</span><span class="w"> </span><span class="n">dH_tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rho_tp</span><span class="p">[</span><span class="k">end</span><span class="p">]</span>
<span class="k">end</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># average Bayesian cost</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">SIC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xest</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">]]</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BayesCost</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">xest</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Bayesian cost Bound</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">BCB</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">)</span>
</code></pre></div></p>
</div>
</div>
</div>
<hr />
<h2 id="bibliography"><strong>Bibliography</strong><a class="headerlink" href="#bibliography" title="Permanent link">&para;</a></h2>
<p><a id="Helstrom1976">[1]</a>
C. W. Helstrom, 
<em>Quantum Detection and Estimation Theory</em>
(New York: Academic, 1976).</p>
<p><a id="Holevo1982">[2]</a> 
A. S. Holevo, 
<em>Probabilistic and Statistical Aspects of Quantum Theory</em>
(Amsterdam: North-Holland, 1982).</p>
<p><a id="Liu2020">[3]</a> 
J. Liu, H. Yuan, X.-M. Lu, and X. Wang,
Quantum Fisher information matrix and multiparameter estimation,
<a href="https://doi.org/10.1088/1751-8121/ab5d4d">J. Phys. A: Math. Theor. <strong>53</strong>, 023001 (2020).</a></p>
<p><a id="Holevo1973">[4]</a> 
A. S Holevo,
Statistical decision theory for quantum systems,
<a href="https://doi.org/10.1016/0047-259X(73)90028-6">J. Multivariate Anal. <strong>3</strong>, 337-394 (1973).</a></p>
<p><a id="Rafal2020">[5]</a> 
R. Demkowicz-Dobrzański, W. Górecki, and M. Guţă,
Multi-parameter estimation beyond Quantum Fisher Information,
<a href="https://doi.org/10.1088/1751-8121/ab8ef3">J. Phys. A: Math. Theor. <strong>53</strong>, 363001 (2020).</a></p>
<p><a id="Nagaoka1989">[6]</a> 
H. Nagaoka,
A New Approach to Cra ´ mer–Rao Bounds for Quantum State Estimation,
Tech. Rep. IT89-42, 9 (1989).</p>
<p><a id="Hayashi1999">[7]</a> 
M. Hayashi,
On simultaneous measurement of noncommutative observables. In Development of 
Infinite-Dimensional Non-Commutative Anaysis,
96–188 (Kyoto Univ., 1999).</p>
<p><a id="Conlon2021">[8]</a> 
L. O. Conlon, J. Suzuki, P. K. Lam, and S. M. Assad,
Efficient computation of the Nagaoka–Hayashi bound for multiparameter estimation with separable measurements,
<a href="https://doi.org/10.1038/s41534-021-00414-1">npj Quantum Inf.  <strong>7</strong>, 110 (2021).</a></p>
<p><a id="Liu2016">[9]</a>
J. Liu and H. Yuan, 
Valid lower bound for all estimators in quantum parameter estimation, 
<a href="https://doi.org/10.1088/1367-2630/18/9/093009">New J. Phys. <strong>18</strong>, 093009 (2016).</a></p>
<p><a id="vanTrees1968">[10]</a> 
H. L. Van Trees, 
<em>Detection, estimation, and modulation theory: Part I</em>
(Wiley, New York, 1968).</p>
<p><a id="Zhong2013">[11]</a> 
W. Zhong, Z. Sun, J. Ma, X. Wang, and F. Nori,
Fisher information under decoherence in Bloch representation, 
<a href="https://doi.org/10.1103/PhysRevA.87.022337">Phys. Rev. A <strong>87</strong>, 022337 (2013).</a></p>
<p><a id="Tsang2011">[12]</a> 
M. Tsang, H. M. Wiseman, and C. M. Caves, 
Fundamental quantum limit to waveform estimation, 
<a href="https://doi.org/10.1103/PhysRevLett.106.090401">Phys. Rev. Lett. <strong>106</strong>, 090401 (2011).</a></p>
<p><a id="Safranek2019">[13]</a> 
D. Šafránek,
Estimation of Gaussian quantum states,
<a href="https://doi.org/10.1088/1751-8121/aaf068">J. Phys. A: Math. Theor. <strong>52</strong>, 035304 (2019).</a></p>
<p><a id="Robert2007">[14]</a> 
C. P. Robert,
<em>The Bayesian Choice</em> (Berlin: Springer, 2007).</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/mathjaxhelper.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>