
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docs of QuanEstimation">
      
      
      
        <meta name="author" content="QuanEstimation">
      
      
        <link rel="canonical" href="https://quanestimation.github.io/QuanEstimation/guide/guide_Sopt/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-7.2.3">
    
    
      
        <title>State optimization - QuanEstimation Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/style.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/julia_api.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#state-optimization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="QuanEstimation Docs" class="md-header__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuanEstimation Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              State optimization
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../installation/" class="md-tabs__link">
      Installation
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../guide_import/" class="md-tabs__link md-tabs__link--active">
        Users Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../API/python/classes/" class="md-tabs__link">
        API documentation
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../examples/" class="md-tabs__link">
      Examples
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../citing/" class="md-tabs__link">
      Citing
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../developers/" class="md-tabs__link">
      Developers
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="QuanEstimation Docs" class="md-nav__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6z"/></svg>

    </a>
    QuanEstimation Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Users Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Users Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Users Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_import/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_dynamics/" class="md-nav__link">
        Parameterization process
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_bounds/" class="md-nav__link">
        Quantum metrological tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_resources/" class="md-nav__link">
        Metrological resources
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Copt/" class="md-nav__link">
        Control optimization
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          State optimization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        State optimization
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ad" class="md-nav__link">
    AD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ri" class="md-nav__link">
    RI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pso" class="md-nav__link">
    PSO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de" class="md-nav__link">
    DE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nm" class="md-nav__link">
    NM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpg" class="md-nav__link">
    DDPG
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    Bibliography
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Mopt/" class="md-nav__link">
        Measurement optimization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Compopt/" class="md-nav__link">
        Comprehensive optimization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide_adaptive/" class="md-nav__link">
        Adaptive measurement schemes
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        API documentation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      <label class="md-nav__link" for="__nav_4_1">
        Python
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/classes/" class="md-nav__link">
        Classes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../API/julia/api/" class="md-nav__link">
        Julia
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../citing/" class="md-nav__link">
        Citing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../developers/" class="md-nav__link">
        Developers
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ad" class="md-nav__link">
    AD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ri" class="md-nav__link">
    RI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pso" class="md-nav__link">
    PSO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de" class="md-nav__link">
    DE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nm" class="md-nav__link">
    NM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpg" class="md-nav__link">
    DDPG
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    Bibliography
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/QuanEstimation/QuanEstimation/edit/master/docs/guide/guide_Sopt.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="state-optimization"><strong>State optimization</strong><a class="headerlink" href="#state-optimization" title="Permanent link">&para;</a></h1>
<p>For state optimization in QuanEstimation, the probe state is expanded as 
<span class="arithmatex">\(|\psi\rangle=\sum_i c_i|i\rangle\)</span> in a specific basis <span class="arithmatex">\(\{|i\rangle\}\)</span>. Thus, search of the 
optimal probe states is equal to search of the normalized complex coefficients <span class="arithmatex">\(\{c_i\}\)</span>. In 
QuanEstimation, the state optimization algorithms are the automatic differentiation (AD) 
<a href="#Baydin2018">[1]</a>, reverse iterative (RI)<a href="#Rafal2011">[2]</a> algorithm, particle swarm optimization (PSO) 
<a href="#Kennedy1995">[3]</a>, differential evolution (DE) <a href="#Storn1997">[4]</a>, Nelder-Mead (NM) 
<a href="#Nelder1965">[5]</a>, and deep deterministic policy gradients (DDPG) <a href="#Lillicrap2015">[6]</a>. 
Call the following codes to perform state optimizaiton</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">Hc</span><span class="o">=</span><span class="p">[],</span> <span class="n">ctrl</span><span class="o">=</span><span class="p">[],</span> <span class="n">decay</span><span class="o">=</span><span class="p">[],</span> 
               <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
<input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><label for="__tabbed_2_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span><span class="o">.</span><span class="n">HCRB</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
</div>
<p>The variable <code>savefile</code> means whether to save all the states. If set <code>False</code> (default) the 
states in the final episode and the values of the objective function in all episodes will 
be saved. If set <code>True</code> then the states and the values of the objective function obtained 
in all episodes will be saved during the training. <code>method</code> represents the algorithm used 
to optimize the states, options are: "AD", "PSO", "DE", "DDPG" and "NM". <code>**kwargs</code> contains 
the keywords and default values corresponding to the optimization algorithm which will be 
introduced in detail below.</p>
<p><code>tspan</code> is the time length for the evolution, <code>H0</code> and <code>dH</code> are the free Hamiltonian and its
derivatives with respect to the unknown parameters to be estimated. <code>H0</code> accepts both matrix 
(time-independent evolution) and list (time-dependent evolution) with the length equal to 
<code>tspan</code>. <code>dH</code> should be input as <span class="arithmatex">\([\partial_a{H_0}, \partial_b{H_0}, \cdots]\)</span>. <code>Hc</code> 
and <code>ctrl</code> are two lists represent the control Hamiltonians and the corresponding control 
coefficients. <code>decay</code> contains decay operators <span class="arithmatex">\((\Gamma_1, \Gamma_2, \cdots)\)</span> and the 
corresponding decay rates <span class="arithmatex">\((\gamma_1, \gamma_2, \cdots)\)</span> with the input rule 
decay=[[<span class="arithmatex">\(\Gamma_1\)</span>, <span class="arithmatex">\(\gamma_1\)</span>], [<span class="arithmatex">\(\Gamma_2\)</span>, <span class="arithmatex">\(\gamma_2\)</span>],...]. The default values for 
<code>decay</code>, <code>Hc</code> and <code>ctrl</code> are empty which means the dynamics is unitary and only governed by 
the free Hamiltonian. <code>dyn_method="expm"</code> represents the method for solving the dynamics is 
matrix exponential, it can also be set as <code>dyn_method="ode"</code> which means the dynamics 
(differential equation) is directly solved with the ODE solvers.</p>
<p>The objective functions for state optimization can be chosen as QFI <span class="arithmatex">\(\left[\mathrm{Tr}
(W\mathcal{F}^{-1})\right]\)</span>, CFI <span class="arithmatex">\(\left[\mathrm{Tr}(W\mathcal{I}^{-1})\right]\)</span> and HCRB, 
the corresponding codes for them are <code>state.QFIM()</code> (default), <code>state.CFIM()</code> and 
<code>state.HCRB()</code>. Here <span class="arithmatex">\(\mathcal{F}\)</span> and <span class="arithmatex">\(\mathcal{I}\)</span> are the QFIM and CFIM, <span class="arithmatex">\(W\)</span> corresponds 
to <code>W</code> represents the weight matrix, the default value for <code>W</code> is the identity matrix. If 
the users call <code>state.HCRB()</code> for single parameter scenario, the program will exit and print 
<code>"Program terminated. In the single-parameter scenario, the HCRB is equivalent to the QFI. Please 
choose 'QFIM' as the objective function"</code>. <code>LDtype</code> in <code>state.QFIM()</code> represents the types 
of the QFIM, it can be set as <code>LDtype="SLD"</code> (default), <code>LDtype="RLD"</code> and <code>LDtype="LLD"</code>. 
<code>M</code> represents a set of positive operator-valued measure (POVM) with default value <code>[]</code>. 
In the package, a set of rank-one symmetric informationally complete POVM (SIC-POVM) is 
used when <code>M=[]</code>.</p>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">opt</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">psi</span><span class="o">=</span><span class="n">psi</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">AD</span><span class="p">(</span><span class="n">kwargs</span><span class="o">...</span><span class="p">)</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">;</span> <span class="n">Hc</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> 
                    <span class="n">ctrl</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="ss">:Expm</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">QFIM_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">CFIM_obj</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><label for="__tabbed_3_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">HCRB_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p><div class="highlight"><pre><span></span><code><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">alg</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">dynamics</span><span class="p">;</span> <span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
The initial state (optimization variable) can be input via <code>psi=psi</code> in <code>StateOpt()</code> for 
constructing a state optimization problem. <code>psi</code> is an array representing the state. 
<code>Lindblad</code> accepts the dynamics parameters. <code>tspan</code> is the time length for the evolution, 
<code>H0</code> and <code>dH</code> are the free Hamiltonian and its derivatives with respect to the unknown 
parameters to be estimated. <code>H0</code> accepts both matrix (time-independent evolution) and list 
(time-dependent evolution) with the length equal to <code>tspan</code>. <code>dH</code> should be input as 
<span class="arithmatex">\([\partial_a{H_0}, \partial_b{H_0}, \cdots]\)</span>. <code>Hc</code> and <code>ctrl</code> are two lists represent the 
control Hamiltonians and the corresponding control coefficients. <code>decay</code> contains decay 
operators <span class="arithmatex">\((\Gamma_1, \Gamma_2, \cdots)\)</span> and the corresponding decay rates 
<span class="arithmatex">\((\gamma_1, \gamma_2, \cdots)\)</span> with the input rule 
decay=[[<span class="arithmatex">\(\Gamma_1\)</span>, <span class="arithmatex">\(\gamma_1\)</span>], [<span class="arithmatex">\(\Gamma_2\)</span>, <span class="arithmatex">\(\gamma_2\)</span>],...]. The default values for 
<code>decay</code>, <code>Hc</code> and <code>ctrl</code> are <code>missing</code> which means the dynamics is unitary and only governed 
by the free Hamiltonian. <code>seed</code> is the random seed which can ensure the reproducibility of 
results. <code>dyn_method=:Expm</code> represents the method for solving the dynamics is 
matrix exponential, it can also be set as <code>dyn_method=:Ode</code> which means the dynamics 
(differential equation) is directly solved with the ODE solvers.</p>
<p>The objective functions for state optimization can be set as QFI (<span class="arithmatex">\(\mathrm{Tr}(W\mathcal{F}^
{-1})\)</span>), CFI (<span class="arithmatex">\(\mathrm{Tr}(W\mathcal{I}^{-1})\)</span>) and HCRB, the corresponding codes for them are
<code>QFIM_obj()</code> (default), <code>CFIM_obj()</code> and <code>HCRB_obj()</code>. Here <span class="arithmatex">\(\mathcal{F}\)</span> and 
<span class="arithmatex">\(\mathcal{I}\)</span> are the QFIM and CFIM, <span class="arithmatex">\(W\)</span> corresponds to <code>W</code> is the weight matrix which 
defaults to the identity matrix. If the users call <code>HCRB_obj()</code> for single parameter 
scenario, the program will exit and print <code>"Program terminated. In the single-parameter scenario, 
the HCRB is equivalent to the QFI. Please choose 'QFIM_obj()' as the objective function"</code>.
<code>LDtype</code> in <code>QFIM_obj()</code> represents the types of the QFIM, it can be set as <code>LDtype=:SLD</code> 
(default), <code>LDtype=:RLD</code> and <code>LDtype=:LLD</code>. <code>M</code> represents a set of positive operator-valued 
measure (POVM) with default value <code>missing</code>. In the package, a set of rank-one symmetric 
informationally complete POVM (SIC-POVM) is used when <code>M=missing</code>.</p>
<p><code>savefile</code> means whether to save all the states. If set <code>false</code> (default) the states in the 
final episode and the values of the objective function in all episodes will be saved. If set 
<code>true</code> then the states and the values of the objective function obtained in all episodes will 
be saved during the training. The algorithm used to optimize the states in QuanEstimation 
are AD, PSO, DE, DDPG and NM. <code>kwargs...</code> contains the keywords and default values corresponding 
to the optimization algorithm which will be introduced in detail below.</p>
</div>
</div>
<hr />
<h2 id="ad"><strong>AD</strong><a class="headerlink" href="#ad" title="Permanent link">&para;</a></h2>
<p>The code for state optimization with AD is as follows</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;GRAPE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> 
          <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of AD can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"Adam"</td>
<td align="center">False</td>
</tr>
<tr>
<td align="center">"psi0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">300</td>
</tr>
<tr>
<td align="center">"epsilon"</td>
<td align="center">0.01</td>
</tr>
<tr>
<td align="center">"beta1"</td>
<td align="center">0.90</td>
</tr>
<tr>
<td align="center">"beta2"</td>
<td align="center">0.99</td>
</tr>
</tbody>
</table>
<p>In state optimization, the state will update according to the learning rate <code>"epsilon"</code>.
However, Adam algorithm can be introduced to update the states which can be realized by setting 
<code>Adam=True</code>. In this case, the Adam parameters include learning rate, the exponential decay 
rate for the first moment estimates and the second moment estimates can be set by the user via 
<code>epsilon</code>, <code>beta1</code> and <code>beta2</code>. <code>psi0</code> is a list representing the initial guesses of states and 
<code>max_episode</code> is the number of episodes.</p>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span> <span class="o">=</span> <span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span> 
         <span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of AD can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"Adam"</td>
<td align="center">false</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">300</td>
</tr>
<tr>
<td align="center">"epsilon"</td>
<td align="center">0.01</td>
</tr>
<tr>
<td align="center">"beta1"</td>
<td align="center">0.90</td>
</tr>
<tr>
<td align="center">"beta2"</td>
<td align="center">0.99</td>
</tr>
</tbody>
</table>
<p>In state optimization, the state will update according to the learning rate <code>"epsilon"</code>.
However, Adam algorithm can be introduced to update the states which can be realized by setting 
<code>Adam=true</code>. In this case, the Adam parameters include learning rate, the exponential decay 
rate for the first moment estimates and the second moment estimates can be set by the user via 
<code>epsilon</code>, <code>beta1</code> and <code>beta2</code>.</p>
</div>
</div>
<h2 id="ri"><strong>RI</strong><a class="headerlink" href="#ri" title="Permanent link">&para;</a></h2>
<p>The code for state optimization with RI is as follows</p>
<div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;RI&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of RI can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"psi0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">300</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>psi0</code> is a list representing the initial guesses of states and <code>max_episode</code> is the number of episodes. <code>seed</code> is the random seed. </p>
</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span> <span class="o">=</span> <span class="n">RI</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of RI can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"max_episode"</td>
<td align="center">300</td>
</tr>
</tbody>
</table>
<p><code>max_episode</code> is the number of episodes.</p>
</div>
</div>
<h2 id="pso"><strong>PSO</strong><a class="headerlink" href="#pso" title="Permanent link">&para;</a></h2>
<p>The code for state optimization with PSO is as follows</p>
<div class="tabbed-set" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> 
          <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of PSO can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"psi0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">[1000,100]</td>
</tr>
<tr>
<td align="center">"c0"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"c1"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"c2"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> is the number of particles. Here <code>max_episode</code> accepts both integers and 
arrays with two elements. If it is an integer, for example <code>max_episode=1000</code>, it means the 
program will continuously run 1000 episodes. However, if it is an array, for example 
<code>max_episode=[1000,100]</code>, the program will run 1000 episodes in total but replace states of 
all the particles with global best every 100 episodes. <code>c0</code>, <code>c1</code>, and <code>c2</code> are the PSO 
parameters representing the inertia weight, cognitive learning factor and social learning 
factor, respectively.  <code>seed</code> is the random seed.</p>
</div>
<input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><label for="__tabbed_6_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span> <span class="o">=</span> <span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span>  <span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> 
          <span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of PSO can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"ini_particle"</td>
<td align="center">missing</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">[1000,100]</td>
</tr>
<tr>
<td align="center">"c0"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"c1"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"c2"</td>
<td align="center">2.0</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> is the number of particles. <code>ini_particle</code> is a tuple representing the initial 
guesses of states and <code>max_episode</code> is the number of episodes. Here <code>max_episode</code> accepts 
both integers and arrays with two elements. If it is an integer, for example <code>max_episode=1000</code>, 
it means the program will continuously run 1000 episodes. However, if it is an array, for example 
<code>max_episode=[1000,100]</code>, the program will run 1000 episodes in total but replace states of 
all the particles with global best every 100 episodes. <code>c0</code>, <code>c1</code>, and <code>c2</code> are the PSO 
parameters representing the inertia weight, cognitive learning factor and social learning 
factor, respectively. </p>
</div>
</div>
<h2 id="de"><strong>DE</strong><a class="headerlink" href="#de" title="Permanent link">&para;</a></h2>
<p>The code for state optimization with DE is as follows</p>
<div class="tabbed-set" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> 
          <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of DE can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"psi0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"c"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"cr"</td>
<td align="center">0.5</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> represents the number of populations. <code>c</code> and <code>cr</code> are the mutation constant and 
crossover constant.</p>
</div>
<input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><label for="__tabbed_7_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span> <span class="o">=</span> <span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> 
         <span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of DE can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"ini_population"</td>
<td align="center">missing</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"c"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"cr"</td>
<td align="center">0.5</td>
</tr>
</tbody>
</table>
<p><code>ini_population</code> is a tuple representing the initial guesses of states , <code>c</code> and <code>cr</code> 
are the mutation constant and crossover constant.</p>
</div>
</div>
<h2 id="nm"><strong>NM</strong><a class="headerlink" href="#nm" title="Permanent link">&para;</a></h2>
<p>The code for state optimization with NM is as follows</p>
<div class="tabbed-set" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><label for="__tabbed_8_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;NM&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;ar&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> 
          <span class="s2">&quot;ae&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;ac&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;as0&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of NM can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"psi0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"ar"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"ae"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"ac"</td>
<td align="center">0.5</td>
</tr>
<tr>
<td align="center">"as0"</td>
<td align="center">0.5</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> represents the number of initial states. <code>ar</code>, <code>ae</code>, <code>ac</code>, and <code>as0</code> are 
constants for reflection, expansion, constraction, and shrink, respectively.</p>
</div>
<input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><label for="__tabbed_8_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span> <span class="o">=</span> <span class="n">NM</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ini_state</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
         <span class="n">ae</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">as0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of NM can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"ini_state"</td>
<td align="center">missing</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"ar"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"ae"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"ac"</td>
<td align="center">0.5</td>
</tr>
<tr>
<td align="center">"as0"</td>
<td align="center">0.5</td>
</tr>
</tbody>
</table>
<p><code>ini_state</code> represents the number of initial states. <code>ar</code>, <code>ae</code>, <code>ac</code>, and <code>as0</code> are 
constants for reflection, expansion, constraction, and shrink, respectively.</p>
</div>
</div>
<h2 id="ddpg"><strong>DDPG</strong><a class="headerlink" href="#ddpg" title="Permanent link">&para;</a></h2>
<p>The code for state optimization with DDPG is as follows</p>
<div class="tabbed-set" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><label for="__tabbed_9_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;DDPG&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer_num&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of DDPG can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"psi0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"layer_num"</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">"layer_dim"</td>
<td align="center">200</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>layer_num</code> and <code>layer_dim</code> represent the number of layers (include the input and output layer) 
and the number of neurons in the hidden layer.</p>
</div>
<input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><label for="__tabbed_9_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span> <span class="o">=</span> <span class="n">DDPG</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">layer_num</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">layer_dim</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
The keywords and the default values of DDPG can be seen in the following 
table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"layer_num"</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">"layer_dim"</td>
<td align="center">200</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>layer_num</code> and <code>layer_dim</code> represent the number of layers (include the input and output layer) 
and the number of neurons in the hidden layer.</p>
</div>
</div>
<p><strong>Example 6.1</strong><br />
<a id="example6_1"></a>
The Hamiltonian of the Lipkin–Meshkov–Glick (LMG) model is
\begin{align}
H_{\mathrm{LMG}}=-\frac{\lambda}{N}(J_1^2+gJ_2^2)-hJ_3,
\end{align}</p>
<p>where <span class="arithmatex">\(N\)</span> is the number of spins of the system, <span class="arithmatex">\(\lambda\)</span> is the spin–spin interaction strength, 
<span class="arithmatex">\(h\)</span> is the strength of the external field and <span class="arithmatex">\(g\)</span> is the anisotropic parameter. 
<span class="arithmatex">\(J_i=\frac{1}{2}\sum_{j=1}^N \sigma_i^{(j)}\)</span> (<span class="arithmatex">\(i=1,2,3\)</span>) is the collective spin operator with 
<span class="arithmatex">\(\sigma_i^{(j)}\)</span> the <span class="arithmatex">\(i\)</span>th Pauli matrix for the <span class="arithmatex">\(j\)</span>th spin. In single-parameter scenario, we take 
<span class="arithmatex">\(g\)</span> as the unknown parameter to be estimated. The states are expanded as 
<span class="arithmatex">\(|\psi\rangle=\sum^J_{m=-J}c_m|J,m\rangle\)</span> with <span class="arithmatex">\(|J,m\rangle\)</span> the Dicke state and <span class="arithmatex">\(c_m\)</span> a complex 
coefficient. Here we fixed <span class="arithmatex">\(J=N/2\)</span>. In this example, the probe state is optimized for both noiseless
scenario and collective dephasing noise. The dynamics under collective dephasing can be expressed as
<center> <span class="arithmatex">\(\partial_t\rho = -i[H_{\mathrm{LMG}},\rho]+\gamma \left(J_3\rho J_3-\frac{1}{2}\left\{\rho, J^2_3\right\}\right)\)</span> </center>
with <span class="arithmatex">\(\gamma\)</span> the decay rate.</p>
<p>In this case, all searches with different algorithms start from the coherent spin state defined by
<span class="arithmatex">\(|\theta=\frac{\pi}{2},\phi=\frac{\pi}{2}\rangle=\exp(-\frac{\theta}{2}e^{-i\phi}J_{+}+\frac{\theta}{2}e^{i\phi}J_{-})|J,J\rangle\)</span> with <span class="arithmatex">\(J_{\pm}=J_1{\pm}iJ_2\)</span>. Here, QuTip <a href="#Johansson2012">[6,7]</a> is applied
for generation of the spin coherent state.</p>
<div class="tabbed-set" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><label for="__tabbed_10_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">quanestimation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># the dimension of the system</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1"># generation of the coherent spin state</span>
<span class="n">psi_css</span> <span class="o">=</span> <span class="n">spin_coherent</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ket&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
<span class="n">psi_css</span> <span class="o">=</span> <span class="n">psi_css</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># guessed state</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="p">[</span><span class="n">psi_css</span><span class="p">]</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">Lambda</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">Jx</span><span class="p">,</span> <span class="n">Jy</span><span class="p">,</span> <span class="n">Jz</span> <span class="o">=</span> <span class="n">jmat</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
<span class="n">Jx</span><span class="p">,</span> <span class="n">Jy</span><span class="p">,</span> <span class="n">Jz</span> <span class="o">=</span> <span class="n">Jx</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">Jy</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">Jz</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
<span class="n">H0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lambda</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Jx</span><span class="p">,</span> <span class="n">Jx</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Jy</span><span class="p">,</span> <span class="n">Jy</span><span class="p">))</span><span class="o">/</span><span class="n">N</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">Jz</span>
<span class="c1"># derivative of the free Hamiltonian on g</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">Lambda</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Jy</span><span class="p">,</span> <span class="n">Jy</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Jz</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="11:5"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><label for="__tabbed_11_1">AD</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><label for="__tabbed_11_2">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><label for="__tabbed_11_3">DE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_11_4" name="__tabbed_11" type="radio" /><label for="__tabbed_11_4">NM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: NM</span>
<span class="n">NM_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;ar&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;ae&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;ac&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;as0&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;NM&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">NM_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_11_5" name="__tabbed_11" type="radio" /><label for="__tabbed_11_5">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: DDPG</span>
<span class="n">DDPG_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer_num&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">:</span><span class="mi">250</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> \
              <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DDPG&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DDPG_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><label for="__tabbed_12_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><label for="__tabbed_12_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: CFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><label for="__tabbed_10_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">using</span> <span class="n">QuanEstimation</span>
<span class="k">using</span> <span class="n">Random</span>
<span class="k">using</span> <span class="n">StableRNGs</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>
<span class="k">using</span> <span class="n">SparseArrays</span>

<span class="c"># the dimension of the system</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c"># generation of the coherent spin state</span>
<span class="n">j</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">N÷2</span><span class="p">,</span> <span class="mf">0.5</span><span class="nb">pi</span><span class="p">,</span> <span class="mf">0.5</span><span class="nb">pi</span>
<span class="n">Jp</span> <span class="o">=</span> <span class="kt">Matrix</span><span class="p">(</span><span class="n">spdiagm</span><span class="p">(</span><span class="mi">1</span><span class="o">=&gt;</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="n">j</span><span class="o">:-</span><span class="mi">1</span><span class="o">:-</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]))</span>
<span class="n">Jm</span> <span class="o">=</span> <span class="n">Jp</span><span class="o">&#39;</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">theta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="nb">im</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">Jm</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">theta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">im</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">Jp</span><span class="p">)</span><span class="o">*</span>
       <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="kt">Int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dim</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">psi0</span><span class="p">)</span>
<span class="c"># free Hamiltonian</span>
<span class="n">lambda</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">Jx</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Jp</span> <span class="o">+</span> <span class="n">Jm</span><span class="p">)</span>
<span class="n">Jy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="nb">im</span><span class="o">*</span><span class="p">(</span><span class="n">Jp</span> <span class="o">-</span> <span class="n">Jm</span><span class="p">)</span>
<span class="n">Jz</span> <span class="o">=</span> <span class="n">spdiagm</span><span class="p">(</span><span class="n">j</span><span class="o">:-</span><span class="mi">1</span><span class="o">:-</span><span class="n">j</span><span class="p">)</span>
<span class="n">H0</span> <span class="o">=</span> <span class="o">-</span><span class="n">lambda</span><span class="o">*</span><span class="p">(</span><span class="n">Jx</span><span class="o">*</span><span class="n">Jx</span> <span class="o">+</span> <span class="n">g</span><span class="o">*</span><span class="n">Jy</span><span class="o">*</span><span class="n">Jy</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">Jz</span>
<span class="c"># derivative of the free Hamiltonian on g</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">lambda</span><span class="o">*</span><span class="n">Jy</span><span class="o">*</span><span class="n">Jy</span><span class="o">/</span><span class="n">N</span><span class="p">]</span>
<span class="c"># dissipation</span>
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Jz</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">2500</span><span class="p">)</span>
<span class="c"># set the optimization type</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">StateOpt</span><span class="p">(</span><span class="n">psi</span><span class="o">=</span><span class="n">psi0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span> 
</code></pre></div>
<div class="tabbed-set" data-tabs="13:5"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><label for="__tabbed_13_1">AD</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: AD</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> 
                        <span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span> <span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><label for="__tabbed_14_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><label for="__tabbed_14_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><label for="__tabbed_13_2">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: PSO</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                         <span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><label for="__tabbed_15_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><label for="__tabbed_15_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_13_3" name="__tabbed_13" type="radio" /><label for="__tabbed_13_3">DE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: DE</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><label for="__tabbed_16_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><label for="__tabbed_16_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_13_4" name="__tabbed_13" type="radio" /><label for="__tabbed_13_4">NM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: NM</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">NM</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                        <span class="n">ae</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">as0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><label for="__tabbed_17_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><label for="__tabbed_17_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_13_5" name="__tabbed_13" type="radio" /><label for="__tabbed_13_5">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: DDPG</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DDPG</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">layer_num</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">layer_dim</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><label for="__tabbed_18_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><label for="__tabbed_18_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> 
                                   <span class="n">dyn_method</span><span class="o">=</span><span class="ss">:Expm</span><span class="p">)</span> 
<span class="c"># run the state optimization problem</span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">alg</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">dynamics</span><span class="p">;</span> <span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p><strong>Example 6.2</strong><br />
<a id="example6_2"></a>
In the multiparameter scenario, <span class="arithmatex">\(g\)</span> and <span class="arithmatex">\(h\)</span> are chooen to be the unknown parameters to be estimated.</p>
<div class="tabbed-set" data-tabs="19:2"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><label for="__tabbed_19_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">quanestimation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># the dimension of the system</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1"># generation of coherent spin state</span>
<span class="n">psi_css</span> <span class="o">=</span> <span class="n">spin_coherent</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ket&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
<span class="n">psi_css</span> <span class="o">=</span> <span class="n">psi_css</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># guessed state</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="p">[</span><span class="n">psi_css</span><span class="p">]</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">Lambda</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">Jx</span><span class="p">,</span> <span class="n">Jy</span><span class="p">,</span> <span class="n">Jz</span> <span class="o">=</span> <span class="n">jmat</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
<span class="n">Jx</span><span class="p">,</span> <span class="n">Jy</span><span class="p">,</span> <span class="n">Jz</span> <span class="o">=</span> <span class="n">Jx</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">Jy</span><span class="o">.</span><span class="n">full</span><span class="p">(),</span> <span class="n">Jz</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
<span class="n">H0</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lambda</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Jx</span><span class="p">,</span> <span class="n">Jx</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Jy</span><span class="p">,</span> <span class="n">Jy</span><span class="p">))</span><span class="o">/</span><span class="n">N</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">Jz</span>
<span class="c1"># derivatives of the free Hamiltonian on the g and h</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">Lambda</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Jy</span><span class="p">,</span> <span class="n">Jy</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="o">-</span><span class="n">Jz</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Jz</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>
<span class="c1"># weight matrix</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">]])</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="20:5"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><label for="__tabbed_20_1">AD</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="21:3"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><label for="__tabbed_21_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WF^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_21_2" name="__tabbed_21" type="radio" /><label for="__tabbed_21_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WI^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_21_3" name="__tabbed_21" type="radio" /><label for="__tabbed_21_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: HCRB</span>
<span class="n">state</span><span class="o">.</span><span class="n">HCRB</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><label for="__tabbed_20_2">PSO</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="22:3"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><label for="__tabbed_22_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WF^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_22_2" name="__tabbed_22" type="radio" /><label for="__tabbed_22_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WI^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_22_3" name="__tabbed_22" type="radio" /><label for="__tabbed_22_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: HCRB</span>
<span class="n">state</span><span class="o">.</span><span class="n">HCRB</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_20_3" name="__tabbed_20" type="radio" /><label for="__tabbed_20_3">DE</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="23:3"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><label for="__tabbed_23_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WF^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_23_2" name="__tabbed_23" type="radio" /><label for="__tabbed_23_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WI^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_23_3" name="__tabbed_23" type="radio" /><label for="__tabbed_23_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: HCRB</span>
<span class="n">state</span><span class="o">.</span><span class="n">HCRB</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_20_4" name="__tabbed_20" type="radio" /><label for="__tabbed_20_4">NM</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: NM</span>
<span class="n">NM_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:</span><span class="n">psi0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;ar&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;ae&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;ac&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;as0&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;NM&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">NM_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="24:3"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><label for="__tabbed_24_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WF^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_24_2" name="__tabbed_24" type="radio" /><label for="__tabbed_24_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WI^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_24_3" name="__tabbed_24" type="radio" /><label for="__tabbed_24_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: HCRB</span>
<span class="n">state</span><span class="o">.</span><span class="n">HCRB</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_20_5" name="__tabbed_20" type="radio" /><label for="__tabbed_20_5">DDPG</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: DDPG</span>
<span class="n">DDPG_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer_num&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">:</span><span class="mi">250</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> \
              <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DDPG&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DDPG_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> <span class="n">dyn_method</span><span class="o">=</span><span class="s2">&quot;expm&quot;</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="25:2"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><label for="__tabbed_25_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WF^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_25_2" name="__tabbed_25" type="radio" /><label for="__tabbed_25_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WI^{-1})</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
<input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><label for="__tabbed_19_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">using</span> <span class="n">QuanEstimation</span>
<span class="k">using</span> <span class="n">Random</span>
<span class="k">using</span> <span class="n">StableRNGs</span>
<span class="k">using</span> <span class="n">LinearAlgebra</span>
<span class="k">using</span> <span class="n">SparseArrays</span>

<span class="c"># the dimension of the system</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c"># generation of the coherent spin state</span>
<span class="n">j</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">N÷2</span><span class="p">,</span> <span class="mf">0.5</span><span class="nb">pi</span><span class="p">,</span> <span class="mf">0.5</span><span class="nb">pi</span>
<span class="n">Jp</span> <span class="o">=</span> <span class="kt">Matrix</span><span class="p">(</span><span class="n">spdiagm</span><span class="p">(</span><span class="mi">1</span><span class="o">=&gt;</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span> <span class="k">in</span> <span class="n">j</span><span class="o">:-</span><span class="mi">1</span><span class="o">:-</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]))</span>
<span class="n">Jm</span> <span class="o">=</span> <span class="n">Jp</span><span class="o">&#39;</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">theta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="nb">im</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">Jm</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">theta</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">im</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">Jp</span><span class="p">)</span><span class="o">*</span>
           <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="kt">Int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dim</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">psi0</span><span class="p">)</span>
<span class="c"># free Hamiltonian</span>
<span class="n">lambda</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">Jx</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Jp</span> <span class="o">+</span> <span class="n">Jm</span><span class="p">)</span>
<span class="n">Jy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="nb">im</span><span class="o">*</span><span class="p">(</span><span class="n">Jp</span> <span class="o">-</span> <span class="n">Jm</span><span class="p">)</span>
<span class="n">Jz</span> <span class="o">=</span> <span class="n">spdiagm</span><span class="p">(</span><span class="n">j</span><span class="o">:-</span><span class="mi">1</span><span class="o">:-</span><span class="n">j</span><span class="p">)</span>
<span class="n">H0</span> <span class="o">=</span> <span class="o">-</span><span class="n">lambda</span><span class="o">*</span><span class="p">(</span><span class="n">Jx</span><span class="o">*</span><span class="n">Jx</span> <span class="o">+</span> <span class="n">g</span><span class="o">*</span><span class="n">Jy</span><span class="o">*</span><span class="n">Jy</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span> <span class="o">+</span> <span class="n">g</span> <span class="o">*</span> <span class="n">Jy</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="n">N</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">Jz</span>
<span class="c"># derivative of the free Hamiltonian on g</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">lambda</span><span class="o">*</span><span class="n">Jy</span><span class="o">*</span><span class="n">Jy</span><span class="o">/</span><span class="n">N</span><span class="p">,</span> <span class="o">-</span><span class="n">Jz</span><span class="p">]</span>
<span class="c"># dissipation</span>
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Jz</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">2500</span><span class="p">)</span>
<span class="c"># weight matrix</span>
<span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="mf">0.</span><span class="p">;</span> <span class="mf">0.</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span>
<span class="c"># set the optimization type</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">StateOpt</span><span class="p">(</span><span class="n">psi</span><span class="o">=</span><span class="n">psi0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="26:5"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><label for="__tabbed_26_1">AD</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: AD</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> 
                        <span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span> <span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="27:2"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><label for="__tabbed_27_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WF^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_27_2" name="__tabbed_27" type="radio" /><label for="__tabbed_27_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WI^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_26_2" name="__tabbed_26" type="radio" /><label for="__tabbed_26_2">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: PSO</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                         <span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="28:3"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><label for="__tabbed_28_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WF^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_28_2" name="__tabbed_28" type="radio" /><label for="__tabbed_28_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WI^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_28_3" name="__tabbed_28" type="radio" /><label for="__tabbed_28_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: HCRB</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">HCRB_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_26_3" name="__tabbed_26" type="radio" /><label for="__tabbed_26_3">DE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: DE</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="29:3"><input checked="checked" id="__tabbed_29_1" name="__tabbed_29" type="radio" /><label for="__tabbed_29_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WF^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_29_2" name="__tabbed_29" type="radio" /><label for="__tabbed_29_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WI^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_29_3" name="__tabbed_29" type="radio" /><label for="__tabbed_29_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: HCRB</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">HCRB_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_26_4" name="__tabbed_26" type="radio" /><label for="__tabbed_26_4">NM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: NM</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">NM</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                        <span class="n">ae</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">as0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="30:3"><input checked="checked" id="__tabbed_30_1" name="__tabbed_30" type="radio" /><label for="__tabbed_30_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WF^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_30_2" name="__tabbed_30" type="radio" /><label for="__tabbed_30_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WI^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_30_3" name="__tabbed_30" type="radio" /><label for="__tabbed_30_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: HCRB</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">HCRB_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_26_5" name="__tabbed_26" type="radio" /><label for="__tabbed_26_5">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: DDPG</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DDPG</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">layer_num</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">layer_dim</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="31:2"><input checked="checked" id="__tabbed_31_1" name="__tabbed_31" type="radio" /><label for="__tabbed_31_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WF^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_31_2" name="__tabbed_31" type="radio" /><label for="__tabbed_31_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WI^{-1})</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> 
                                   <span class="n">dyn_method</span><span class="o">=</span><span class="ss">:Expm</span><span class="p">)</span> 
<span class="c"># run the state optimization problem</span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">alg</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">dynamics</span><span class="p">;</span> <span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>If the parameterization process is implemented with the Kraus operators, then the corresponding 
codes are</p>
<div class="tabbed-set" data-tabs="32:2"><input checked="checked" id="__tabbed_32_1" name="__tabbed_32" type="radio" /><label for="__tabbed_32_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="33:3"><input checked="checked" id="__tabbed_33_1" name="__tabbed_33" type="radio" /><label for="__tabbed_33_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_33_2" name="__tabbed_33" type="radio" /><label for="__tabbed_33_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
<input id="__tabbed_33_3" name="__tabbed_33" type="radio" /><label for="__tabbed_33_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">state</span><span class="o">.</span><span class="n">HCRB</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_32_2" name="__tabbed_32" type="radio" /><label for="__tabbed_32_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">opt</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">psi</span><span class="o">=</span><span class="n">psi</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">AD</span><span class="p">(</span><span class="n">kwargs</span><span class="o">...</span><span class="p">)</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">Kraus</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="34:3"><input checked="checked" id="__tabbed_34_1" name="__tabbed_34" type="radio" /><label for="__tabbed_34_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">QFIM_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_34_2" name="__tabbed_34" type="radio" /><label for="__tabbed_34_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">CFIM_obj</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_34_3" name="__tabbed_34" type="radio" /><label for="__tabbed_34_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span> <span class="o">=</span> <span class="n">HCRB_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">alg</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">dynamics</span><span class="p">;</span> <span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>where <code>K</code> and <code>dK</code> are the Kraus operators and its derivatives with respect to the 
unknown parameters.</p>
<p><strong>Example 6.3</strong><br />
The Kraus operators for the amplitude damping channel are</p>
<div class="arithmatex">\[\begin{eqnarray}
K_1 = \left(\begin{array}{cc}
1 &amp; 0  \\
0 &amp; \sqrt{1-\gamma}
\end{array}\right),
K_2 = \left(\begin{array}{cc}
0 &amp; \sqrt{\gamma} \\
0 &amp; 0
\end{array}\right), \nonumber
\end{eqnarray}\]</div>
<p>where <span class="arithmatex">\(\gamma\)</span> is the unknown parameter to be estimated which represents the decay probability.</p>
<div class="tabbed-set" data-tabs="35:2"><input checked="checked" id="__tabbed_35_1" name="__tabbed_35" type="radio" /><label for="__tabbed_35_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">quanestimation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># Kraus operators for the amplitude damping channel</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">K1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]])</span>
<span class="n">K2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">)],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="n">K1</span><span class="p">,</span> <span class="n">K2</span><span class="p">]</span>
<span class="c1"># derivatives of Kraus operators on gamma</span>
<span class="n">dK1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]])</span>
<span class="n">dK2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">)],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">dK</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dK1</span><span class="p">],</span> <span class="p">[</span><span class="n">dK2</span><span class="p">]]</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="36:6"><input checked="checked" id="__tabbed_36_1" name="__tabbed_36" type="radio" /><label for="__tabbed_36_1">AD</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: AD</span>
<span class="n">AD_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
            <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;AD&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">AD_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="37:2"><input checked="checked" id="__tabbed_37_1" name="__tabbed_37" type="radio" /><label for="__tabbed_37_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_37_2" name="__tabbed_37" type="radio" /><label for="__tabbed_37_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: CFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_36_2" name="__tabbed_36" type="radio" /><label for="__tabbed_36_2">RI</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: RI</span>
<span class="n">RI_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;RI&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">RI_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="38:1"><input checked="checked" id="__tabbed_38_1" name="__tabbed_38" type="radio" /><label for="__tabbed_38_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_36_3" name="__tabbed_36" type="radio" /><label for="__tabbed_36_3">PSO</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="39:2"><input checked="checked" id="__tabbed_39_1" name="__tabbed_39" type="radio" /><label for="__tabbed_39_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_39_2" name="__tabbed_39" type="radio" /><label for="__tabbed_39_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: CFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_36_4" name="__tabbed_36" type="radio" /><label for="__tabbed_36_4">DE</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="40:2"><input checked="checked" id="__tabbed_40_1" name="__tabbed_40" type="radio" /><label for="__tabbed_40_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_40_2" name="__tabbed_40" type="radio" /><label for="__tabbed_40_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: CFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_36_5" name="__tabbed_36" type="radio" /><label for="__tabbed_36_5">NM</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: NM</span>
<span class="n">NM_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;psi0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> \
            <span class="s2">&quot;ar&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;ae&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;ac&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;as0&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;NM&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">NM_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="41:2"><input checked="checked" id="__tabbed_41_1" name="__tabbed_41" type="radio" /><label for="__tabbed_41_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_41_2" name="__tabbed_41" type="radio" /><label for="__tabbed_41_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: CFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_36_6" name="__tabbed_36" type="radio" /><label for="__tabbed_36_6">DDPG</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c1"># state optimization algorithm: DDPG</span>
<span class="n">DDPG_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer_num&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">:</span><span class="mi">250</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> \
              <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">StateOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DDPG&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DDPG_paras</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">state</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="42:2"><input checked="checked" id="__tabbed_42_1" name="__tabbed_42" type="radio" /><label for="__tabbed_42_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_42_2" name="__tabbed_42" type="radio" /><label for="__tabbed_42_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: CFI</span>
<span class="n">state</span><span class="o">.</span><span class="n">CFIM</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
<input id="__tabbed_35_2" name="__tabbed_35" type="radio" /><label for="__tabbed_35_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">using</span> <span class="n">QuanEstimation</span>

<span class="c"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c"># Kraus operators for the amplitude damping channel</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">K1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span> <span class="mf">0.</span><span class="p">;</span> <span class="mf">0.</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]</span>
<span class="n">K2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="n">K1</span><span class="p">,</span> <span class="n">K2</span><span class="p">]</span>
<span class="c"># derivatives of Kraus operators on gamma</span>
<span class="n">dK1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span> <span class="mf">0.</span><span class="p">;</span> <span class="mf">0.</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)]</span>
<span class="n">dK2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span> <span class="mf">0.5</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">);</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
<span class="n">dK</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dK1</span><span class="p">],</span> <span class="p">[</span><span class="n">dK2</span><span class="p">]]</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Sopt</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="43:6"><input checked="checked" id="__tabbed_43_1" name="__tabbed_43" type="radio" /><label for="__tabbed_43_1">AD</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: AD</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">AD</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> 
                        <span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span> <span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="44:2"><input checked="checked" id="__tabbed_44_1" name="__tabbed_44" type="radio" /><label for="__tabbed_44_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_44_2" name="__tabbed_44" type="radio" /><label for="__tabbed_44_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_43_2" name="__tabbed_43" type="radio" /><label for="__tabbed_43_2">RI</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: RI</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">RI</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="45:1"><input checked="checked" id="__tabbed_45_1" name="__tabbed_45" type="radio" /><label for="__tabbed_45_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_43_3" name="__tabbed_43" type="radio" /><label for="__tabbed_43_3">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: PSO</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                         <span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="46:2"><input checked="checked" id="__tabbed_46_1" name="__tabbed_46" type="radio" /><label for="__tabbed_46_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_46_2" name="__tabbed_46" type="radio" /><label for="__tabbed_46_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_43_4" name="__tabbed_43" type="radio" /><label for="__tabbed_43_4">DE</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: DE</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
        === "QFIM"
    <div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div></p>
<div class="tabbed-set" data-tabs="47:1"><input checked="checked" id="__tabbed_47_1" name="__tabbed_47" type="radio" /><label for="__tabbed_47_1">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_43_5" name="__tabbed_43" type="radio" /><label for="__tabbed_43_5">NM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: NM</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">NM</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                        <span class="n">ae</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">ac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">as0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="48:2"><input checked="checked" id="__tabbed_48_1" name="__tabbed_48" type="radio" /><label for="__tabbed_48_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_48_2" name="__tabbed_48" type="radio" /><label for="__tabbed_48_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_43_6" name="__tabbed_43" type="radio" /><label for="__tabbed_43_6">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># state optimization algorithm: DDPG</span>
<span class="n">alg</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DDPG</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">layer_num</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">layer_dim</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="49:2"><input checked="checked" id="__tabbed_49_1" name="__tabbed_49" type="radio" /><label for="__tabbed_49_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_49_2" name="__tabbed_49" type="radio" /><label for="__tabbed_49_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Kraus</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">)</span>
<span class="c"># run the state optimization problem</span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">alg</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">dynamics</span><span class="p">;</span> <span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<hr />
<h2 id="bibliography"><strong>Bibliography</strong><a class="headerlink" href="#bibliography" title="Permanent link">&para;</a></h2>
<p><a id="Baydin2018">[1]</a>
A. G. Baydin, B. A. Pearlmutter, A. A. Radul, and J. M. Siskind,
Automatic differentiation in machine learning: a survey,
<a href="http://jmlr.org/papers/v18/17-468.html">J. Mach. Learn. Res. <strong>18</strong>, 1-43 (2018).</a></p>
<p><a id="Rafal2011">[2]</a>
R. Demkowicz-Dobrzański,
Optimal phase estimation with arbitrary a priori knowledge,
<a href="https://doi.org/10.1103/PhysRevA.83.061802">Phys. Rev. A <strong>83</strong>, 061802(R) (2011).
</a></p>
<p><a id="Kennedy1995">[3]</a>
J. Kennedy and R. Eberhar,
Particle swarm optimization,
<a href="https://doi.org/10.1109/ICNN.1995.488968">Proc. 1995 IEEE International Conference on Neural Networks <strong>4</strong>, 1942-1948 (1995).
</a></p>
<p><a id="Storn1997">[4]</a>
R. Storn and K. Price,
Differential Evolution-A Simple and Efficient Heuristic for global
Optimization over Continuous Spaces,
<a href="https://doi.org/10.1023/A:1008202821328">J. Global Optim. <strong>11</strong>, 341 (1997).</a></p>
<p><a id="Nelder1965">[5]</a>
J. A. Nelder and R. Mead,
A Simplex Method for Function Minimization,
<a href="https://doi.org/10.1093/comjnl/7.4.308">Comput. J. <strong>7</strong>, 308–313 (1965).</a></p>
<p><a id="Lillicrap2015">[6]</a>
T. P. Lillicrap, J. J. Hunt, A. Pritzel, N. Heess, T. Erez, Y. Tassa, D. Silver, 
and D. Wierstra,
Continuous control with deep reinforcement learning,
<a href="https://arxiv.org/abs/1509.02971">arXiv:1509.02971.</a></p>
<p><a id="Johansson2012">[7]</a>
J. R. Johansson, P. D. Nation, and F. Nori,
QuTiP: An open-source Python framework for the dynamics of open quantum systems,
<a href="https://doi.org/10.1016/j.cpc.2012.02.021">Comp. Phys. Comm. <strong>183</strong>, 1760 (2012).</a></p>
<p><a id="Johansson2013">[8]</a>
J. R. Johansson, P. D. Nation, and F. Nori,
QuTiP 2: A Python framework for the dynamics of open quantum systems,
<a href="https://doi.org/10.1016/j.cpc.2012.11.019">Comp. Phys. Comm. <strong>184</strong>, 1234 (2013).</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../guide_Copt/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Control optimization" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Control optimization
            </div>
          </div>
        </a>
      
      
        
        <a href="../guide_Mopt/" class="md-footer__link md-footer__link--next" aria-label="Next: Measurement optimization" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Measurement optimization
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../assets/javascripts/workers/search.709b4209.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.29db7785.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/mathjaxhelper.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>