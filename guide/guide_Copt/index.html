
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docs of QuanEstimation">
      
      
        <meta name="author" content="QuanEstimation">
      
      
        <link rel="canonical" href="https://quanestimation.github.io/QuanEstimation/guide/guide_Copt/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.16">
    
    
      
        <title>Control optimization - QuanEstimation Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1c3799f8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/style.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/julia_api.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#control-optimization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="QuanEstimation Docs" class="md-header__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuanEstimation Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Control optimization
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../installation/" class="md-tabs__link">
      Installation
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../guide_import/" class="md-tabs__link md-tabs__link--active">
        Users Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../API/python/classes/" class="md-tabs__link">
        API documentation
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../examples/" class="md-tabs__link">
      Examples
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../citing/" class="md-tabs__link">
      Citing
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../developers/" class="md-tabs__link">
      Developers
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="QuanEstimation Docs" class="md-nav__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6Z"/></svg>

    </a>
    QuanEstimation Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Users Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Users Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Users Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_import/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_dynamics/" class="md-nav__link">
        Parameterization process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_bounds/" class="md-nav__link">
        Quantum metrological tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_resources/" class="md-nav__link">
        Metrological resources
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Control optimization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Control optimization
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#grape-and-auto-grape" class="md-nav__link">
    GRAPE and auto-GRAPE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pso" class="md-nav__link">
    PSO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de" class="md-nav__link">
    DE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpg" class="md-nav__link">
    DDPG
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimum-parameterization-time-optimization" class="md-nav__link">
    Minimum parameterization time optimization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    Bibliography
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Sopt/" class="md-nav__link">
        State optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Mopt/" class="md-nav__link">
        Measurement optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_Compopt/" class="md-nav__link">
        Comprehensive optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../guide_adaptive/" class="md-nav__link">
        Adaptive measurement schemes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          API documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/classes/" class="md-nav__link">
        Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../API/python/functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../API/julia/api/" class="md-nav__link">
        Julia
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../citing/" class="md-nav__link">
        Citing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../developers/" class="md-nav__link">
        Developers
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#grape-and-auto-grape" class="md-nav__link">
    GRAPE and auto-GRAPE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pso" class="md-nav__link">
    PSO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de" class="md-nav__link">
    DE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpg" class="md-nav__link">
    DDPG
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minimum-parameterization-time-optimization" class="md-nav__link">
    Minimum parameterization time optimization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bibliography" class="md-nav__link">
    Bibliography
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/QuanEstimation/QuanEstimation/edit/master/docs/guide/guide_Copt.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="control-optimization"><strong>Control optimization</strong><a class="headerlink" href="#control-optimization" title="Permanent link">&para;</a></h1>
<p>The Hamiltonian of a controlled system can be written as
\begin{align}
H = H_0(\textbf{x})+\sum_{k=1}^K u_k(t) H_k,
\end{align}</p>
<p>where <span class="arithmatex">\(H_0(\textbf{x})\)</span> is the free evolution Hamiltonian with unknown parameters <span class="arithmatex">\(\textbf{x}\)</span> 
and <span class="arithmatex">\(H_k\)</span> represents the <span class="arithmatex">\(k\)</span>th control Hamiltonian with <span class="arithmatex">\(u_k\)</span> the corresponding control 
coefficients. In QuanEstimation, different algorithms are invoked to update the control 
coefficients. The control optimization algorithms are the gradient ascent pulse engineering 
(GRAPE) <a href="#Khaneja2005">[1,2,3]</a>, GRAPE algorithm based on the automatic differentiation 
(auto-GRAPE) <a href="#Baydin2018">[4]</a>, particle swarm optimization (PSO) <a href="#Kennedy1995">[5]</a>, 
differential evolution (DE) <a href="#Storn1997">[6]</a> and deep deterministic policy gradients 
(DDPG) <a href="#Lillicrap2015">[7]</a>. The codes for control optimization are</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;auto-GRAPE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">control</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">Hc</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="p">[],</span> <span class="n">ctrl_bound</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">control</span><span class="o">.</span><span class="n">QFIM</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">control</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
<input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><label for="__tabbed_2_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">control</span><span class="o">.</span><span class="n">HCRB</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
</div>
<p>In QuanEstimation, the optimization codes are executed in Julia and the data will be saved in
the <code>.csv</code> file. The variable <code>savefile</code> indicates whether to save all the control 
coefficients and its default value is <code>False</code> which means the control coefficients for the 
final episode and the values of the objective function in all episodes will be saved in 
"controls.csv" and "f.csv", respectively. If set <code>True</code> then the control coefficients and the 
values of the objective function in all episodes will be saved during the training. The package
contains five control optimization algorithms which can be set via <code>method</code>, <code>**kwargs</code> is 
the corresponding keyword and default value.</p>
<p>After calling <code>control = ControlOpt()</code>, the dynamics parameters shoule be input. Here <code>tspan</code> 
is the time length for the evolution and <code>rho0</code> represents the density matrix of the initial 
state. <code>H0</code> and <code>dH</code> are the free Hamiltonian and its derivatives with respect to the unknown 
parameters to be estimated. <code>H0</code> is a matrix when the free Hamiltonian is time-independent and 
a list with the length equal to <code>tspan</code> when it is time-dependent. <code>dH</code> should be input as 
<span class="arithmatex">\([\partial_a{H_0}, \partial_b{H_0}, \cdots]\)</span>. <code>Hc</code> is a list representing the control 
Hamiltonians. <code>decay</code> contains decay operators <span class="arithmatex">\((\Gamma_1, \Gamma_2, \cdots)\)</span> and the 
corresponding decay rates <span class="arithmatex">\((\gamma_1, \gamma_2, \cdots)\)</span>, its input rule is
decay=[[<span class="arithmatex">\(\Gamma_1\)</span>, <span class="arithmatex">\(\gamma_1\)</span>], [<span class="arithmatex">\(\Gamma_2\)</span>, <span class="arithmatex">\(\gamma_2\)</span>],...]. The default value for 
<code>decay</code> is empty which means the dynamics is unitary. The package can be used to optimize 
bounded control problems by setting lower and upper bounds of the control coefficients via 
<code>ctrl_bound</code>, which is an array with two elements representing the lower and upper bound of 
each control coefficient, respectively. The default value of <code>ctrl_bound=[]</code> which means the 
control coefficients are in the regime <span class="arithmatex">\([-\infty,\infty]\)</span>.</p>
<p>The objective functions for control optimization can be set as QFI <span class="arithmatex">\(\left[\mathrm{Tr}(W
\mathcal{F}^{-1})\right]\)</span>, CFI <span class="arithmatex">\(\left[\mathrm{Tr}(W\mathcal{I}^{-1})\right]\)</span> and HCRB, the 
corresponding codes for them are <code>control.QFIM()</code> (default), <code>control.CFIM()</code> and <code>control.HCRB()</code>. 
Here <span class="arithmatex">\(\mathcal{F}\)</span> and <span class="arithmatex">\(\mathcal{I}\)</span> are the QFIM and CFIM, <span class="arithmatex">\(W\)</span> corresponds to <code>W</code> is the weight 
matrix which defaults to the identity matrix. If the users call <code>control.HCRB()</code> for single 
parameter scenario, the program will exit and print <code>"Program terminated. In the single-parameter 
scenario, the HCRB is equivalent to the QFI. Please choose 'QFIM' as the objective function"</code>. 
<code>LDtype</code> in <code>control.QFIM()</code> represents the types of the QFIM, it can be set as <code>LDtype="SLD"</code> 
(default), <code>LDtype="RLD"</code>, and <code>LDtype="LLD"</code>. <code>M</code> in <code>control.CFIM()</code> represents a set of 
positive operator-valued measure (POVM) with default value <code>[]</code> which means a set of rank-one 
symmetric informationally complete POVM (SIC-POVM) is used in the calculation.</p>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ControlOpt</span><span class="p">(</span><span class="n">ctrl</span><span class="o">=</span><span class="n">ctrl</span><span class="p">,</span><span class="w"> </span><span class="n">ctrl_bound</span><span class="o">=</span><span class="n">ctrl_bound</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">autoGRAPE</span><span class="p">(</span><span class="n">kwargs</span><span class="o">...</span><span class="p">)</span><span class="w"></span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span><span class="n">Hc</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">decay</span><span class="o">=</span><span class="n">mising</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>
<div class="tabbed-set" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QFIM_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">LDtype</span><span class="o">=</span><span class="ss">:SLD</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CFIM_obj</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><label for="__tabbed_3_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HCRB_obj</span><span class="p">(</span><span class="n">W</span><span class="o">=</span><span class="nb">missing</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<p><div class="highlight"><pre><span></span><code><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
In control optimization, a set of control coefficients (optimization variable) and its boundary 
value can be input via <code>ctrl=ctrl</code> and <code>ctrl_bound=ctrl_bound</code> in <code>ControlOpt()</code>.
<code>ctrl</code> is a list of arrays with the length equal to control Hamiltonians, 
<code>ctrl_bound</code> is an array with two elements representing the lower and upper bound of the 
control coefficients, respectively. The default value of <code>ctrl_bound=missing</code> which means 
the control coefficients are in the regime <span class="arithmatex">\([-\infty,\infty]\)</span>. <code>seed</code> is the random seed 
which can ensure the reproducibility of results.</p>
<p>The package can deal with the parameterization process in the form of master equation, the 
dynamics parameters shoule be input via <code>Lindblad()</code>. Here <code>tspan</code> is the time length for 
the evolution and <code>rho0</code> represents the density matrix of the initial state. <code>H0</code> and <code>dH</code> 
are the free Hamiltonian and its derivatives with respect to the unknown parameters to be 
estimated. <code>H0</code> is a matrix when the free Hamiltonian is time-independent and a list with the 
length equal to <code>tspan</code> when it is time-dependent. <code>dH</code> should be input as <span class="arithmatex">\([\partial_a{H_0}, 
\partial_b{H_0}, \cdots]\)</span>. <code>Hc</code> is a list representing the control Hamiltonians. <code>decay</code> 
contains decay operators <span class="arithmatex">\((\Gamma_1, \Gamma_2, \cdots)\)</span> and the corresponding decay rates 
<span class="arithmatex">\((\gamma_1, \gamma_2, \cdots)\)</span> with the input rule decay=[[<span class="arithmatex">\(\Gamma_1\)</span>, <span class="arithmatex">\(\gamma_1\)</span>], 
[<span class="arithmatex">\(\Gamma_2\)</span>, <span class="arithmatex">\(\gamma_2\)</span>],...]. The default value <code>decay</code> is <code>missing</code> which means the 
dynamics is unitary.</p>
<p>The objective functions for control optimization can be set as QFI <span class="arithmatex">\(\left[\mathrm{Tr}(W
\mathcal{F}^{-1})\right]\)</span>, CFI <span class="arithmatex">\(\left[\mathrm{Tr}(W\mathcal{I}^{-1})\right]\)</span> and HCRB, the 
corresponding codes for them are <code>QFIM_obj()</code> (default), <code>CFIM_obj()</code> and <code>HCRB_obj()</code>. Here 
<span class="arithmatex">\(\mathcal{F}\)</span> and <span class="arithmatex">\(\mathcal{I}\)</span> are the QFIM and CFIM, <span class="arithmatex">\(W\)</span> corresponds to <code>W</code> is the weight 
matrix which defaults to the identity matrix. If the users call <code>HCRB_obj()</code> for single parameter 
scenario, the program will exit and print <code>"Program terminated. In the single-parameter scenario, 
the HCRB is equivalent to the QFI. Please choose 'QFIM_obj' as the objective function"</code>. 
<code>LDtype</code> in <code>QFIM_obj()</code> represents the types of the QFIM, it can be set as <code>LDtype=:SLD</code> 
(default), <code>LDtype=:RLD</code>, and <code>LDtype=:LLD</code>. <code>M</code> in <code>CFIM_obj()</code> represents a set of positive 
operator-valued measure (POVM) with default value <code>missing</code> which means a set of rank-one 
symmetric informationally complete POVM (SIC-POVM) is used in the calculation.</p>
<p>The variable <code>savefile</code> indicates whether to save all the control coefficients and its default 
value is <code>false</code> which means the control coefficients for the final episode and the values of 
the objective function in all episodes will be saved in "controls.csv" and "f.csv", respectively.
If set <code>true</code> then the control coefficients and the values of the objective function in all 
episodes will be saved during the training. The algorithm used for optimizing the control
coefficients in QuanEstimation are GRAPE, auto-GRAPE, PSO, DE and DDPG. <code>kwargs...</code> contains 
the keywords and defaults value corresponding to the optimization algorithm which will be 
introduced in detail below.</p>
</div>
</div>
<hr />
<h2 id="grape-and-auto-grape"><strong>GRAPE and auto-GRAPE</strong><a class="headerlink" href="#grape-and-auto-grape" title="Permanent link">&para;</a></h2>
<p>The codes for control optimization with GRAPE and auto-GRAPE are as follows</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;GRAPE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;auto-GRAPE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> \
          <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of GRAPE and auto-GRAPE can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"Adam"</td>
<td align="center">True</td>
</tr>
<tr>
<td align="center">"ctrl0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">300</td>
</tr>
<tr>
<td align="center">"epsilon"</td>
<td align="center">0.01</td>
</tr>
<tr>
<td align="center">"beta1"</td>
<td align="center">0.90</td>
</tr>
<tr>
<td align="center">"beta2"</td>
<td align="center">0.99</td>
</tr>
</tbody>
</table>
<p>Adam algorithm can be introduced to update the control coefficients when using GRAPE and 
auto-GRAPE for control optimization, which can be realized by setting <code>Adam=True</code>. In this 
case, the Adam parameters include learning rate, the exponential decay rate for the first 
moment estimates and the second moment estimates can be set by the users via <code>epsilon</code>, <code>beta1</code>
and <code>beta2</code>, respectively. If <code>Adam=False</code>, the control coefficients will update according to 
the learning rate <code>"epsilon"</code>. <code>ctrl0</code> is a list representing the initial guesses of control 
coefficients and <code>max_episode</code> is the number of episodes.</p>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GRAPE</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">autoGRAPE</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span>
<span class="w">                </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
The keywords and the default values of GRAPE and auto-GRAPE can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"Adam"</td>
<td align="center">true</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">300</td>
</tr>
<tr>
<td align="center">"epsilon"</td>
<td align="center">0.01</td>
</tr>
<tr>
<td align="center">"beta1"</td>
<td align="center">0.90</td>
</tr>
<tr>
<td align="center">"beta2"</td>
<td align="center">0.99</td>
</tr>
</tbody>
</table>
<p>Adam algorithm can be introduced to update the control coefficients when using GRAPE and 
auto-GRAPE for control optimization, which can be realized by setting <code>Adam=true</code>. In this 
case, the Adam parameters include learning rate, the exponential decay rate for the first 
moment estimates and the second moment estimates can be set by the users via <code>epsilon</code>, <code>beta1</code>
and <code>beta2</code>, respectively. If <code>Adam=false</code>, the control coefficients will update according to 
the learning rate <code>"epsilon"</code>.</p>
</div>
</div>
<h2 id="pso"><strong>PSO</strong><a class="headerlink" href="#pso" title="Permanent link">&para;</a></h2>
<p>The code for control optimization with PSO is as follows</p>
<div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
          <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of PSO can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"ctrl0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">[1000,100]</td>
</tr>
<tr>
<td align="center">"c0"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"c1"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"c2"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p>Here <code>p_num</code> is the number of particles. <code>c0</code>, <code>c1</code> and <code>c2</code> are the PSO parameters 
representing the inertia weight, cognitive learning factor and social learning factor, 
respectively. <code>max_episode</code> accepts both integer and array with two elements. If it is an 
integer, for example <code>max_episode=1000</code>, it means the program will continuously run 1000 
episodes. However, if it is an array, for example <code>max_episode=[1000,100]</code>, the program will 
run 1000 episodes in total but replace control coefficients of all the particles with global 
best every 100 episodes. <code>seed</code> is the random seed which can ensure the reproducibility of 
the results.</p>
</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span>
<span class="w">          </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<p>The keywords and the default values of PSO can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"ini_particle"</td>
<td align="center">missing</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">[1000,100]</td>
</tr>
<tr>
<td align="center">"c0"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"c1"</td>
<td align="center">2.0</td>
</tr>
<tr>
<td align="center">"c2"</td>
<td align="center">2.0</td>
</tr>
</tbody>
</table>
<p>Here <code>p_num</code> is the number of particles. <code>c0</code>, <code>c1</code> and <code>c2</code> are the PSO parameters 
representing the inertia weight, cognitive learning factor and social learning factor, 
respectively. <code>max_episode</code> accepts both integer and array with two elements. If it is an 
integer, for example <code>max_episode=1000</code>, it means the program will continuously run 1000 
episodes. However, if it is an array, for example <code>max_episode=[1000,100]</code>, the program will 
run 1000 episodes in total but replace control coefficients of all the particles with global 
best every 100 episodes. <code>ini_particle</code> is a tuple representing the initial guesses of control 
coefficients.</p>
</div>
</div>
<h2 id="de"><strong>DE</strong><a class="headerlink" href="#de" title="Permanent link">&para;</a></h2>
<p>The code for control optimization with DE is as follows</p>
<div class="tabbed-set" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:[],</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
          <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of DE can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"ctrl0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"c"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"cr"</td>
<td align="center">0.5</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>p_num</code> and <code>max_episode</code> represent the number of populations and episodes. <code>c</code> and <code>cr</code> 
are the mutation constant and the crossover constant.</p>
</div>
<input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><label for="__tabbed_6_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span>
<span class="w">         </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
The keywords and the default values of DE can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"p_num"</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">"ini_population"</td>
<td align="center">missing</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"c"</td>
<td align="center">1.0</td>
</tr>
<tr>
<td align="center">"cr"</td>
<td align="center">0.5</td>
</tr>
</tbody>
</table>
<p><code>ini_population</code> is a tuple representing the initial guesses of control and <code>max_episode</code> 
represents the number of populations and episodes. <code>c</code> and <code>cr</code> are the mutation constant 
and the crossover constant.</p>
</div>
</div>
<h2 id="ddpg"><strong>DDPG</strong><a class="headerlink" href="#ddpg" title="Permanent link">&para;</a></h2>
<p>The code for control optimization with DDPG is as follows</p>
<div class="tabbed-set" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">Python</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;DDPG&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
where <code>kwargs</code> is of the form
<div class="highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;layer_num&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
</code></pre></div>
The keywords and the default values of DDPG can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>**kwargs<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"ctrl0"</td>
<td align="center">[ ]</td>
</tr>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"layer_num"</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">"layer_dim"</td>
<td align="center">200</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>layer_num</code> and <code>layer_dim</code> represent the number of layers (include the input and output layer) 
and the number of neurons in the hidden layer.</p>
</div>
<input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><label for="__tabbed_7_2">Julia</label><div class="tabbed-content">
<p><div class="highlight"><pre><span></span><code><span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DDPG</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">layer_num</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">layer_dim</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
The keywords and the default values of DE can be seen in the following table</p>
<table>
<thead>
<tr>
<th align="center"><span class="arithmatex">\(~~~~~~~~~~\)</span>keywords<span class="arithmatex">\(~~~~~~~~~~\)</span></th>
<th align="center"><span class="arithmatex">\(~~~~\)</span>default values<span class="arithmatex">\(~~~~\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">"max_episode"</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">"layer_num"</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">"layer_dim"</td>
<td align="center">200</td>
</tr>
<tr>
<td align="center">"seed"</td>
<td align="center">1234</td>
</tr>
</tbody>
</table>
<p><code>layer_num</code> and <code>layer_dim</code> represent the number of layers (include the input and output layer) 
and the number of neurons in the hidden layer.</p>
</div>
</div>
<p><strong>Example 5.1</strong><br />
<a id="example5_1"></a>
In this example, the free evolution Hamiltonian of a single qubit system is <span class="arithmatex">\(H_0=\frac{1}{2}\omega 
\sigma_3\)</span> with <span class="arithmatex">\(\omega\)</span> the frequency and <span class="arithmatex">\(\sigma_3\)</span> a Pauli matrix. The dynamics of the system 
is governed by
\begin{align}
\partial_t\rho=-i[H_0, \rho]+ \gamma_{+}\left(\sigma_{+}\rho\sigma_{-}-\frac{1}{2}{\sigma_{-}
\sigma_{+},\rho}\right)+ \gamma_{-}\left(\sigma_{-}\rho\sigma_{+}-\frac{1}{2}{\sigma_{+}\sigma_{-},
\rho}\right),
\end{align}</p>
<p>where <span class="arithmatex">\(\gamma_{+}\)</span>, <span class="arithmatex">\(\gamma_{-}\)</span> are decay rates and <span class="arithmatex">\(\sigma_{\pm}=(\sigma_1 \pm \sigma_2)/2\)</span>. 
The control Hamiltonian 
\begin{align}
H_\mathrm{c}=u_1(t)\sigma_1+u_2(t)\sigma_2+u_3(t)\sigma_3.
\end{align}</p>
<p>Here <span class="arithmatex">\(\sigma_{1}\)</span>, <span class="arithmatex">\(\sigma_{2}\)</span> are also Pauli matrices. The probe state is taken as <span class="arithmatex">\(|+\rangle\)</span> and 
the measurement for CFI is <span class="arithmatex">\(\{|+\rangle\langle+|, |-\rangle\langle-|\}\)</span> with
<span class="arithmatex">\(|\pm\rangle:=\frac{1}{\sqrt{2}}(|0\rangle\pm|1\rangle)\)</span>. <span class="arithmatex">\(|0\rangle\)</span> <span class="arithmatex">\((|1\rangle)\)</span> is the eigenstate 
of <span class="arithmatex">\(\sigma_3\)</span> with respect to the eigenvalue <span class="arithmatex">\(1\)</span> <span class="arithmatex">\((-1)\)</span>.</p>
<div class="tabbed-set" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><label for="__tabbed_8_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">quanestimation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">H0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span>
<span class="c1"># derivative of the free Hamiltonian on omega</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span>
<span class="c1"># control Hamiltonians </span>
<span class="n">Hc</span> <span class="o">=</span> <span class="p">[</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>  
<span class="n">sm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">sp</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="n">sm</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="c1"># measurement</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">]</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>
<span class="c1"># guessed control coefficients</span>
<span class="n">cnum</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">ctrl0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">cnum</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">cnum</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">cnum</span><span class="p">)])]</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="9:5"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><label for="__tabbed_9_1">auto-GRAPE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: auto-GRAPE</span>
<span class="n">GRAPE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:</span><span class="n">ctrl0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
               <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;auto-GRAPE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">GRAPE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><label for="__tabbed_9_2">GRAPE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: GRAPE</span>
<span class="n">GRAPE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:</span><span class="n">ctrl0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
               <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;GRAPE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">GRAPE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_9_3" name="__tabbed_9" type="radio" /><label for="__tabbed_9_3">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:</span><span class="n">ctrl0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_9_4" name="__tabbed_9" type="radio" /><label for="__tabbed_9_4">DE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:</span><span class="n">ctrl0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_9_5" name="__tabbed_9" type="radio" /><label for="__tabbed_9_5">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: DDPG</span>
<span class="n">DDPG_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer_num&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">:</span><span class="mi">220</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> \
              <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DDPG&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DDPG_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">control</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">Hc</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> \
                 <span class="n">ctrl_bound</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><label for="__tabbed_10_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: QFI</span>
<span class="n">control</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><label for="__tabbed_10_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: CFI</span>
<span class="n">control</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><label for="__tabbed_8_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span><span class="w"></span>

<span class="c"># initial state</span><span class="w"></span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="c"># free Hamiltonian</span><span class="w"></span>
<span class="n">omega</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="w"></span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span><span class="w"></span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="w"></span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span><span class="w"></span>
<span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">sz</span><span class="w"></span>
<span class="c"># derivative of the free Hamiltonian on omega</span><span class="w"></span>
<span class="n">dH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span><span class="w"></span>
<span class="c"># control Hamiltonians </span><span class="w"></span>
<span class="n">Hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">]</span><span class="w"></span>
<span class="c"># dissipation</span><span class="w"></span>
<span class="n">sp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span><span class="w"></span>
<span class="n">sm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.0</span><span class="nb">im</span><span class="p">]</span><span class="w"></span>
<span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">sm</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">]]</span><span class="w"></span>
<span class="c"># measurement</span><span class="w"></span>
<span class="n">M1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w">  </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span><span class="w"></span>
<span class="n">M2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="o">+</span><span class="mf">0.0</span><span class="nb">im</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w">  </span><span class="mf">1.</span><span class="p">]</span><span class="w"></span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="n">M2</span><span class="p">]</span><span class="w"></span>
<span class="c"># time length for the evolution</span><span class="w"></span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">10.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">2500</span><span class="p">)</span><span class="w"></span>
<span class="c"># guessed control coefficients</span><span class="w"></span>
<span class="n">cnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="n">ctrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">zeros</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">Hc</span><span class="p">)]</span><span class="w"></span>
<span class="n">ctrl_bound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="p">]</span><span class="w"></span>
<span class="c"># set the optimization type</span><span class="w"></span>
<span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">ControlOpt</span><span class="p">(</span><span class="n">ctrl</span><span class="o">=</span><span class="n">ctrl</span><span class="p">,</span><span class="w"> </span><span class="n">ctrl_bound</span><span class="o">=</span><span class="n">ctrl_bound</span><span class="p">,</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<div class="tabbed-set" data-tabs="11:5"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><label for="__tabbed_11_1">auto-GRAPE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: auto-GRAPE</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">autoGRAPE</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                               </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><label for="__tabbed_11_2">GRAPE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: GRAPE</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">GRAPE</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                           </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_11_3" name="__tabbed_11" type="radio" /><label for="__tabbed_11_3">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: PSO</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="p">([</span><span class="n">ctrl</span><span class="p">],),</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_11_4" name="__tabbed_11" type="radio" /><label for="__tabbed_11_4">DE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: DE</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="p">([</span><span class="n">ctrl</span><span class="p">],),</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_11_5" name="__tabbed_11" type="radio" /><label for="__tabbed_11_5">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: DDPG</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DDPG</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">layer_num</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">layer_dim</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span><span class="w"></span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span><span class="n">Hc</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="p">)</span><span class="w">  </span>
</code></pre></div>
<div class="tabbed-set" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><label for="__tabbed_12_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: QFI</span><span class="w"></span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><label for="__tabbed_12_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: CFI</span><span class="w"></span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># run the control optimization problem</span><span class="w"></span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<p><strong>Example 5.2</strong><br />
<a id="example5_2"></a>
In the multiparameter scenario, the dynamics of electron and nuclear coupling in NV<span class="arithmatex">\(^{-}\)</span> can 
be expressed as
\begin{align}
\partial_t\rho=-i[H_0,\rho]+\frac{\gamma}{2}(S_3\rho S_3-S^2_3\rho-\rho S^2_3)
\end{align}</p>
<p>with <span class="arithmatex">\(\gamma\)</span> the dephasing rate. And
\begin{align}
H_0/\hbar=DS^2_3+g_{\mathrm{S}}\vec{B}\cdot\vec{S}+g_{\mathrm{I}}\vec{B}\cdot\vec{I}+\vec{S}^
{\,\mathrm{T}}\mathcal{A}\vec{I}
\end{align}</p>
<p>is the free evolution Hamiltonian, where <span class="arithmatex">\(\vec{S}=(S_1,S_2,S_3)^{\mathrm{T}}\)</span> and 
<span class="arithmatex">\(\vec{I}=(I_1,I_2,I_3)^{\mathrm{T}}\)</span> with <span class="arithmatex">\(S_i=s_i\otimes I\)</span> and <span class="arithmatex">\(I_i=I\otimes \sigma_i\)</span> 
<span class="arithmatex">\((i=1,2,3)\)</span> the electron and nuclear operators. <span class="arithmatex">\(s_1, s_2, s_3\)</span> are spin-1 operators with </p>
<div class="arithmatex">\[\begin{eqnarray}
s_1 = \frac{1}{\sqrt{2}}\left(\begin{array}{ccc}
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 0
\end{array}\right),
s_2 = \frac{1}{\sqrt{2}}\left(\begin{array}{ccc}
0 &amp; -i &amp; 0\\
i &amp; 0 &amp; -i\\
0 &amp; i &amp; 0
\end{array}\right)\!\!, \nonumber
\end{eqnarray}\]</div>
<p>and <span class="arithmatex">\(s_3=\mathrm{diag}(1,0,-1)\)</span> and <span class="arithmatex">\(\sigma_i (i=1,2,3)\)</span> is Pauli matrix. <span class="arithmatex">\(\mathcal{A}=\mathrm{diag}
(A_1,A_1,A_2)\)</span> is the hyperfine tensor with <span class="arithmatex">\(A_1\)</span> and <span class="arithmatex">\(A_2\)</span> the axial and transverse magnetic 
hyperfine coupling coefficients. The coefficients <span class="arithmatex">\(g_{\mathrm{S}}=g_\mathrm{e}\mu_\mathrm{B}/\hbar\)</span> 
and <span class="arithmatex">\(g_{\mathrm{I}}=g_\mathrm{n}\mu_\mathrm{n}/\hbar\)</span>, where <span class="arithmatex">\(g_\mathrm{e}\)</span> (<span class="arithmatex">\(g_\mathrm{n}\)</span>) is 
the <span class="arithmatex">\(g\)</span> factor of the electron (nuclear), <span class="arithmatex">\(\mu_\mathrm{B}\)</span> (<span class="arithmatex">\(\mu_\mathrm{n}\)</span>) is the Bohr (nuclear) 
magneton and <span class="arithmatex">\(\hbar\)</span> is the Plank's constant. <span class="arithmatex">\(\vec{B}\)</span> is the magnetic field which be estimated.</p>
<p>In this case,the initial state is taken as <span class="arithmatex">\(\frac{1}{\sqrt{2}}(|1\rangle+|\!-\!1\rangle)\otimes
|\!\!\uparrow\rangle\)</span>, where <span class="arithmatex">\(\frac{1}{\sqrt{2}}(|1\rangle+|\!-\!1\rangle)\)</span> is an electron state 
with <span class="arithmatex">\(|1\rangle\)</span> (<span class="arithmatex">\(|\!-\!1\rangle\)</span>) the eigenstate of <span class="arithmatex">\(s_3\)</span> with respect to the eigenvalue <span class="arithmatex">\(1\)</span> 
(<span class="arithmatex">\(-1\)</span>). <span class="arithmatex">\(|\!\!\uparrow\rangle\)</span> is a nuclear state and the eigenstate of <span class="arithmatex">\(\sigma_3\)</span> with respect 
to the eigenvalue 1. <span class="arithmatex">\(W\)</span> is set to be identity.</p>
<p>Here three types of measurement optimization are considerd, projective measurement, linear combination of a given set of positive operator-valued measure (POVM) and optimal rotated measurement of an input measurement.</p>
<div class="tabbed-set" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><label for="__tabbed_13_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">quanestimation</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">random</span>

<span class="c1"># initial state</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="n">rho0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">rho0</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho0</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="c1"># free Hamiltonian</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
<span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span> 
<span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">ide2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
<span class="n">ide3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">I1</span><span class="p">,</span> <span class="n">I2</span><span class="p">,</span> <span class="n">I3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide3</span><span class="p">,</span> <span class="n">sx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide3</span><span class="p">,</span> <span class="n">sy</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">ide3</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">ide2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">ide2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">ide2</span><span class="p">)</span>
<span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">,</span> <span class="n">B3</span> <span class="o">=</span> <span class="mf">5.0e-4</span><span class="p">,</span> <span class="mf">5.0e-4</span><span class="p">,</span> <span class="mf">5.0e-4</span>
<span class="c1"># All numbers are divided by 100 in this example </span>
<span class="c1"># for better calculation accurancy</span>
<span class="n">cons</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.87</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">gS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">28.03</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">gI</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">4.32</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">A1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.65</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">A2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.03</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span>
<span class="n">H0</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">s3</span><span class="p">),</span> <span class="n">ide2</span><span class="p">)</span> <span class="o">+</span> <span class="n">gS</span><span class="o">*</span><span class="p">(</span><span class="n">B1</span><span class="o">*</span><span class="n">S1</span><span class="o">+</span><span class="n">B2</span><span class="o">*</span><span class="n">S2</span><span class="o">+</span><span class="n">B3</span><span class="o">*</span><span class="n">S3</span><span class="p">)</span> \
     <span class="o">+</span> <span class="n">gI</span><span class="o">*</span><span class="p">(</span><span class="n">B1</span><span class="o">*</span><span class="n">I1</span><span class="o">+</span><span class="n">B2</span><span class="o">*</span><span class="n">I2</span><span class="o">+</span><span class="n">B3</span><span class="o">*</span><span class="n">I3</span><span class="p">)</span> <span class="o">+</span> <span class="n">A1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">sx</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span> \
     <span class="o">+</span> <span class="n">A2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span>
<span class="c1"># derivatives of the free Hamiltonian on B1, B2 and B3</span>
<span class="n">dH</span> <span class="o">=</span> <span class="p">[</span><span class="n">gS</span><span class="o">*</span><span class="n">S1</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">I1</span><span class="p">,</span> <span class="n">gS</span><span class="o">*</span><span class="n">S2</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">I2</span><span class="p">,</span> <span class="n">gS</span><span class="o">*</span><span class="n">S3</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">I3</span><span class="p">]</span>
<span class="c1"># control Hamiltonians </span>
<span class="n">Hc</span> <span class="o">=</span> <span class="p">[</span><span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span><span class="p">]</span>
<span class="c1"># dissipation</span>
<span class="n">decay</span> <span class="o">=</span> <span class="p">[[</span><span class="n">S3</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">cons</span><span class="p">]]</span>
<span class="c1"># measurement</span>
<span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho0</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
<span class="c1"># time length for the evolution</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
<span class="c1"># guessed control coefficients</span>
<span class="n">cnum</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">ini_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span>
<span class="n">ini_2</span> <span class="o">=</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span>
<span class="n">ini_3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span>
<span class="n">ini_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="n">cnum</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">))])</span>
<span class="n">ini_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">cnum</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">))])</span>
<span class="n">ini_6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="n">cnum</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">))])</span>
<span class="n">ini_7</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">random</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span>
<span class="n">ini_8</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">random</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span>
<span class="n">ini_9</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span><span class="o">+</span><span class="mf">0.05</span><span class="o">*</span><span class="n">random</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span>
<span class="n">ini_10</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span><span class="o">+</span><span class="mf">0.05</span><span class="o">*</span><span class="n">random</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Hc</span><span class="p">),</span><span class="n">cnum</span><span class="p">))</span>
<span class="n">ctrl0</span> <span class="o">=</span> <span class="p">[</span><span class="n">ini_1</span><span class="p">,</span> <span class="n">ini_2</span><span class="p">,</span> <span class="n">ini_3</span><span class="p">,</span> <span class="n">ini_4</span><span class="p">,</span> <span class="n">ini_5</span><span class="p">,</span> \
         <span class="n">ini_6</span><span class="p">,</span> <span class="n">ini_7</span><span class="p">,</span> <span class="n">ini_8</span><span class="p">,</span> <span class="n">ini_9</span><span class="p">,</span> <span class="n">ini_10</span><span class="p">]</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="14:4"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><label for="__tabbed_14_1">auto-GRAPE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: auto-GRAPE</span>
<span class="n">GRAPE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Adam&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:</span><span class="n">ctrl0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> \
               <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;beta1&quot;</span><span class="p">:</span><span class="mf">0.90</span><span class="p">,</span> <span class="s2">&quot;beta2&quot;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;auto-GRAPE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">GRAPE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><label for="__tabbed_14_2">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: PSO</span>
<span class="n">PSO_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:</span><span class="n">ctrl0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> \
             <span class="s2">&quot;c0&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;PSO&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">PSO_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_14_3" name="__tabbed_14" type="radio" /><label for="__tabbed_14_3">DE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: DE</span>
<span class="n">DE_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;p_num&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ctrl0&quot;</span><span class="p">:</span><span class="n">ctrl0</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> \
            <span class="s2">&quot;cr&quot;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DE&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DE_paras</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_14_4" name="__tabbed_14" type="radio" /><label for="__tabbed_14_4">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># control algorithm: DDPG</span>
<span class="n">DDPG_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;layer_num&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">:</span><span class="mi">220</span><span class="p">,</span> <span class="s2">&quot;max_episode&quot;</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> \
              <span class="s2">&quot;seed&quot;</span><span class="p">:</span><span class="mi">1234</span><span class="p">}</span>
<span class="n">control</span> <span class="o">=</span> <span class="n">ControlOpt</span><span class="p">(</span><span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DDPG&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">DDPG_paras</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># input the dynamics data</span>
<span class="n">control</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">H0</span><span class="p">,</span> <span class="n">dH</span><span class="p">,</span> <span class="n">Hc</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="n">decay</span><span class="p">,</span> \
                 <span class="n">ctrl_bound</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</code></pre></div>
<div class="tabbed-set" data-tabs="15:3"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><label for="__tabbed_15_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WF^{-1})</span>
<span class="n">control</span><span class="o">.</span><span class="n">QFIM</span><span class="p">()</span>
</code></pre></div>
</div>
<input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><label for="__tabbed_15_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: tr(WI^{-1})</span>
<span class="n">control</span><span class="o">.</span><span class="n">CFIM</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_15_3" name="__tabbed_15" type="radio" /><label for="__tabbed_15_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1"># objective function: HCRB</span>
<span class="n">control</span><span class="o">.</span><span class="n">HCRB</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>
<input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><label for="__tabbed_13_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span><span class="w"></span>

<span class="c"># initial state</span><span class="w"></span>
<span class="n">rho0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="kt">ComplexF64</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<span class="n">rho0</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="o">:</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="mf">0.5</span><span class="w"></span>
<span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="c"># Hamiltonian</span><span class="w"></span>
<span class="n">sx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="w"></span>
<span class="n">sy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="w"></span>
<span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span><span class="w"></span>
<span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="nb">im</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="nb">im</span><span class="w"> </span><span class="mf">0.</span><span class="p">]</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">s3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="p">]</span><span class="w"></span>
<span class="n">Is</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I1</span><span class="p">,</span><span class="w"> </span><span class="n">I2</span><span class="p">,</span><span class="w"> </span><span class="n">I3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">sx</span><span class="p">),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">sy</span><span class="p">),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">sz</span><span class="p">)]</span><span class="w"></span>
<span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">,</span><span class="w"> </span><span class="n">S3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">))]</span><span class="w"></span>
<span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B1</span><span class="p">,</span><span class="w"> </span><span class="n">B2</span><span class="p">,</span><span class="w"> </span><span class="n">B3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.0e-4</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0e-4</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0e-4</span><span class="p">]</span><span class="w"></span>
<span class="c"># All numbers are divided by 100 in this example </span><span class="w"></span>
<span class="c"># for better calculation accurancy</span><span class="w"></span>
<span class="n">cons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">2.87</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span><span class="w"></span>
<span class="n">gS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">28.03</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span><span class="w"></span>
<span class="n">gI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">4.32</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span><span class="w"></span>
<span class="n">A1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">3.65</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span><span class="w"></span>
<span class="n">A2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="nb">pi</span><span class="o">*</span><span class="mf">3.03</span><span class="p">)</span><span class="o">/</span><span class="n">cons</span><span class="w"></span>
<span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">([</span><span class="n">D</span><span class="o">*</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">gS</span><span class="o">*</span><span class="n">B</span><span class="o">.*</span><span class="n">S</span><span class="p">),</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">gI</span><span class="o">*</span><span class="n">B</span><span class="o">.*</span><span class="n">Is</span><span class="p">),</span><span class="w"></span>
<span class="w">          </span><span class="n">A1</span><span class="o">*</span><span class="p">(</span><span class="n">kron</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">sx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kron</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">)),</span><span class="w"> </span><span class="n">A2</span><span class="o">*</span><span class="n">kron</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">)])</span><span class="w"></span>
<span class="c"># derivatives of the free Hamiltonian on B1, B2 and B3</span><span class="w"></span>
<span class="n">dH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gS</span><span class="o">*</span><span class="n">S</span><span class="o">+</span><span class="n">gI</span><span class="o">*</span><span class="n">Is</span><span class="w"></span>
<span class="c"># control Hamiltonians </span><span class="w"></span>
<span class="n">Hc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">S1</span><span class="p">,</span><span class="w"> </span><span class="n">S2</span><span class="p">,</span><span class="w"> </span><span class="n">S3</span><span class="p">]</span><span class="w"></span>
<span class="c"># dissipation</span><span class="w"></span>
<span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">S3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="n">cons</span><span class="p">]]</span><span class="w"></span>
<span class="c"># measurement</span><span class="w"></span>
<span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="o">&#39;</span><span class="w"> </span><span class="o">\</span><span class="w"></span>
<span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">dim</span><span class="p">]</span><span class="w"></span>
<span class="c"># time length for the evolution </span><span class="w"></span>
<span class="n">tspan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span><span class="w"></span>
<span class="c"># guessed control coefficients</span><span class="w"></span>
<span class="n">cnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="n">rng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MersenneTwister</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span><span class="w"></span>
<span class="n">cnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">Hc</span><span class="p">)</span><span class="w"></span>
<span class="n">ini_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">zeros</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.2</span><span class="o">.*</span><span class="p">[</span><span class="n">ones</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2</span><span class="o">.*</span><span class="p">[</span><span class="n">ones</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="n">cnum</span><span class="p">)</span><span class="o">...</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="n">cnum</span><span class="p">)</span><span class="o">...</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">range</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="o">=</span><span class="n">cnum</span><span class="p">)</span><span class="o">...</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="o">+</span><span class="mf">0.05</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ini_10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">cnum</span><span class="p">)</span><span class="o">+</span><span class="mf">0.05</span><span class="o">*</span><span class="n">rand</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span><span class="n">cnum</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">cnum</span><span class="p">]</span><span class="w"></span>
<span class="n">ctrl0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="kt">Symbol</span><span class="p">(</span><span class="s">&quot;ini_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="o">|&gt;</span><span class="n">eval</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="p">]</span><span class="w"></span>
<span class="c"># set the optimization type</span><span class="w"></span>
<span class="n">opt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">ControlOpt</span><span class="p">(</span><span class="n">ctrl</span><span class="o">=</span><span class="n">ini_1</span><span class="p">,</span><span class="w"> </span><span class="n">ctrl_bound</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">],</span><span class="w"> </span><span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<div class="tabbed-set" data-tabs="16:5"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><label for="__tabbed_16_1">auto-GRAPE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: auto-GRAPE</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">autoGRAPE</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                               </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><label for="__tabbed_16_2">GRAPE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: GRAPE</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">GRAPE</span><span class="p">(</span><span class="n">Adam</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span>
<span class="w">                           </span><span class="n">beta1</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span><span class="w"> </span><span class="n">beta2</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_16_3" name="__tabbed_16" type="radio" /><label for="__tabbed_16_3">PSO</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: PSO</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">PSO</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_particle</span><span class="o">=</span><span class="p">([</span><span class="n">ctrl</span><span class="p">],),</span><span class="w"> </span>
<span class="w">                         </span><span class="n">max_episode</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="w"> </span><span class="n">c0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">c1</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_16_4" name="__tabbed_16" type="radio" /><label for="__tabbed_16_4">DE</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: DE</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">p_num</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">ini_population</span><span class="o">=</span><span class="p">([</span><span class="n">ctrl</span><span class="p">],),</span><span class="w"> </span>
<span class="w">                        </span><span class="n">max_episode</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_16_5" name="__tabbed_16" type="radio" /><label for="__tabbed_16_5">DDPG</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># control algorithm: DDPG</span><span class="w"></span>
<span class="n">alg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">DDPG</span><span class="p">(</span><span class="n">max_episode</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">layer_num</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">layer_dim</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># input the dynamics data</span><span class="w"></span>
<span class="n">dynamics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">Lindblad</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">tspan</span><span class="p">,</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="n">H0</span><span class="p">,</span><span class="w"> </span><span class="n">dH</span><span class="p">,</span><span class="w"> </span><span class="n">Hc</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="p">)</span><span class="w">  </span>
</code></pre></div>
<div class="tabbed-set" data-tabs="17:3"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><label for="__tabbed_17_1">QFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WF^{-1})</span><span class="w"></span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">QFIM_obj</span><span class="p">()</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><label for="__tabbed_17_2">CFIM</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: tr(WI^{-1})</span><span class="w"></span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">CFIM_obj</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
<input id="__tabbed_17_3" name="__tabbed_17" type="radio" /><label for="__tabbed_17_3">HCRB</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c"># objective function: HCRB</span><span class="w"></span>
<span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QuanEstimation</span><span class="o">.</span><span class="n">HCRB_obj</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c"># run the control optimization problem</span><span class="w"></span>
<span class="n">QuanEstimation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<hr />
<h2 id="minimum-parameterization-time-optimization"><strong>Minimum parameterization time optimization</strong><a class="headerlink" href="#minimum-parameterization-time-optimization" title="Permanent link">&para;</a></h2>
<p>Search of the minimum time to reach a given value of the objective function.</p>
<div class="tabbed-set" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><label for="__tabbed_18_1">Python</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">control</span><span class="o">.</span><span class="n">mintime</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;binary&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;QFIM&quot;</span><span class="p">,</span> 
                <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><label for="__tabbed_18_2">Julia</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">mintime</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">opt</span><span class="p">,</span><span class="w"> </span><span class="n">alg</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">dynamics</span><span class="p">;</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s">&quot;binary&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">savefile</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
</div>
</div>
<p><code>f</code> is the given value of the objective function. In the package, two methods for searching 
the minimum time are provided which are logarithmic search and forward search from the 
beginning of time. It can be realized by setting <code>method=binary</code> (default) and 
<code>method=forward</code>. <code>target</code> represents the objective function for searching the minimum time, 
the users can choose QFI <span class="arithmatex">\(\left[\mathrm{Tr}(WF^{-1})\right]\)</span>, CFI <span class="arithmatex">\(\left[\mathrm{Tr}(WI^{-1})\right]\)</span> 
and HCRB for the objective functions. If <code>target="QFIM"</code>, the types for the logarithmic derivatives 
can be set via <code>LDtype</code>.</p>
<hr />
<h2 id="bibliography"><strong>Bibliography</strong><a class="headerlink" href="#bibliography" title="Permanent link">&para;</a></h2>
<p><a id="Khaneja2005">[1]</a>
N. Khaneja, T. Reiss, C. Hehlet, T. Schulte-Herbruggen, and S. J. Glaser,
Optimal control of coupled spin dynamics: Design of NMR pulse sequences by gradient 
ascent algorithms,
<a href="https://doi.org/10.1016/j.jmr.2004.11.004">J. Magn. Reson. <strong>172</strong>, 296 (2005).</a></p>
<p><a id="Liu2017a">[2]</a>
J. Liu and H. Yuan,
Quantum parameter estimation with optimal control,
<a href="https://doi.org/10.1103/PhysRevA.96.012117">Phys. Rev. A <strong>96</strong>, 012117 (2017).</a></p>
<p><a id="Liu2017b">[3]</a>
J. Liu and H. Yuan,
Control-enhanced multiparameter quantum estimation,
<a href="https://doi.org/10.1103/PhysRevA.96.042114">Phys. Rev. A <strong>96</strong>, 042114 (2017).</a></p>
<p><a id="Baydin2018">[4]</a>
A. G. Baydin, B. A. Pearlmutter, A. A. Radul, and J. M. Siskind,
Automatic differentiation in machine learning: a survey,
<a href="http://jmlr.org/papers/v18/17-468.html">J. Mach. Learn. Res. <strong>18</strong>, 1-43 (2018).</a></p>
<p><a id="Kennedy1995">[5]</a>
J. Kennedy and R. Eberhar,
Particle swarm optimization,
<a href="https://doi.org/10.1109/ICNN.1995.488968">Proc. 1995 IEEE International Conference on Neural Networks <strong>4</strong>, 1942-1948 (1995).
</a></p>
<p><a id="Storn1997">[6]</a>
R. Storn and K. Price,
Differential Evolution-A Simple and Efficient Heuristic for global
Optimization over Continuous Spaces,
<a href="https://doi.org/10.1023/A:1008202821328">J. Global Optim. <strong>11</strong>, 341 (1997).</a></p>
<p><a id="Lillicrap2015">[7]</a>
T. P. Lillicrap, J. J. Hunt, A. Pritzel, N. Heess, T. Erez, Y. Tassa, D. Silver, 
and D. Wierstra,
Continuous control with deep reinforcement learning,
<a href="https://arxiv.org/abs/1509.02971">arXiv:1509.02971.</a></p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../guide_resources/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Metrological resources" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Metrological resources
            </div>
          </div>
        </a>
      
      
        
        <a href="../guide_Sopt/" class="md-footer__link md-footer__link--next" aria-label="Next: State optimization" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              State optimization
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.3a4b43e5.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/mathjaxhelper.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>