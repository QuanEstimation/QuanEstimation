
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docs of QuanEstimation">
      
      
      
        <meta name="author" content="QuanEstimation">
      
      
        <link rel="canonical" href="http://bwmarrin.github.io/MkDocsPlus/API/python/functions/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-7.2.3">
    
    
      
        <title>Functions - QuanEstimation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/style.css">
    
      <link rel="stylesheet" href="../../../css/material.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
      <link rel="stylesheet" href="../../../css/julia_api.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kraus" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="QuanEstimation" class="md-header__button md-logo" aria-label="QuanEstimation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuanEstimation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Functions
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../installation/" class="md-tabs__link">
      Installation
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../guide/guide_import/" class="md-tabs__link">
        Users Guide
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../classes/" class="md-tabs__link md-tabs__link--active">
        API documentation
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../examples/" class="md-tabs__link">
      Examples
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../citing/" class="md-tabs__link">
      Citing
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../developers/" class="md-tabs__link">
      Developers
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="QuanEstimation" class="md-nav__button md-logo" aria-label="QuanEstimation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.924 7.924 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.924 7.924 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.924 7.924 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.924 7.924 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69L4.41 3M12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6z"/></svg>

    </a>
    QuanEstimation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Users Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Users Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Users Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_import/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_dynamics/" class="md-nav__link">
        Parameterization process
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_bounds/" class="md-nav__link">
        Quantum metrological tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_resources/" class="md-nav__link">
        Metrological resources
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Copt/" class="md-nav__link">
        Control optimization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Sopt/" class="md-nav__link">
        State optimization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Mopt/" class="md-nav__link">
        Measurement optimization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Compopt/" class="md-nav__link">
        Comprehensive optimization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_adaptive/" class="md-nav__link">
        Adaptive measurement schemes
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        API documentation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" checked>
      
      <label class="md-nav__link" for="__nav_4_1">
        Python
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../classes/" class="md-nav__link">
        Classes
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Functions
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kraus" class="md-nav__link">
    Kraus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Kraus" class="md-nav__link">
    quanestimation.Kraus
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.Kraus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.Kraus--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.Kraus--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrological-resources" class="md-nav__link">
    Metrological resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing" class="md-nav__link">
    quanestimation.SpinSqueezing
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.SpinSqueezing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.TargetTime" class="md-nav__link">
    quanestimation.TargetTime
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.TargetTime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.TargetTime--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.TargetTime--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-cramer-rao-bounds" class="md-nav__link">
    Quantum Cramér-Rao bounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SLD" class="md-nav__link">
    quanestimation.SLD
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.SLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.SLD--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.SLD--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.RLD" class="md-nav__link">
    quanestimation.RLD
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.RLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.RLD--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.RLD--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.LLD" class="md-nav__link">
    quanestimation.LLD
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.LLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.LLD--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.LLD--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM" class="md-nav__link">
    quanestimation.QFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus" class="md-nav__link">
    quanestimation.QFIM_Kraus
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM_Kraus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.CFIM" class="md-nav__link">
    quanestimation.CFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.CFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.CFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.CFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.FIM" class="md-nav__link">
    quanestimation.FIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.FIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.FIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch" class="md-nav__link">
    quanestimation.QFIM_Bloch
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM_Bloch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss" class="md-nav__link">
    quanestimation.QFIM_Gauss
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM_Gauss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holevo-cramer-rao-bounds" class="md-nav__link">
    Holevo Cramér-Rao bounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.HCRB" class="md-nav__link">
    quanestimation.HCRB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.HCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.HCRB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.HCRB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bounds" class="md-nav__link">
    Bayesian Cramér-Rao bounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCFIM" class="md-nav__link">
    quanestimation.BCFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BCFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQFIM" class="md-nav__link">
    quanestimation.BQFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BQFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCRB" class="md-nav__link">
    quanestimation.BCRB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCRB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCRB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQCRB" class="md-nav__link">
    quanestimation.BQCRB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BQCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQCRB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQCRB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.OBB" class="md-nav__link">
    quanestimation.OBB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.OBB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.OBB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.OBB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.VTB" class="md-nav__link">
    quanestimation.VTB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.VTB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.VTB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.VTB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QVTB" class="md-nav__link">
    quanestimation.QVTB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QVTB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QVTB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QVTB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-ziv-zakai-bound" class="md-nav__link">
    Quantum Ziv-Zakai bound
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QZZB" class="md-nav__link">
    quanestimation.QZZB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QZZB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QZZB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QZZB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-estimation" class="md-nav__link">
    Bayesian estimation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Bayes" class="md-nav__link">
    quanestimation.Bayes
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.Bayes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.Bayes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.Bayes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.MLE" class="md-nav__link">
    quanestimation.MLE
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.MLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.MLE--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.MLE--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesCost" class="md-nav__link">
    quanestimation.BayesCost
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BayesCost">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesCost--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesCost--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCB" class="md-nav__link">
    quanestimation.BCB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BCB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common" class="md-nav__link">
    Common
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesInput" class="md-nav__link">
    quanestimation.BayesInput
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BayesInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesInput--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesInput--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SIC" class="md-nav__link">
    quanestimation.SIC
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.SIC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.SIC--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.SIC--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.suN_generator" class="md-nav__link">
    quanestimation.suN_generator
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.suN_generator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.suN_generator--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.suN_generator--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../julia/api/" class="md-nav__link">
        Julia
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../citing/" class="md-nav__link">
        Citing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/" class="md-nav__link">
        Developers
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kraus" class="md-nav__link">
    Kraus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Kraus" class="md-nav__link">
    quanestimation.Kraus
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.Kraus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.Kraus--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.Kraus--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrological-resources" class="md-nav__link">
    Metrological resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing" class="md-nav__link">
    quanestimation.SpinSqueezing
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.SpinSqueezing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.TargetTime" class="md-nav__link">
    quanestimation.TargetTime
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.TargetTime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.TargetTime--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.TargetTime--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-cramer-rao-bounds" class="md-nav__link">
    Quantum Cramér-Rao bounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SLD" class="md-nav__link">
    quanestimation.SLD
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.SLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.SLD--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.SLD--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.RLD" class="md-nav__link">
    quanestimation.RLD
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.RLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.RLD--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.RLD--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.LLD" class="md-nav__link">
    quanestimation.LLD
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.LLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.LLD--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.LLD--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM" class="md-nav__link">
    quanestimation.QFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus" class="md-nav__link">
    quanestimation.QFIM_Kraus
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM_Kraus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.CFIM" class="md-nav__link">
    quanestimation.CFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.CFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.CFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.CFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.FIM" class="md-nav__link">
    quanestimation.FIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.FIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.FIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch" class="md-nav__link">
    quanestimation.QFIM_Bloch
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM_Bloch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss" class="md-nav__link">
    quanestimation.QFIM_Gauss
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QFIM_Gauss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holevo-cramer-rao-bounds" class="md-nav__link">
    Holevo Cramér-Rao bounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.HCRB" class="md-nav__link">
    quanestimation.HCRB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.HCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.HCRB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.HCRB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bounds" class="md-nav__link">
    Bayesian Cramér-Rao bounds
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCFIM" class="md-nav__link">
    quanestimation.BCFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BCFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQFIM" class="md-nav__link">
    quanestimation.BQFIM
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BQFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQFIM--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQFIM--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCRB" class="md-nav__link">
    quanestimation.BCRB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCRB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCRB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQCRB" class="md-nav__link">
    quanestimation.BQCRB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BQCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQCRB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BQCRB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.OBB" class="md-nav__link">
    quanestimation.OBB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.OBB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.OBB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.OBB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.VTB" class="md-nav__link">
    quanestimation.VTB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.VTB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.VTB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.VTB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QVTB" class="md-nav__link">
    quanestimation.QVTB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QVTB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QVTB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QVTB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-ziv-zakai-bound" class="md-nav__link">
    Quantum Ziv-Zakai bound
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QZZB" class="md-nav__link">
    quanestimation.QZZB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.QZZB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.QZZB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.QZZB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-estimation" class="md-nav__link">
    Bayesian estimation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Bayes" class="md-nav__link">
    quanestimation.Bayes
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.Bayes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.Bayes--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.Bayes--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.MLE" class="md-nav__link">
    quanestimation.MLE
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.MLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.MLE--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.MLE--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesCost" class="md-nav__link">
    quanestimation.BayesCost
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BayesCost">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesCost--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesCost--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCB" class="md-nav__link">
    quanestimation.BCB
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BCB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCB--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BCB--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common" class="md-nav__link">
    Common
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesInput" class="md-nav__link">
    quanestimation.BayesInput
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.BayesInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesInput--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.BayesInput--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SIC" class="md-nav__link">
    quanestimation.SIC
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.SIC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.SIC--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.SIC--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.suN_generator" class="md-nav__link">
    quanestimation.suN_generator
  </a>
  
    <nav class="md-nav" aria-label="quanestimation.suN_generator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quanestimation.suN_generator--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quanestimation.suN_generator--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/QuanEstimation/QuanEstimation/edit/master/docs/API/python/functions.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Functions</h1>
                
                <p>This part is the functions of the Python-Julia package which written in Python.</p>
<h2 id="kraus"><strong>Kraus</strong><a class="headerlink" href="#kraus" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<a id="quanestimation.Kraus"></a>
  <div class="doc doc-contents first">
  
      <p>The parameterization of a state is
\begin{align}
\rho=\sum_i K_i\rho_0K_i^{\dagger},
\end{align} </p>
<p>where <span class="arithmatex">\(\rho\)</span> is the evolved density matrix, <span class="arithmatex">\(K_i\)</span> is the Kraus operator.</p>
<h3 id="quanestimation.Kraus--parameters">Parameters<a class="headerlink" href="#quanestimation.Kraus--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>K:</strong> <code>list</code>
    -- Kraus operators.</p>
<p><strong>dK:</strong> <code>list</code>
    -- Derivatives of the Kraus operators with respect to the unknown parameters to be 
    estimated. For example, dK[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>rho0:</strong> <code>matrix</code>
    -- Initial state (density matrix).</p>
</blockquote>
<h3 id="quanestimation.Kraus--returns">Returns<a class="headerlink" href="#quanestimation.Kraus--returns" title="Permanent link">&para;</a></h3>
<p>Density matrix and its derivatives on the unknown parameters.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/Parameterization/NonDynamics.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The parameterization of a state is</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \rho=\sum_i K_i\rho_0K_i^{\dagger},</span>
<span class="sd">    \end{align} </span>

<span class="sd">    where $\rho$ is the evolved density matrix, $K_i$ is the Kraus operator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **K:** `list`</span>
<span class="sd">        -- Kraus operators.</span>

<span class="sd">    &gt; **dK:** `list`</span>
<span class="sd">        -- Derivatives of the Kraus operators with respect to the unknown parameters to be </span>
<span class="sd">        estimated. For example, dK[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **rho0:** `matrix`</span>
<span class="sd">        -- Initial state (density matrix).</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    Density matrix and its derivatives on the unknown parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">k_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dK</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">dK_reshape</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dK</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_num</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>

    <span class="n">rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="k">for</span> <span class="n">Ki</span> <span class="ow">in</span> <span class="n">K</span><span class="p">])</span>
    <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">([(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dKi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">dKi</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)))</span> <span class="k">for</span> <span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">dKi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dKj</span><span class="p">)])</span> <span class="k">for</span> <span class="n">dKj</span> <span class="ow">in</span> <span class="n">dK_reshape</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><hr />
<h2 id="metrological-resources"><strong>Metrological resources</strong><a class="headerlink" href="#metrological-resources" title="Permanent link">&para;</a></h2>
<!-- ### **Spin squeezing** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.SpinSqueezing"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of spin squeezing parameter for a density matrix.</p>
<h3 id="quanestimation.SpinSqueezing--parameters">Parameters<a class="headerlink" href="#quanestimation.SpinSqueezing--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho:</strong> <code>matrix</code>
    -- Density matrix.</p>
<p><strong>basis:</strong> <code>string</code>
    -- The basis of the state. Options are:<br />
    "Dicke" (default) -- Dicke basis.<br />
    "Pauli" -- The original basis of each spin.</p>
<p><strong>output:</strong> <code>string</code>
    -- Types of spin squeezing can be calculated. Options are:<br />
    "KU" (default) -- Spin squeezing defined by Kitagawa and Ueda.<br />
    "WBIMH" -- Spin squeezing defined by Wineland et al.</p>
</blockquote>
<h3 id="quanestimation.SpinSqueezing--returns">Returns<a class="headerlink" href="#quanestimation.SpinSqueezing--returns" title="Permanent link">&para;</a></h3>
<p><strong><span class="arithmatex">\(\xi\)</span>:</strong> <code>float</code>
    -- spin squeezing parameter</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/Resource/Resource.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">SpinSqueezing</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;Dicke&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;KU&quot;</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of spin squeezing parameter for a density matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho:** `matrix`</span>
<span class="sd">        -- Density matrix.</span>

<span class="sd">    &gt; **basis:** `string`</span>
<span class="sd">        -- The basis of the state. Options are:  </span>
<span class="sd">        &quot;Dicke&quot; (default) -- Dicke basis.  </span>
<span class="sd">        &quot;Pauli&quot; -- The original basis of each spin.</span>

<span class="sd">    &gt; **output:** `string`</span>
<span class="sd">        -- Types of spin squeezing can be calculated. Options are:  </span>
<span class="sd">        &quot;KU&quot; (default) -- Spin squeezing defined by Kitagawa and Ueda.  </span>
<span class="sd">        &quot;WBIMH&quot; -- Spin squeezing defined by Wineland et al.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **$\xi$:** `float`</span>
<span class="sd">        -- spin squeezing parameter</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">coef</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;Pauli&quot;</span><span class="p">:</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
        <span class="n">jp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span> 
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
                <span class="n">jp_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
                <span class="n">jp_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">sp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">jp_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">))))</span>
            <span class="n">jp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jp_tp</span><span class="p">)</span>
        <span class="n">Jp</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">jp</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">offdiag</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">][</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">Jp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">offdiag</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">Jx</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jp</span> <span class="o">+</span> <span class="n">Jp</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>
    <span class="n">Jy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jp</span> <span class="o">-</span> <span class="n">Jp</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>
    <span class="n">Jz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">Jx_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Jx</span><span class="p">)</span>
    <span class="n">Jy_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Jy</span><span class="p">)</span>
    <span class="n">Jz_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Jz</span><span class="p">)</span>

    <span class="n">costheta</span> <span class="o">=</span> <span class="n">Jz_mean</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Jx_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jy_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jz_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sintheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">costheta</span><span class="p">))</span>
    <span class="n">cosphi</span> <span class="o">=</span> <span class="n">Jx_mean</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Jx_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jy_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Jy_mean</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sinphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosphi</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sinphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosphi</span><span class="p">))</span>
    <span class="n">Jn1</span> <span class="o">=</span> <span class="o">-</span><span class="n">Jx</span> <span class="o">*</span> <span class="n">sinphi</span> <span class="o">+</span> <span class="n">Jy</span> <span class="o">*</span> <span class="n">cosphi</span>
    <span class="n">Jn2</span> <span class="o">=</span> <span class="o">-</span><span class="n">Jx</span> <span class="o">*</span> <span class="n">costheta</span> <span class="o">*</span> <span class="n">cosphi</span> <span class="o">-</span> <span class="n">Jy</span> <span class="o">*</span> <span class="n">costheta</span> <span class="o">*</span> <span class="n">sinphi</span> <span class="o">+</span> <span class="n">Jz</span> <span class="o">*</span> <span class="n">sintheta</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jn1</span> <span class="o">*</span> <span class="n">Jn1</span> <span class="o">-</span> <span class="n">Jn2</span> <span class="o">*</span> <span class="n">Jn2</span><span class="p">))</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jn1</span> <span class="o">*</span> <span class="n">Jn2</span> <span class="o">+</span> <span class="n">Jn2</span> <span class="o">*</span> <span class="n">Jn1</span><span class="p">))</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jn1</span> <span class="o">*</span> <span class="n">Jn1</span> <span class="o">+</span> <span class="n">Jn2</span> <span class="o">*</span> <span class="n">Jn2</span><span class="p">))</span>

    <span class="n">V_minus</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">V_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">V_minus</span><span class="p">)</span>
    <span class="n">Xi</span> <span class="o">=</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">V_minus</span>
    <span class="k">if</span> <span class="n">Xi</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="n">Xi</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;KU&quot;</span><span class="p">:</span>
        <span class="n">Xi</span> <span class="o">=</span> <span class="n">Xi</span>
    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;WBIMH&quot;</span><span class="p">:</span>
        <span class="n">Xi</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Xi</span> <span class="o">/</span> <span class="p">(</span><span class="n">Jx_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jy_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jz_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: output should be choosen in {KU, WBIMH}&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Xi</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Target time** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.TargetTime"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the time to reach a given precision limit.</p>
<h3 id="quanestimation.TargetTime--parameters">Parameters<a class="headerlink" href="#quanestimation.TargetTime--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>f:</strong> <code>float</code>
    -- The given value of the objective function.</p>
<p><strong>tspan:</strong> <code>array</code>
    -- Time length for the evolution.</p>
<p><strong>func:</strong> <code>array</code>
    -- The function for calculating the objective function.</p>
<p><strong>*args:</strong> <code>string</code>
    -- The corresponding input parameter.</p>
<p><strong>**kwargs:</strong> <code>string</code>
    -- Keyword arguments in <code>func</code>.</p>
</blockquote>
<h3 id="quanestimation.TargetTime--returns">Returns<a class="headerlink" href="#quanestimation.TargetTime--returns" title="Permanent link">&para;</a></h3>
<p><strong>time:</strong> <code>float</code>
    -- Time to reach the given target.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/Resource/Resource.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">TargetTime</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the time to reach a given precision limit.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **f:** `float`</span>
<span class="sd">        -- The given value of the objective function.</span>

<span class="sd">    &gt; **tspan:** `array`</span>
<span class="sd">        -- Time length for the evolution.</span>

<span class="sd">    &gt; **func:** `array`</span>
<span class="sd">        -- The function for calculating the objective function.</span>

<span class="sd">    &gt; ***args:** `string`</span>
<span class="sd">        -- The corresponding input parameter.</span>

<span class="sd">    &gt; ****kwargs:** `string`</span>
<span class="sd">        -- Keyword arguments in `func`.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **time:** `float`</span>
<span class="sd">        -- Time to reach the given target.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">zip_broadcast</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span>

    <span class="n">f_last</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">f_now</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">f_now</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f_last</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">f_last</span> <span class="o">=</span> <span class="n">f_now</span>
        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">f_now</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">idx</span><span class="p">]),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tspan</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><hr />
<h2 id="quantum-cramer-rao-bounds"><strong>Quantum Cramér-Rao bounds</strong><a class="headerlink" href="#quantum-cramer-rao-bounds" title="Permanent link">&para;</a></h2>
<!-- ### **Symmetric logarithmic derivative (SLD)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.SLD"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the symmetric logarithmic derivative (SLD) for a density matrix.
The SLD operator <span class="arithmatex">\(L_a\)</span> is determined by
\begin{align}
\partial_{a}\rho=\frac{1}{2}(\rho L_{a}+L_{a}\rho)
\end{align}</p>
<p>with <span class="arithmatex">\(\rho\)</span> the parameterized density matrix. The entries of SLD can be calculated
as 
\begin{align}
\langle\lambda_i|L_{a}|\lambda_j\rangle=\frac{2\langle\lambda_i| \partial_{a}\rho |\lambda_j\rangle}{\lambda_i+\lambda_j}
\end{align}</p>
<p>for <span class="arithmatex">\(\lambda_i~(\lambda_j) \neq 0\)</span>. If <span class="arithmatex">\(\lambda_i=\lambda_j=0\)</span>, the entry of SLD is set to be zero.</p>
<h3 id="quanestimation.SLD--parameters">Parameters<a class="headerlink" href="#quanestimation.SLD--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho:</strong> <code>matrix</code>
    -- Density matrix.</p>
<p><strong>drho:</strong> <code>list</code>
    -- Derivatives of the density matrix on the unknown parameters to be 
    estimated. For example, drho[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>rep:</strong> <code>string</code>
    -- The basis for the SLDs. Options are:<br />
    "original" (default) -- it means the basis is the same with the input density 
    matrix (rho).<br />
    "eigen" -- it means the basis is the same with theeigenspace of the density
    matrix (rho).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.SLD--returns">Returns<a class="headerlink" href="#quanestimation.SLD--returns" title="Permanent link">&para;</a></h3>
<p><strong>SLD(s):</strong> <code>matrix or list</code>
    --For single parameter estimation (the length of drho is equal to one), the
    output is a matrix and for multiparameter estimation (the length of drho 
    is more than one), it returns a list.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the symmetric logarithmic derivative (SLD) for a density matrix.</span>
<span class="sd">    The SLD operator $L_a$ is determined by</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \partial_{a}\rho=\frac{1}{2}(\rho L_{a}+L_{a}\rho)</span>
<span class="sd">    \end{align}</span>

<span class="sd">    with $\rho$ the parameterized density matrix. The entries of SLD can be calculated</span>
<span class="sd">    as </span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \langle\lambda_i|L_{a}|\lambda_j\rangle=\frac{2\langle\lambda_i| \partial_{a}\rho |\lambda_j\rangle}{\lambda_i+\lambda_j}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    for $\lambda_i~(\lambda_j) \neq 0$. If $\lambda_i=\lambda_j=0$, the entry of SLD is set to be zero.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho:** `matrix`</span>
<span class="sd">        -- Density matrix.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        -- Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">        estimated. For example, drho[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **rep:** `string`</span>
<span class="sd">        -- The basis for the SLDs. Options are:  </span>
<span class="sd">        &quot;original&quot; (default) -- it means the basis is the same with the input density </span>
<span class="sd">        matrix (rho).  </span>
<span class="sd">        &quot;eigen&quot; -- it means the basis is the same with theeigenspace of the density</span>
<span class="sd">        matrix (rho).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **SLD(s):** `matrix or list`</span>
<span class="sd">        --For single parameter estimation (the length of drho is equal to one), the</span>
<span class="sd">        output is a matrix and for multiparameter estimation (the length of drho </span>
<span class="sd">        is more than one), it returns a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure drho is a list!&quot;</span><span class="p">)</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">SLD</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)]</span>

    <span class="n">purity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">rho</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">purity</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
        <span class="n">SLD_org</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="n">SLD_org</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">drho</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
                <span class="n">SLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">SLD_org</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
                <span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="n">SLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">vec</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">SLD_org</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">vec</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for rep, supported values are &#39;original&#39; and &#39;eigen&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rep</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SLD</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SLD</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="n">SLD_eig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">fj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">fi</span><span class="p">]</span> <span class="o">+</span> <span class="n">val</span><span class="p">[</span><span class="n">fj</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                        <span class="n">SLD_eig</span><span class="p">[</span><span class="n">fi</span><span class="p">][</span><span class="n">fj</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="mi">2</span>
                            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                                <span class="n">vec</span><span class="p">[:,</span> <span class="n">fi</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">vec</span><span class="p">[:,</span> <span class="n">fj</span><span class="p">]),</span>
                            <span class="p">)</span>
                            <span class="o">/</span> <span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">fi</span><span class="p">]</span> <span class="o">+</span> <span class="n">val</span><span class="p">[</span><span class="n">fj</span><span class="p">])</span>
                        <span class="p">)</span>
            <span class="n">SLD_eig</span><span class="p">[</span><span class="n">SLD_eig</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
                <span class="n">SLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">SLD_eig</span><span class="p">,</span> <span class="n">vec</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()))</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
                <span class="n">SLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">SLD_eig</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for rep, supported values are &#39;original&#39; and &#39;eigen&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rep</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SLD</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SLD</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Right logarithmic derivative (RLD)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.RLD"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the right logarithmic derivative (RLD) for a density matrix.
The RLD operator defined by <span class="arithmatex">\(\partial_{a}\rho=\rho \mathcal{R}_a\)</span>
with <span class="arithmatex">\(\rho\)</span> the parameterized density matrix. 
\begin{align}
\langle\lambda_i| \mathcal{R}_{a} |\lambda_j\rangle=\frac{1}{\lambda_i}\langle\lambda_i| 
\partial_a\rho |\lambda_j\rangle 
\end{align}</p>
<p>for <span class="arithmatex">\(\lambda_i\neq 0\)</span> is the <span class="arithmatex">\(ij\)</span>th entry of RLD.</p>
<h3 id="quanestimation.RLD--parameters">Parameters<a class="headerlink" href="#quanestimation.RLD--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho:</strong> <code>matrix</code>
    -- Density matrix.</p>
<p><strong>drho:</strong> <code>list</code>
    -- Derivatives of the density matrix on the unknown parameters to be 
    estimated. For example, drho[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>rep:</strong> <code>string</code>
    -- The basis for the RLD(s). Options are:<br />
    "original" (default) -- it means the basis is the same with the input density 
    matrix (rho).<br />
    "eigen" -- it means the basis is the same with the eigenspace of the density 
    matrix (rho).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.RLD--returns">Returns<a class="headerlink" href="#quanestimation.RLD--returns" title="Permanent link">&para;</a></h3>
<p><strong>RLD(s):</strong> <code>matrix or list</code>
    -- For single parameter estimation (the length of drho is equal to one), the output 
    is a matrix and for multiparameter estimation (the length of drho is more than one), 
    it returns a list.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the right logarithmic derivative (RLD) for a density matrix.</span>
<span class="sd">    The RLD operator defined by $\partial_{a}\rho=\rho \mathcal{R}_a$</span>
<span class="sd">    with $\rho$ the parameterized density matrix. </span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \langle\lambda_i| \mathcal{R}_{a} |\lambda_j\rangle=\frac{1}{\lambda_i}\langle\lambda_i| </span>
<span class="sd">    \partial_a\rho |\lambda_j\rangle </span>
<span class="sd">    \end{align}</span>

<span class="sd">    for $\lambda_i\neq 0$ is the $ij$th entry of RLD.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho:** `matrix`</span>
<span class="sd">        -- Density matrix.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        -- Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">        estimated. For example, drho[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **rep:** `string`</span>
<span class="sd">        -- The basis for the RLD(s). Options are:  </span>
<span class="sd">        &quot;original&quot; (default) -- it means the basis is the same with the input density </span>
<span class="sd">        matrix (rho).  </span>
<span class="sd">        &quot;eigen&quot; -- it means the basis is the same with the eigenspace of the density </span>
<span class="sd">        matrix (rho).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **RLD(s):** `matrix or list`</span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), the output </span>
<span class="sd">        is a matrix and for multiparameter estimation (the length of drho is more than one), </span>
<span class="sd">        it returns a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure drho is a list!&quot;</span><span class="p">)</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">RLD</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)]</span>

    <span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
        <span class="n">RLD_eig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">fj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
                <span class="n">term_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec</span><span class="p">[:,</span> <span class="n">fi</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">vec</span><span class="p">[:,</span> <span class="n">fj</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">fi</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                    <span class="n">RLD_eig</span><span class="p">[</span><span class="n">fi</span><span class="p">][</span><span class="n">fj</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">term_tp</span><span class="o">/</span><span class="n">val</span><span class="p">[</span><span class="n">fi</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">term_tp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The RLD does not exist. It only exist when the support of drho is contained in the support of rho.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">RLD_eig</span><span class="p">[</span><span class="n">RLD_eig</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
            <span class="n">RLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">RLD_eig</span><span class="p">,</span> <span class="n">vec</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
            <span class="n">RLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">RLD_eig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for rep, supported values are &#39;original&#39; and &#39;eigen&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rep</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RLD</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RLD</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Left logarithmic derivative (LLD)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.LLD"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the left logarithmic derivative (LLD) for a density matrix <span class="arithmatex">\(\rho\)</span>.
The LLD operator is defined by <span class="arithmatex">\(\partial_{a}\rho=\mathcal{R}_a^{\dagger}\rho\)</span>. 
The entries of LLD can be calculated as 
\begin{align}
\langle\lambda_i| \mathcal{R}_{a}^{\dagger} |\lambda_j\rangle=\frac{1}{\lambda_j}\langle\lambda_i| 
\partial_a\rho |\lambda_j\rangle 
\end{align}</p>
<p>for <span class="arithmatex">\(\lambda_j\neq 0\)</span>.</p>
<h3 id="quanestimation.LLD--parameters">Parameters<a class="headerlink" href="#quanestimation.LLD--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho:</strong> <code>matrix</code>
    -- Density matrix.</p>
<p><strong>drho:</strong> <code>list</code>
    -- Derivatives of the density matrix on the unknown parameters to be 
    estimated. For example, drho[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>rep:</strong> <code>string</code>
    -- The basis for the LLD(s). Options are:<br />
    "original" (default) -- it means the basis is the same with the input density 
    matrix (rho).<br />
    "eigen" -- it means the basis is the same with the eigenspace of the density 
    matrix (rho).</p>
<p><strong>eps:</strong> float
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.LLD--returns">Returns<a class="headerlink" href="#quanestimation.LLD--returns" title="Permanent link">&para;</a></h3>
<p><strong>LLD(s):</strong> <code>matrix or list</code>
    -- For single parameter estimation (the length of drho is equal to one), the output 
    is a matrix and for multiparameter estimation (the length of drho is more than one), 
    it returns a list.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the left logarithmic derivative (LLD) for a density matrix $\rho$.</span>
<span class="sd">    The LLD operator is defined by $\partial_{a}\rho=\mathcal{R}_a^{\dagger}\rho$. </span>
<span class="sd">    The entries of LLD can be calculated as </span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \langle\lambda_i| \mathcal{R}_{a}^{\dagger} |\lambda_j\rangle=\frac{1}{\lambda_j}\langle\lambda_i| </span>
<span class="sd">    \partial_a\rho |\lambda_j\rangle </span>
<span class="sd">    \end{align}</span>

<span class="sd">    for $\lambda_j\neq 0$.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho:** `matrix`</span>
<span class="sd">        -- Density matrix.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        -- Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">        estimated. For example, drho[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **rep:** `string`</span>
<span class="sd">        -- The basis for the LLD(s). Options are:  </span>
<span class="sd">        &quot;original&quot; (default) -- it means the basis is the same with the input density </span>
<span class="sd">        matrix (rho).  </span>
<span class="sd">        &quot;eigen&quot; -- it means the basis is the same with the eigenspace of the density </span>
<span class="sd">        matrix (rho).</span>

<span class="sd">    &gt; **eps:** float</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **LLD(s):** `matrix or list`</span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), the output </span>
<span class="sd">        is a matrix and for multiparameter estimation (the length of drho is more than one), </span>
<span class="sd">        it returns a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure drho is a list!&quot;</span><span class="p">)</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">LLD</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)]</span>

    <span class="n">val</span><span class="p">,</span> <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
        <span class="n">LLD_eig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">fj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
                <span class="n">term_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec</span><span class="p">[:,</span> <span class="n">fi</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">vec</span><span class="p">[:,</span> <span class="n">fj</span><span class="p">]),)</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">fj</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                    <span class="n">LLD_eig_tp</span> <span class="o">=</span> <span class="p">(</span><span class="n">term_tp</span><span class="o">/</span><span class="n">val</span><span class="p">[</span><span class="n">fj</span><span class="p">])</span>
                    <span class="n">LLD_eig</span><span class="p">[</span><span class="n">fj</span><span class="p">][</span><span class="n">fi</span><span class="p">]</span> <span class="o">=</span> <span class="n">LLD_eig_tp</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span> 
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">term_tp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The LLD does not exist. It only exist when the support of drho is contained in the support of rho.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">LLD_eig</span><span class="p">[</span><span class="n">LLD_eig</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
            <span class="n">LLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LLD_eig</span><span class="p">,</span> <span class="n">vec</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
            <span class="n">LLD</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LLD_eig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for rep, supported values are &#39;original&#39; and &#39;eigen&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rep</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">LLD</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">LLD</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Quantum Fisher information matrix (QFIM)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.QFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the quantum Fisher information (QFI) and quantum Fisher 
information matrix (QFIM) for all types. The entry of QFIM <span class="arithmatex">\(\mathcal{F}\)</span>
is defined as
\begin{align}
\mathcal{F}_{ab}=\frac{1}{2}\mathrm{Tr}(\rho{L_a, L_b})
\end{align}</p>
<p>with <span class="arithmatex">\(L_a, L_b\)</span> are SLD operators and </p>
<p>and 
\begin{align}
\mathcal{F}_{ab}=\mathrm{Tr}(\rho \mathcal{R}_a \mathcal{R}^{\dagger}_b)
\end{align}</p>
<p>with <span class="arithmatex">\(\mathcal{R}_a\)</span> the RLD or LLD operator.</p>
<h3 id="quanestimation.QFIM--parameters">Parameters<a class="headerlink" href="#quanestimation.QFIM--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho:</strong> <code>matrix</code>
    -- Density matrix.</p>
<p><strong>drho:</strong> <code>list</code>
    Derivatives of the density matrix on the unknown parameters to be 
    estimated. For example, drho[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>LDtype:</strong> <code>string</code>
    -- Types of QFI (QFIM) can be set as the objective function. Options are:<br />
    "SLD" (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).<br />
    "RLD" -- QFI (QFIM) based on right logarithmic derivative (RLD).<br />
    "LLD" -- QFI (QFIM) based on left logarithmic derivative (LLD).</p>
<p><strong>exportLD:</strong> <code>bool</code>
    -- Whether or not to export the values of logarithmic derivatives. If set True
    then the the values of logarithmic derivatives will be exported.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.QFIM--returns">Returns<a class="headerlink" href="#quanestimation.QFIM--returns" title="Permanent link">&para;</a></h3>
<p><strong>QFI or QFIM:</strong> <code>float or matrix</code> 
    -- For single parameter estimation (the length of drho is equal to one), 
    the output is QFI and for multiparameter estimation (the length of drho 
    is more than one), it returns QFIM.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the quantum Fisher information (QFI) and quantum Fisher </span>
<span class="sd">    information matrix (QFIM) for all types. The entry of QFIM $\mathcal{F}$</span>
<span class="sd">    is defined as</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathcal{F}_{ab}=\frac{1}{2}\mathrm{Tr}(\rho\{L_a, L_b\})</span>
<span class="sd">    \end{align}</span>

<span class="sd">    with $L_a, L_b$ are SLD operators and </span>

<span class="sd">    and </span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathcal{F}_{ab}=\mathrm{Tr}(\rho \mathcal{R}_a \mathcal{R}^{\dagger}_b)</span>
<span class="sd">    \end{align}</span>

<span class="sd">    with $\mathcal{R}_a$ the RLD or LLD operator.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho:** `matrix`</span>
<span class="sd">        -- Density matrix.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">        estimated. For example, drho[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **LDtype:** `string`</span>
<span class="sd">        -- Types of QFI (QFIM) can be set as the objective function. Options are:  </span>
<span class="sd">        &quot;SLD&quot; (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).  </span>
<span class="sd">        &quot;RLD&quot; -- QFI (QFIM) based on right logarithmic derivative (RLD).  </span>
<span class="sd">        &quot;LLD&quot; -- QFI (QFIM) based on left logarithmic derivative (LLD).</span>

<span class="sd">    &gt; **exportLD:** `bool`</span>
<span class="sd">        -- Whether or not to export the values of logarithmic derivatives. If set True</span>
<span class="sd">        then the the values of logarithmic derivatives will be exported.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **QFI or QFIM:** `float or matrix` </span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), </span>
<span class="sd">        the output is QFI and for multiparameter estimation (the length of drho </span>
<span class="sd">        is more than one), it returns QFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure drho is a list&quot;</span><span class="p">)</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>

    <span class="c1"># single parameter estimation</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;SLD&quot;</span><span class="p">:</span>
            <span class="n">LD_tp</span> <span class="o">=</span> <span class="n">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">SLD_ac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD_tp</span><span class="p">,</span> <span class="n">LD_tp</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD_tp</span><span class="p">,</span> <span class="n">LD_tp</span><span class="p">)</span>
            <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">SLD_ac</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;RLD&quot;</span><span class="p">:</span>
            <span class="n">LD_tp</span> <span class="o">=</span> <span class="n">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD_tp</span><span class="p">,</span> <span class="n">LD_tp</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">())))</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;LLD&quot;</span><span class="p">:</span>
            <span class="n">LD_tp</span> <span class="o">=</span> <span class="n">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD_tp</span><span class="p">,</span> <span class="n">LD_tp</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">())))</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for LDtype, supported values are &#39;SLD&#39;, &#39;RLD&#39; and &#39;LLD&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">LDtype</span><span class="p">))</span>

    <span class="c1"># multiparameter estimation</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;SLD&quot;</span><span class="p">:</span>
            <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="n">LD_tp</span> <span class="o">=</span> <span class="n">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">SLD_ac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD_tp</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">LD_tp</span><span class="p">[</span><span class="n">para_j</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                        <span class="n">LD_tp</span><span class="p">[</span><span class="n">para_j</span><span class="p">],</span> <span class="n">LD_tp</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
                        <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">SLD_ac</span><span class="p">))</span>
                    <span class="p">)</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;RLD&quot;</span><span class="p">:</span>
            <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="n">LD_tp</span> <span class="o">=</span> <span class="n">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                                <span class="n">rho</span><span class="p">,</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD_tp</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">LD_tp</span><span class="p">[</span><span class="n">para_j</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()),</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;LLD&quot;</span><span class="p">:</span>
            <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="n">LD_tp</span> <span class="o">=</span> <span class="n">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                                <span class="n">rho</span><span class="p">,</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD_tp</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">LD_tp</span><span class="p">[</span><span class="n">para_j</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()),</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for LDtype, supported values are &#39;SLD&#39;, &#39;RLD&#39; and &#39;LLD&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">LDtype</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">exportLD</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">QFIM_res</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">QFIM_res</span><span class="p">,</span> <span class="n">LD_tp</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Quantum Fisher information matrix with Kraus operators** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.QFIM_Kraus"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the quantum Fisher information (QFI) and quantum Fisher 
information matrix (QFIM) with Kraus operator(s) for all types.</p>
<h3 id="quanestimation.QFIM_Kraus--parameters">Parameters<a class="headerlink" href="#quanestimation.QFIM_Kraus--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho0:</strong> <code>matrix</code>
    -- Initial state (density matrix).</p>
<p><strong>K:</strong> <code>list</code>
    -- Kraus operator(s).</p>
<p><strong>dK:</strong> <code>list</code> 
    -- Derivatives of the Kraus operator(s) on the unknown parameters to be 
    estimated. For example, dK[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>LDtype:</strong> <code>string</code>
    -- Types of QFI (QFIM) can be set as the objective function. Options are:<br />
    "SLD" (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).<br />
    "RLD" -- QFI (QFIM) based on right logarithmic derivative (RLD).<br />
    "LLD" -- QFI (QFIM) based on left logarithmic derivative (LLD).</p>
<p><strong>exportLD:</strong> <code>bool</code>
    -- Whether or not to export the values of logarithmic derivatives. If set True
    then the the values of logarithmic derivatives will be exported.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.QFIM_Kraus--returns">Returns<a class="headerlink" href="#quanestimation.QFIM_Kraus--returns" title="Permanent link">&para;</a></h3>
<p><strong>QFI or QFIM:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of drho is equal to one), 
    the output is QFI and for multiparameter estimation (the length of drho 
    is more than one), it returns QFIM.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">QFIM_Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the quantum Fisher information (QFI) and quantum Fisher </span>
<span class="sd">    information matrix (QFIM) with Kraus operator(s) for all types.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho0:** `matrix`</span>
<span class="sd">        -- Initial state (density matrix).</span>

<span class="sd">    &gt; **K:** `list`</span>
<span class="sd">        -- Kraus operator(s).</span>

<span class="sd">    &gt; **dK:** `list` </span>
<span class="sd">        -- Derivatives of the Kraus operator(s) on the unknown parameters to be </span>
<span class="sd">        estimated. For example, dK[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **LDtype:** `string`</span>
<span class="sd">        -- Types of QFI (QFIM) can be set as the objective function. Options are:  </span>
<span class="sd">        &quot;SLD&quot; (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).  </span>
<span class="sd">        &quot;RLD&quot; -- QFI (QFIM) based on right logarithmic derivative (RLD).  </span>
<span class="sd">        &quot;LLD&quot; -- QFI (QFIM) based on left logarithmic derivative (LLD).</span>

<span class="sd">    &gt; **exportLD:** `bool`</span>
<span class="sd">        -- Whether or not to export the values of logarithmic derivatives. If set True</span>
<span class="sd">        then the the values of logarithmic derivatives will be exported.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **QFI or QFIM:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), </span>
<span class="sd">        the output is QFI and for multiparameter estimation (the length of drho </span>
<span class="sd">        is more than one), it returns QFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dK</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dK</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dK</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="k">for</span> <span class="n">Ki</span> <span class="ow">in</span> <span class="n">K</span><span class="p">])</span>
    <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">sum</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dKi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
                            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">dKi</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">dKi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dKj</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">dKj</span> <span class="ow">in</span> <span class="n">dK</span>
            <span class="p">]</span>
    <span class="k">return</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="n">exportLD</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Classical Fisher information matrix (CFIM)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.CFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the classical Fisher information (CFI) and classical Fisher 
information matrix (CFIM) for a density matrix. The entry of CFIM <span class="arithmatex">\(\mathcal{I}\)</span>
is defined as
\begin{align}
\mathcal{I}_{ab}=\sum_y\frac{1}{p(y|\textbf{x})}[\partial_a p(y|\textbf{x})][\partial_b p(y|\textbf{x})],
\end{align}</p>
<p>where <span class="arithmatex">\(p(y|\textbf{x})=\mathrm{Tr}(\rho\Pi_y)\)</span> with <span class="arithmatex">\(\rho\)</span> the parameterized 
density matrix.</p>
<h3 id="quanestimation.CFIM--parameters">Parameters<a class="headerlink" href="#quanestimation.CFIM--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho:</strong> <code>matrix</code>
    -- Density matrix.</p>
<p><strong>drho:</strong> <code>list</code>
    -- Derivatives of the density matrix on the unknown parameters to be 
    estimated. For example, drho[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>M:</strong> <code>list of matrices</code>
    -- A set of positive operator-valued measure (POVM). The default measurement 
    is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.CFIM--returns">Returns<a class="headerlink" href="#quanestimation.CFIM--returns" title="Permanent link">&para;</a></h3>
<p><strong>CFI (CFIM):</strong> <code>float or matrix</code> 
    -- For single parameter estimation (the length of drho is equal to one), 
    the output is CFI and for multiparameter estimation (the length of drho 
    is more than one), it returns CFIM.</p>
<p><strong>Note:</strong> 
    SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
    which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/
    solutions.html">here</a>.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the classical Fisher information (CFI) and classical Fisher </span>
<span class="sd">    information matrix (CFIM) for a density matrix. The entry of CFIM $\mathcal{I}$</span>
<span class="sd">    is defined as</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathcal{I}_{ab}=\sum_y\frac{1}{p(y|\textbf{x})}[\partial_a p(y|\textbf{x})][\partial_b p(y|\textbf{x})],</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $p(y|\textbf{x})=\mathrm{Tr}(\rho\Pi_y)$ with $\rho$ the parameterized </span>
<span class="sd">    density matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho:** `matrix`</span>
<span class="sd">        -- Density matrix.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        -- Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">        estimated. For example, drho[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **M:** `list of matrices`</span>
<span class="sd">        -- A set of positive operator-valued measure (POVM). The default measurement </span>
<span class="sd">        is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **CFI (CFIM):** `float or matrix` </span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), </span>
<span class="sd">        the output is CFI and for multiparameter estimation (the length of drho </span>
<span class="sd">        is more than one), it returns CFIM.</span>

<span class="sd">    **Note:** </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/</span>
<span class="sd">        solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure drho is a list!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

    <span class="n">m_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">CFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m_num</span><span class="p">):</span>
        <span class="n">Mp</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">Mp</span><span class="p">)))</span>
        <span class="n">Cadd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">drho_i</span> <span class="o">=</span> <span class="n">drho</span><span class="p">[</span><span class="n">para_i</span><span class="p">]</span>
                <span class="n">dp_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">drho_i</span><span class="p">,</span> <span class="n">Mp</span><span class="p">)))</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">drho_j</span> <span class="o">=</span> <span class="n">drho</span><span class="p">[</span><span class="n">para_j</span><span class="p">]</span>
                    <span class="n">dp_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">drho_j</span><span class="p">,</span> <span class="n">Mp</span><span class="p">)))</span>
                    <span class="n">Cadd</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp_i</span> <span class="o">*</span> <span class="n">dp_j</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span>
                    <span class="n">Cadd</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp_i</span> <span class="o">*</span> <span class="n">dp_j</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">CFIM_res</span> <span class="o">+=</span> <span class="n">Cadd</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">CFIM_res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">CFIM_res</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Fisher information matrix (FIM)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.FIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the classical Fisher information (CFI) and classical Fisher 
information matrix (CFIM) for classical scenarios. The entry of FIM <span class="arithmatex">\(I\)</span>
is defined as
\begin{align}
I_{ab}=\sum_{y}\frac{1}{p_y}[\partial_a p_y][\partial_b p_y],
\end{align}</p>
<p>where <span class="arithmatex">\(\{p_y\}\)</span> is a set of the discrete probability distribution.</p>
<h3 id="quanestimation.FIM--parameters">Parameters<a class="headerlink" href="#quanestimation.FIM--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>p:</strong> <code>array</code> 
    -- The probability distribution.</p>
<p><strong>dp:</strong> <code>list</code>
    -- Derivatives of the probability distribution on the unknown parameters to 
    be estimated. For example, dp[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.FIM--returns">Returns<a class="headerlink" href="#quanestimation.FIM--returns" title="Permanent link">&para;</a></h3>
<p><strong>CFI (CFIM):</strong> <code>float or matrix</code> 
    -- For single parameter estimation (the length of drho is equal to one), 
    the output is CFI and for multiparameter estimation (the length of drho 
    is more than one), it returns CFIM.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">FIM</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the classical Fisher information (CFI) and classical Fisher </span>
<span class="sd">    information matrix (CFIM) for classical scenarios. The entry of FIM $I$</span>
<span class="sd">    is defined as</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    I_{ab}=\sum_{y}\frac{1}{p_y}[\partial_a p_y][\partial_b p_y],</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\{p_y\}$ is a set of the discrete probability distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **p:** `array` </span>
<span class="sd">        -- The probability distribution.</span>

<span class="sd">    &gt; **dp:** `list`</span>
<span class="sd">        -- Derivatives of the probability distribution on the unknown parameters to </span>
<span class="sd">        be estimated. For example, dp[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **CFI (CFIM):** `float or matrix` </span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), </span>
<span class="sd">        the output is CFI and for multiparameter estimation (the length of drho </span>
<span class="sd">        is more than one), it returns CFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">m_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">FIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m_num</span><span class="p">):</span>
        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span>
        <span class="n">Cadd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">p_tp</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">dp_i</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">pi</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">dp_j</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">pi</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span>
                    <span class="n">Cadd</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp_i</span> <span class="o">*</span> <span class="n">dp_j</span> <span class="o">/</span> <span class="n">p_tp</span><span class="p">)</span>
                    <span class="n">Cadd</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp_i</span> <span class="o">*</span> <span class="n">dp_j</span> <span class="o">/</span> <span class="n">p_tp</span><span class="p">)</span>
        <span class="n">FIM_res</span> <span class="o">+=</span> <span class="n">Cadd</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FIM_res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FIM_res</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Quantum Fisher information matrix in Bloch representation** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.QFIM_Bloch"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the SLD based quantum Fisher information (QFI) and quantum<br />
Fisher information matrix (QFIM) in Bloch representation.</p>
<h3 id="quanestimation.QFIM_Bloch--parameters">Parameters<a class="headerlink" href="#quanestimation.QFIM_Bloch--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>r:</strong> <code>list</code>
    -- Parameterized Bloch vector.</p>
<p><strong>dr:</strong> <code>list</code>
    -- Derivatives of the Bloch vector on the unknown parameters to be 
    estimated. For example, dr[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.QFIM_Bloch--returns">Returns<a class="headerlink" href="#quanestimation.QFIM_Bloch--returns" title="Permanent link">&para;</a></h3>
<p><strong>QFI or QFIM in Bloch representation:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of drho is equal to one), 
    the output is QFI and for multiparameter estimation (the length of drho 
    is more than one), it returns QFIM.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">QFIM_Bloch</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the SLD based quantum Fisher information (QFI) and quantum  </span>
<span class="sd">    Fisher information matrix (QFIM) in Bloch representation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **r:** `list`</span>
<span class="sd">        -- Parameterized Bloch vector.</span>

<span class="sd">    &gt; **dr:** `list `</span>
<span class="sd">        -- Derivatives of the Bloch vector on the unknown parameters to be </span>
<span class="sd">        estimated. For example, dr[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **QFI or QFIM in Bloch representation:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), </span>
<span class="sd">        the output is QFI and for multiparameter estimation (the length of drho </span>
<span class="sd">        is more than one), it returns QFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dr</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure dr is a list&quot;</span><span class="p">)</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dr</span><span class="p">)</span>
    <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">Lambda</span> <span class="o">=</span> <span class="n">suN_generator</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1">#### single-qubit system ####</span>
        <span class="n">r_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_norm</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">dr</span><span class="p">[</span><span class="n">para_j</span><span class="p">]))</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">para_i</span><span class="p">],</span> <span class="n">dr</span><span class="p">[</span><span class="n">para_j</span><span class="p">])</span>
                        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">[</span><span class="n">para_i</span><span class="p">])</span>
                        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">[</span><span class="n">para_j</span><span class="p">])</span>
                        <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r_norm</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="o">/</span> <span class="n">dim</span>
        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">rho</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dim</span> <span class="o">*</span> <span class="p">(</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="n">di</span><span class="p">]</span> <span class="o">*</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">di</span><span class="p">]</span> <span class="o">/</span> <span class="n">dim</span>

        <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">row_i</span><span class="p">,</span> <span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">anti_commu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="n">row_i</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">col_j</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">Lambda</span><span class="p">[</span><span class="n">col_j</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">row_i</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">G</span><span class="p">[</span><span class="n">row_i</span><span class="p">][</span><span class="n">col_j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">anti_commu</span><span class="p">))</span>
                <span class="n">G</span><span class="p">[</span><span class="n">col_j</span><span class="p">][</span><span class="n">row_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">row_i</span><span class="p">][</span><span class="n">col_j</span><span class="p">]</span>

        <span class="n">mat_tp</span> <span class="o">=</span> <span class="n">G</span> <span class="o">*</span> <span class="n">dim</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">mat_inv</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">mat_tp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">para_m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_m</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mat_inv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">para_m</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span>
                    <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_n</span><span class="p">][</span><span class="n">para_m</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">QFIM_res</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Quantum Fisher information matrix with Gaussian states** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.QFIM_Gauss"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the SLD based quantum Fisher information (QFI) and quantum 
Fisher information matrix (QFIM) with gaussian states.</p>
<h3 id="quanestimation.QFIM_Gauss--parameters">Parameters<a class="headerlink" href="#quanestimation.QFIM_Gauss--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>R:</strong> <code>array</code> 
    -- First-order moment.</p>
<p><strong>dR:</strong> <code>list</code>
    -- Derivatives of the first-order moment on the unknown parameters to be 
    estimated. For example, dR[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>D:</strong> <code>matrix</code>
    -- Second-order moment.</p>
<p><strong>dD:</strong> <code>list</code>
    -- Derivatives of the second-order moment on the unknown parameters to be 
    estimated. For example, dD[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.QFIM_Gauss--returns">Returns<a class="headerlink" href="#quanestimation.QFIM_Gauss--returns" title="Permanent link">&para;</a></h3>
<p><strong>QFI or QFIM with gaussian states:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of drho is equal to one), 
    the output is QFI and for multiparameter estimation (the length of drho 
    is more than one), it returns QFIM.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">QFIM_Gauss</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">dR</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the SLD based quantum Fisher information (QFI) and quantum </span>
<span class="sd">    Fisher information matrix (QFIM) with gaussian states.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **R:** `array` </span>
<span class="sd">        -- First-order moment.</span>

<span class="sd">    &gt; **dR:** `list`</span>
<span class="sd">        -- Derivatives of the first-order moment on the unknown parameters to be </span>
<span class="sd">        estimated. For example, dR[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **D:** `matrix`</span>
<span class="sd">        -- Second-order moment.</span>

<span class="sd">    &gt; **dD:** `list`</span>
<span class="sd">        -- Derivatives of the second-order moment on the unknown parameters to be </span>
<span class="sd">        estimated. For example, dD[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **QFI or QFIM with gaussian states:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of drho is equal to one), </span>
<span class="sd">        the output is QFI and for multiparameter estimation (the length of drho </span>
<span class="sd">        is more than one), it returns QFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dR</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">QFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">dC</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="n">dD</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">dR</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dR</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">C_sqrt</span> <span class="o">=</span> <span class="n">sqrtm</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">C_sqrt</span> <span class="o">@</span> <span class="n">J</span> <span class="o">@</span> <span class="n">C_sqrt</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">P</span><span class="p">[:][::</span><span class="mi">2</span><span class="p">],</span> <span class="n">P</span><span class="p">[:][</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">T</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">schur</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">eigvals</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>
    <span class="n">Diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">(</span><span class="n">c</span><span class="o">**-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">J</span> <span class="o">@</span> <span class="n">C_sqrt</span> <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">P</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="o">-</span><span class="n">Diag</span><span class="p">))</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">P</span><span class="o">.</span><span class="n">T</span>

    <span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]])</span>
    <span class="n">a_Gauss</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sx</span><span class="p">]</span>

    <span class="n">es</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">As</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a_Gauss</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">es</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[[[</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">@</span> <span class="n">dC</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">@</span> <span class="n">aa</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">A</span><span class="p">]</span> <span class="k">for</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">As</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">dC</span> <span class="ow">in</span> <span class="n">dC</span>
    <span class="p">]</span>
    <span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">longdouble</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
                        <span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                        <span class="o">*</span> <span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                        <span class="o">@</span> <span class="n">As</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                        <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
                    <span class="p">)</span>

    <span class="n">QFIM_res</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">dC</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="n">dR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">@</span> <span class="n">dR</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">QFIM_res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">QFIM_res</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><hr />
<h2 id="holevo-cramer-rao-bounds"><strong>Holevo Cramér-Rao bounds</strong><a class="headerlink" href="#holevo-cramer-rao-bounds" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<a id="quanestimation.HCRB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Holevo Cramer-Rao bound (HCRB) via the semidefinite program (SDP).</p>
<h3 id="quanestimation.HCRB--parameters">Parameters<a class="headerlink" href="#quanestimation.HCRB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>rho:</strong> <code>matrix</code>
    -- Density matrix.</p>
<p><strong>drho:</strong> <code>list</code>
    -- Derivatives of the density matrix on the unknown parameters to be 
    estimated. For example, drho[0] is the derivative vector on the first 
    parameter.</p>
<p><strong>W:</strong> <code>matrix</code>
    -- Weight matrix.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.HCRB--returns">Returns<a class="headerlink" href="#quanestimation.HCRB--returns" title="Permanent link">&para;</a></h3>
<p><strong>HCRB:</strong> <code>float</code>
    -- The value of Holevo Cramer-Rao bound.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/AsymptoticBound/Holevo.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">HCRB</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Holevo Cramer-Rao bound (HCRB) via the semidefinite program (SDP).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **rho:** `matrix`</span>
<span class="sd">        -- Density matrix.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        -- Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">        estimated. For example, drho[0] is the derivative vector on the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **W:** `matrix`</span>
<span class="sd">        -- Weight matrix.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **HCRB:** `float`</span>
<span class="sd">        -- The value of Holevo Cramer-Rao bound.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure drho is a list!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;In single parameter scenario, HCRB is equivalent to QFI. This function will return the value of QFI.&quot;</span>
        <span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>
    <span class="k">elif</span> <span class="n">matrix_rank</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;For rank-one weight matrix, the HCRB is equivalent to QFIM. This function will return the value of Tr(WF^{-1}).&quot;</span>
        <span class="p">)</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">*</span> <span class="n">dim</span>
        <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>

        <span class="n">Lambda</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span> <span class="o">+</span> <span class="n">suN_generator</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="n">Lambda</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">vec_drho</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
            <span class="n">vec_drho</span><span class="p">[</span><span class="n">pi</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="n">pi</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Lambda</span><span class="p">))</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
                <span class="n">S</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="n">b</span><span class="p">],</span> <span class="n">rho</span><span class="p">)))</span>

        <span class="n">accu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">eps</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">lu</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">perm</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">ldl</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">accu</span><span class="p">))</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
        <span class="c1"># ============optimization variables================</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
        <span class="c1"># ================add constraints===================</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">cp</span><span class="o">.</span><span class="n">bmat</span><span class="p">([[</span><span class="n">V</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">R</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="p">[</span><span class="n">R</span> <span class="o">@</span> <span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">num</span><span class="p">)]])</span> <span class="o">&gt;&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">constraints</span> <span class="o">+=</span> <span class="p">[</span><span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">vec_drho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">constraints</span> <span class="o">+=</span> <span class="p">[</span><span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">vec_drho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">W</span> <span class="o">@</span> <span class="n">V</span><span class="p">)),</span> <span class="n">constraints</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><hr />
<h2 id="bayesian-cramer-rao-bounds"><strong>Bayesian Cramér-Rao bounds</strong><a class="headerlink" href="#bayesian-cramer-rao-bounds" title="Permanent link">&para;</a></h2>
<!-- ### **Bayesian classical Fisher information matrix (BCFIM)** # -->


<div class="doc doc-object doc-function">


<a id="quanestimation.BCFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian classical Fisher information (BCFI) and the 
Bayesian classical Fisher information matrix (BCFIM) of the form
\begin{align}
\mathcal{I}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{I}\mathrm{d}\textbf{x}
\end{align}</p>
<p>with <span class="arithmatex">\(\mathcal{I}\)</span> the CFIM and <span class="arithmatex">\(p(\textbf{x})\)</span> the prior distribution.</p>
<h3 id="quanestimation.BCFIM--parameters">Parameters<a class="headerlink" href="#quanestimation.BCFIM--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>drho:</strong> <code>multidimensional list</code>
    -- Derivatives of the parameterized density matrix (rho) with respect to the unknown
    parameters to be estimated.</p>
<p><strong>M:</strong> <code>list of matrices</code>
    -- A set of positive operator-valued measure (POVM). The default measurement 
    is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.BCFIM--returns">Returns<a class="headerlink" href="#quanestimation.BCFIM--returns" title="Permanent link">&para;</a></h3>
<p><strong>BCFI or BCFIM:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of x is equal to one), the output 
    is BCFI and for multiparameter estimation (the length of x is more than one), 
    it returns BCFIM.</p>
<p><strong>Note:</strong> 
    SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
    which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/
    solutions.html">here</a>.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesianCramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BCFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian classical Fisher information (BCFI) and the </span>
<span class="sd">    Bayesian classical Fisher information matrix (BCFIM) of the form</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathcal{I}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{I}\mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    with $\mathcal{I}$ the CFIM and $p(\textbf{x})$ the prior distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **drho:** `multidimensional list`</span>
<span class="sd">        -- Derivatives of the parameterized density matrix (rho) with respect to the unknown</span>
<span class="sd">        parameters to be estimated.</span>

<span class="sd">    &gt; **M:** `list of matrices`</span>
<span class="sd">        -- A set of positive operator-valued measure (POVM). The default measurement </span>
<span class="sd">        is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **BCFI or BCFIM:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of x is equal to one), the output </span>
<span class="sd">        is BCFI and for multiparameter estimation (the length of x is more than one), </span>
<span class="sd">        it returns BCFIM.</span>

<span class="sd">    **Note:** </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/</span>
<span class="sd">        solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
            <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

        <span class="n">BCFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">BCFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                <span class="n">BCFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
        <span class="k">return</span> <span class="n">BCFIM_res</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Bayesian quantum Fisher information matrix (BQFIM)** # -->


<div class="doc doc-object doc-function">


<a id="quanestimation.BQFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian quantum Fisher information (BQFI) and the 
Bayesian quantum Fisher information matrix (BQFIM) of the form
\begin{align}
\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}\mathrm{d}\textbf{x}
\end{align}</p>
<p>with <span class="arithmatex">\(\mathcal{F}\)</span> the QFIM of all types and <span class="arithmatex">\(p(\textbf{x})\)</span> the prior distribution.</p>
<h3 id="quanestimation.BQFIM--parameters">Parameters<a class="headerlink" href="#quanestimation.BQFIM--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>drho:</strong> <code>multidimensional list</code>
    -- Derivatives of the parameterized density matrix (rho) with respect to the unknown
    parameters to be estimated.</p>
<p><strong>LDtype:</strong> <code>string</code>
    -- Types of QFI (QFIM) can be set as the objective function. Options are:<br />
    "SLD" (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).<br />
    "RLD" -- QFI (QFIM) based on right logarithmic derivative (RLD).<br />
    "LLD" -- QFI (QFIM) based on left logarithmic derivative (LLD).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.BQFIM--returns">Returns<a class="headerlink" href="#quanestimation.BQFIM--returns" title="Permanent link">&para;</a></h3>
<p><strong>BQFI or BQFIM:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of x is equal to one), the output 
    is BQFI and for multiparameter estimation (the length of x is more than one), 
    it returns BQFIM.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesianCramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BQFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian quantum Fisher information (BQFI) and the </span>
<span class="sd">    Bayesian quantum Fisher information matrix (BQFIM) of the form</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}\mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    with $\mathcal{F}$ the QFIM of all types and $p(\textbf{x})$ the prior distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **drho:** `multidimensional list`</span>
<span class="sd">        -- Derivatives of the parameterized density matrix (rho) with respect to the unknown</span>
<span class="sd">        parameters to be estimated.</span>

<span class="sd">    &gt; **LDtype:** `string`</span>
<span class="sd">        -- Types of QFI (QFIM) can be set as the objective function. Options are:  </span>
<span class="sd">        &quot;SLD&quot; (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).  </span>
<span class="sd">        &quot;RLD&quot; -- QFI (QFIM) based on right logarithmic derivative (RLD).  </span>
<span class="sd">        &quot;LLD&quot; -- QFI (QFIM) based on left logarithmic derivative (LLD).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **BQFI or BQFIM:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of x is equal to one), the output </span>
<span class="sd">        is BQFI and for multiparameter estimation (the length of x is more than one), </span>
<span class="sd">        it returns BQFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
            <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

        <span class="n">BQFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">BQFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                <span class="n">BQFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
        <span class="k">return</span> <span class="n">BQFIM_res</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Bayesian Cramér-Rao bound (BCRB)** # -->


<div class="doc doc-object doc-function">


<a id="quanestimation.BCRB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian Cramer-Rao bound (BCRB). The covariance matrix 
with a prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> is defined as
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})=\int p(\textbf{x})\sum_y\mathrm{Tr}
(\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
\mathrm{d}\textbf{x}
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}\)</span> are the unknown parameters to be estimated
and the integral <span class="arithmatex">\(\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots\)</span>.
<span class="arithmatex">\(\{\Pi_y\}\)</span> is a set of positive operator-valued measure (POVM) and <span class="arithmatex">\(\rho\)</span> represents 
the parameterized density matrix.</p>
<p>This function calculates three types BCRB. The first one is 
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \int p(\textbf{x})\left(B\mathcal{I}^{-1}B
+\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x},
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{b}\)</span> and <span class="arithmatex">\(\textbf{b}'\)</span> are the vectors of biase and its derivatives on parameters.
<span class="arithmatex">\(B\)</span> is a diagonal matrix with the <span class="arithmatex">\(i\)</span>th entry <span class="arithmatex">\(B_{ii}=1+[\textbf{b}']_{i}\)</span> and <span class="arithmatex">\(\mathcal{I}\)</span> 
is the CFIM.</p>
<p>The second one is
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \mathcal{B}\,\mathcal{I}_{\mathrm{Bayes}}^{-1}\,
\mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x},
\end{align}</p>
<p>where <span class="arithmatex">\(\mathcal{B}=\int p(\textbf{x})B\mathrm{d}\textbf{x}\)</span> is the average of <span class="arithmatex">\(B\)</span> and 
<span class="arithmatex">\(\mathcal{I}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{I}\mathrm{d}\textbf{x}\)</span> is 
the average CFIM.</p>
<p>The third one is
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \int p(\textbf{x})
\mathcal{G}\left(\mathcal{I}_p+\mathcal{I}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}
\end{align}</p>
<p>with <span class="arithmatex">\([\mathcal{I}_{p}]_{ab}:=[\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]\)</span> and
<span class="arithmatex">\(\mathcal{G}_{ab}:=[\partial_b\ln p(\textbf{x})][\textbf{b}]_a+B_{aa}\delta_{ab}\)</span>.</p>
<h3 id="quanestimation.BCRB--parameters">Parameters<a class="headerlink" href="#quanestimation.BCRB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>drho:</strong> <code>multidimensional list</code>
    -- Derivatives of the parameterized density matrix (rho) with respect to the unknown
    parameters to be estimated.</p>
<p><strong>M:</strong> <code>list of matrices</code>
    -- A set of positive operator-valued measure (POVM). The default measurement 
    is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
<p><strong>b:</strong> <code>list</code>
    -- Vector of biases of the form <span class="arithmatex">\(\textbf{b}=(b(x_0),b(x_1),\dots)^{\mathrm{T}}\)</span>.</p>
<p><strong>db:</strong> <code>list</code>
    -- Derivatives of b with respect to the unknown parameters to be estimated, It should be 
    expressed as <span class="arithmatex">\(\textbf{b}'=(\partial_0 b(x_0),\partial_1 b(x_1),\dots)^{\mathrm{T}}\)</span>.</p>
<p><strong>btype:</strong> <code>int (1, 2, 3)</code>
    -- Types of the BCRB. Options are:<br />
    1 (default) -- It means to calculate the first type of the BCRB.<br />
    2 -- It means to calculate the second type of the BCRB.
    3 -- It means to calculate the third type of the BCRB.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.BCRB--returns">Returns<a class="headerlink" href="#quanestimation.BCRB--returns" title="Permanent link">&para;</a></h3>
<p><strong>BCRB:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of x is equal to one), the 
    output is a float and for multiparameter estimation (the length of x is 
    more than one), it returns a matrix.</p>
<p><strong>Note:</strong> 
    SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
    which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/
    solutions.html">here</a>.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesianCramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">b</span><span class="o">=</span><span class="p">[],</span> <span class="n">db</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian Cramer-Rao bound (BCRB). The covariance matrix </span>
<span class="sd">    with a prior distribution $p(\textbf{x})$ is defined as</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})=\int p(\textbf{x})\sum_y\mathrm{Tr}</span>
<span class="sd">    (\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">    \mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}$ are the unknown parameters to be estimated</span>
<span class="sd">    and the integral $\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots$.</span>
<span class="sd">    $\{\Pi_y\}$ is a set of positive operator-valued measure (POVM) and $\rho$ represents </span>
<span class="sd">    the parameterized density matrix.</span>

<span class="sd">    This function calculates three types BCRB. The first one is </span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \int p(\textbf{x})\left(B\mathcal{I}^{-1}B</span>
<span class="sd">    +\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x},</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\textbf{b}$ and $\textbf{b}&#39;$ are the vectors of biase and its derivatives on parameters.</span>
<span class="sd">    $B$ is a diagonal matrix with the $i$th entry $B_{ii}=1+[\textbf{b}&#39;]_{i}$ and $\mathcal{I}$ </span>
<span class="sd">    is the CFIM.</span>

<span class="sd">    The second one is</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \mathcal{B}\,\mathcal{I}_{\mathrm{Bayes}}^{-1}\,</span>
<span class="sd">    \mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x},</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\mathcal{B}=\int p(\textbf{x})B\mathrm{d}\textbf{x}$ is the average of $B$ and </span>
<span class="sd">    $\mathcal{I}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{I}\mathrm{d}\textbf{x}$ is </span>
<span class="sd">    the average CFIM.</span>

<span class="sd">    The third one is</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \int p(\textbf{x})</span>
<span class="sd">    \mathcal{G}\left(\mathcal{I}_p+\mathcal{I}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    with $[\mathcal{I}_{p}]_{ab}:=[\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]$ and</span>
<span class="sd">    $\mathcal{G}_{ab}:=[\partial_b\ln p(\textbf{x})][\textbf{b}]_a+B_{aa}\delta_{ab}$.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **drho:** `multidimensional list`</span>
<span class="sd">        -- Derivatives of the parameterized density matrix (rho) with respect to the unknown</span>
<span class="sd">        parameters to be estimated.</span>

<span class="sd">    &gt; **M:** `list of matrices`</span>
<span class="sd">        -- A set of positive operator-valued measure (POVM). The default measurement </span>
<span class="sd">        is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>

<span class="sd">    &gt; **b:** `list`</span>
<span class="sd">        -- Vector of biases of the form $\textbf{b}=(b(x_0),b(x_1),\dots)^{\mathrm{T}}$.</span>

<span class="sd">    &gt; **db:** `list`</span>
<span class="sd">        -- Derivatives of b with respect to the unknown parameters to be estimated, It should be </span>
<span class="sd">        expressed as $\textbf{b}&#39;=(\partial_0 b(x_0),\partial_1 b(x_1),\dots)^{\mathrm{T}}$.</span>

<span class="sd">    &gt; **btype:** `int (1, 2, 3)`</span>
<span class="sd">        -- Types of the BCRB. Options are:  </span>
<span class="sd">        1 (default) -- It means to calculate the first type of the BCRB.  </span>
<span class="sd">        2 -- It means to calculate the second type of the BCRB.</span>
<span class="sd">        3 -- It means to calculate the third type of the BCRB.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **BCRB:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of x is equal to one), the </span>
<span class="sd">        output is a float and for multiparameter estimation (the length of x is </span>
<span class="sd">        more than one), it returns a matrix.</span>

<span class="sd">    **Note:** </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/</span>
<span class="sd">        solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> <span class="n">db</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F1</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">F1</span> <span class="o">+</span> <span class="n">bb</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">I_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">I_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">b</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> <span class="n">db</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">b_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
        <span class="n">db_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">db</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">dp_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">dp_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">dp_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">dp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dp_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">b_list</span><span class="p">,</span> <span class="n">db_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b_ele</span><span class="p">,</span> <span class="n">db_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">b_pro</span><span class="p">,</span> <span class="n">db_pro</span><span class="p">):</span>
            <span class="n">b_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">b_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="n">db_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">db_ele</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">F_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">term1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">F_inv</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
                <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">term1</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">+</span> <span class="n">term2</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">B_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">bb_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">B_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">bb_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">B_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">B_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">bb_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bb_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="n">B_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="n">bb_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">B_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">bb_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bb_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">B_mn</span>
                    <span class="n">arr3</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">bb_mn</span>
                    <span class="k">for</span> <span class="n">sj</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr2</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                        <span class="n">arr3</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                    <span class="n">B_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                    <span class="n">bb_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr3</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_res</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span><span class="p">),</span> <span class="n">B_res</span><span class="p">))</span> <span class="o">+</span> <span class="n">bb_res</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">I_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="n">G_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">pm</span> <span class="o">==</span> <span class="n">pn</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">I_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>

                <span class="n">F_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">G_tp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span> <span class="o">+</span> <span class="n">I_tp</span><span class="p">),</span> <span class="n">G_tp</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tot</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Bayesian quantum Cramér-Rao bound (BQCRB)** # -->


<div class="doc doc-object doc-function">


<a id="quanestimation.BQCRB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian quantum Cramer-Rao bound (BQCRB). The covariance matrix 
with a prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> is defined as
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})=\int p(\textbf{x})\sum_y\mathrm{Tr}
(\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
\mathrm{d}\textbf{x}
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}\)</span> are the unknown parameters to be estimated
and the integral <span class="arithmatex">\(\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots\)</span>.
<span class="arithmatex">\(\{\Pi_y\}\)</span> is a set of positive operator-valued measure (POVM) and <span class="arithmatex">\(\rho\)</span> represent 
the parameterized density matrix.</p>
<p>This function calculates three types of the BQCRB. The first one is
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq\int p(\textbf{x})\left(B\mathcal{F}^{-1}B
+\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x},
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{b}\)</span> and <span class="arithmatex">\(\textbf{b}'\)</span> are the vectors of biase and its derivatives on parameters.
<span class="arithmatex">\(B\)</span> is a diagonal matrix with the <span class="arithmatex">\(i\)</span>th entry <span class="arithmatex">\(B_{ii}=1+[\textbf{b}']_{i}\)</span> and <span class="arithmatex">\(\mathcal{F}\)</span>
is the QFIM for all types.</p>
<p>The second one is
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \mathcal{B}\,\mathcal{F}_{\mathrm{Bayes}}^{-1}\,
\mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x},
\end{align}</p>
<p>where <span class="arithmatex">\(\mathcal{B}=\int p(\textbf{x})B\mathrm{d}\textbf{x}\)</span> is the average of <span class="arithmatex">\(B\)</span> and 
<span class="arithmatex">\(\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}\mathrm{d}\textbf{x}\)</span> is 
the average QFIM.</p>
<p>The third one is
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})\geq \int p(\textbf{x})
\mathcal{G}\left(\mathcal{I}_p+\mathcal{F}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}
\end{align}</p>
<p>with <span class="arithmatex">\([\mathcal{I}_{p}]_{ab}:=[\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]\)</span> and
<span class="arithmatex">\(\mathcal{G}_{ab}:=[\partial_b\ln p(\textbf{x})][\textbf{b}]_a+B_{aa}\delta_{ab}\)</span>.</p>
<h3 id="quanestimation.BQCRB--parameters">Parameters<a class="headerlink" href="#quanestimation.BQCRB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>drho:</strong> <code>multidimensional list</code>
    -- Derivatives of the parameterized density matrix (rho) with respect to the unknown
    parameters to be estimated.</p>
<p><strong>b:</strong> <code>list</code>
    -- Vector of biases of the form <span class="arithmatex">\(\textbf{b}=(b(x_0),b(x_1),\dots)^{\mathrm{T}}\)</span>.</p>
<p><strong>db:</strong> <code>list</code>
    -- Derivatives of b with respect to the unknown parameters to be estimated, It should be 
    expressed as <span class="arithmatex">\(\textbf{b}'=(\partial_0 b(x_0),\partial_1 b(x_1),\dots)^{\mathrm{T}}\)</span>.</p>
<p><strong>btype:</strong> <code>int (1, 2, 3)</code>
    -- Types of the BQCRB. Options are:<br />
    1 (default) -- It means to calculate the first type of the BQCRB.<br />
    2 -- It means to calculate the second type of the BQCRB.
    3 -- It means to calculate the third type of the BCRB.</p>
<p><strong>LDtype:</strong> <code>string</code>
    -- Types of QFI (QFIM) can be set as the objective function. Options are:<br />
    "SLD" (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).<br />
    "RLD" -- QFI (QFIM) based on right logarithmic derivative (RLD).<br />
    "LLD" -- QFI (QFIM) based on left logarithmic derivative (LLD).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.BQCRB--returns">Returns<a class="headerlink" href="#quanestimation.BQCRB--returns" title="Permanent link">&para;</a></h3>
<p><strong>BQCRB:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of x is equal to one), the 
    output is a float and for multiparameter estimation (the length of x is 
    more than one), it returns a matrix.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesianCramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BQCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">[],</span> <span class="n">db</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian quantum Cramer-Rao bound (BQCRB). The covariance matrix </span>
<span class="sd">    with a prior distribution $p(\textbf{x})$ is defined as</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})=\int p(\textbf{x})\sum_y\mathrm{Tr}</span>
<span class="sd">    (\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">    \mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}$ are the unknown parameters to be estimated</span>
<span class="sd">    and the integral $\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots$.</span>
<span class="sd">    $\{\Pi_y\}$ is a set of positive operator-valued measure (POVM) and $\rho$ represent </span>
<span class="sd">    the parameterized density matrix.</span>

<span class="sd">    This function calculates three types of the BQCRB. The first one is</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq\int p(\textbf{x})\left(B\mathcal{F}^{-1}B</span>
<span class="sd">    +\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x},</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\textbf{b}$ and $\textbf{b}&#39;$ are the vectors of biase and its derivatives on parameters.</span>
<span class="sd">    $B$ is a diagonal matrix with the $i$th entry $B_{ii}=1+[\textbf{b}&#39;]_{i}$ and $\mathcal{F}$</span>
<span class="sd">    is the QFIM for all types.</span>

<span class="sd">    The second one is</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \mathcal{B}\,\mathcal{F}_{\mathrm{Bayes}}^{-1}\,</span>
<span class="sd">    \mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x},</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\mathcal{B}=\int p(\textbf{x})B\mathrm{d}\textbf{x}$ is the average of $B$ and </span>
<span class="sd">    $\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}\mathrm{d}\textbf{x}$ is </span>
<span class="sd">    the average QFIM.</span>

<span class="sd">    The third one is</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \int p(\textbf{x})</span>
<span class="sd">    \mathcal{G}\left(\mathcal{I}_p+\mathcal{F}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    with $[\mathcal{I}_{p}]_{ab}:=[\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]$ and</span>
<span class="sd">    $\mathcal{G}_{ab}:=[\partial_b\ln p(\textbf{x})][\textbf{b}]_a+B_{aa}\delta_{ab}$.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **drho:** `multidimensional list`</span>
<span class="sd">        -- Derivatives of the parameterized density matrix (rho) with respect to the unknown</span>
<span class="sd">        parameters to be estimated.</span>

<span class="sd">    &gt; **b:** `list`</span>
<span class="sd">        -- Vector of biases of the form $\textbf{b}=(b(x_0),b(x_1),\dots)^{\mathrm{T}}$.</span>

<span class="sd">    &gt; **db:** `list`</span>
<span class="sd">        -- Derivatives of b with respect to the unknown parameters to be estimated, It should be </span>
<span class="sd">        expressed as $\textbf{b}&#39;=(\partial_0 b(x_0),\partial_1 b(x_1),\dots)^{\mathrm{T}}$.</span>

<span class="sd">    &gt; **btype:** `int (1, 2, 3)`</span>
<span class="sd">        -- Types of the BQCRB. Options are:  </span>
<span class="sd">        1 (default) -- It means to calculate the first type of the BQCRB.  </span>
<span class="sd">        2 -- It means to calculate the second type of the BQCRB.</span>
<span class="sd">        3 -- It means to calculate the third type of the BCRB.</span>

<span class="sd">    &gt; **LDtype:** `string`</span>
<span class="sd">        -- Types of QFI (QFIM) can be set as the objective function. Options are:  </span>
<span class="sd">        &quot;SLD&quot; (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).  </span>
<span class="sd">        &quot;RLD&quot; -- QFI (QFIM) based on right logarithmic derivative (RLD).  </span>
<span class="sd">        &quot;LLD&quot; -- QFI (QFIM) based on left logarithmic derivative (LLD).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **BQCRB:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of x is equal to one), the </span>
<span class="sd">        output is a float and for multiparameter estimation (the length of x is </span>
<span class="sd">        more than one), it returns a matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> <span class="n">db</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F2</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">F2</span> <span class="o">+</span> <span class="n">bb</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">I_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">I_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">b</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> <span class="n">db</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">b_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
        <span class="n">db_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">db</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">dp_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">dp_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">dp_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">dp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dp_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">b_list</span><span class="p">,</span> <span class="n">db_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b_ele</span><span class="p">,</span> <span class="n">db_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">b_pro</span><span class="p">,</span> <span class="n">db_pro</span><span class="p">):</span>
            <span class="n">b_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">b_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="n">db_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">db_ele</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">F_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">term1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">F_inv</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
                <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">term1</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">+</span> <span class="n">term2</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">B_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">bb_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">B_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">bb_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">B_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">B_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">bb_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bb_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="n">B_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="n">bb_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">B_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">bb_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bb_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">B_mn</span>
                    <span class="n">arr3</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">bb_mn</span>
                    <span class="k">for</span> <span class="n">sj</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr2</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                        <span class="n">arr3</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                    <span class="n">B_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                    <span class="n">bb_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr3</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_res</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span><span class="p">),</span> <span class="n">B_res</span><span class="p">))</span> <span class="o">+</span> <span class="n">bb_res</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">I_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="n">G_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">pm</span> <span class="o">==</span> <span class="n">pn</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">I_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>

                <span class="n">F_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">G_tp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span> <span class="o">+</span> <span class="n">I_tp</span><span class="p">),</span> <span class="n">G_tp</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tot</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Optimal biased bound (OBB)** # -->


<div class="doc doc-object doc-function">


<a id="quanestimation.OBB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the optimal biased bound based on the first type of the BQCRB 
in the case of single parameter estimation. The expression of OBB with a 
prior distribution <span class="arithmatex">\(p(x)\)</span> is
\begin{align}
\mathrm{var}(\hat{x},{\Pi_y})\geq\int p(x)\left(\frac{(1+b')^2}{F}
+b^2\right)\mathrm{d}x,
\end{align}</p>
<p>where <span class="arithmatex">\(b\)</span> and <span class="arithmatex">\(b'\)</span> are the vector of biase and its derivative on <span class="arithmatex">\(x\)</span>. 
<span class="arithmatex">\(F\)</span> is the QFI for all types.</p>
<h3 id="quanestimation.OBB--parameters">Parameters<a class="headerlink" href="#quanestimation.OBB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>array</code>
    -- The prior distribution.</p>
<p><strong>dp:</strong> <code>list</code>
    -- Derivatives of the prior distribution with respect to the unknown parameters to to
    estimated. For example, dp[0] is the derivative vector with respect to the first 
    parameter.</p>
<p><strong>rho:</strong> <code>list</code>
    -- Parameterized density matrix.</p>
<p><strong>drho:</strong> <code>list</code>
    -- Derivatives of the parameterized density matrix (rho) with respect to the unknown
    parameters to be estimated.</p>
<p><strong>drho:</strong> <code>list</code>
    -- Second order Derivatives of the parameterized density matrix (rho) with respect to the 
    unknown parameters to be estimated.</p>
<p><strong>LDtype:</strong> <code>string</code>
    -- Types of QFI (QFIM) can be set as the objective function. Options are:<br />
    "SLD" (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).<br />
    "RLD" -- QFI (QFIM) based on right logarithmic derivative (RLD).<br />
    "LLD" -- QFI (QFIM) based on left logarithmic derivative (LLD).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.OBB--returns">Returns<a class="headerlink" href="#quanestimation.OBB--returns" title="Permanent link">&para;</a></h3>
<p><strong>QVTB:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of x is equal to one), the 
    output is a float and for multiparameter estimation (the length of x is 
    more than one), it returns a matrix.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesianCramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">OBB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">d2rho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the optimal biased bound based on the first type of the BQCRB </span>
<span class="sd">    in the case of single parameter estimation. The expression of OBB with a </span>
<span class="sd">    prior distribution $p(x)$ is</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{var}(\hat{x},\{\Pi_y\})\geq\int p(x)\left(\frac{(1+b&#39;)^2}{F}</span>
<span class="sd">    +b^2\right)\mathrm{d}x,</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $b$ and $b&#39;$ are the vector of biase and its derivative on $x$. </span>
<span class="sd">    $F$ is the QFI for all types.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **dp:** `list`</span>
<span class="sd">        -- Derivatives of the prior distribution with respect to the unknown parameters to to</span>
<span class="sd">        estimated. For example, dp[0] is the derivative vector with respect to the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **rho:** `list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        -- Derivatives of the parameterized density matrix (rho) with respect to the unknown</span>
<span class="sd">        parameters to be estimated.</span>

<span class="sd">    &gt; **drho:** `list`</span>
<span class="sd">        -- Second order Derivatives of the parameterized density matrix (rho) with respect to the </span>
<span class="sd">        unknown parameters to be estimated.</span>

<span class="sd">    &gt; **LDtype:** `string`</span>
<span class="sd">        -- Types of QFI (QFIM) can be set as the objective function. Options are:  </span>
<span class="sd">        &quot;SLD&quot; (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).  </span>
<span class="sd">        &quot;RLD&quot; -- QFI (QFIM) based on right logarithmic derivative (RLD).  </span>
<span class="sd">        &quot;LLD&quot; -- QFI (QFIM) based on left logarithmic derivative (LLD).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **QVTB:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of x is equal to one), the </span>
<span class="sd">        output is a float and for multiparameter estimation (the length of x is </span>
<span class="sd">        more than one), it returns a matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#### single parameter scenario ####</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">d2rho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">d2rho</span> <span class="o">=</span> <span class="p">[</span><span class="n">d2rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">float</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">F</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
    <span class="n">bias</span><span class="p">,</span> <span class="n">dbias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">LD</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">F</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">d2rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">d2rho</span><span class="p">[</span><span class="n">m</span><span class="p">]),</span> <span class="n">LD</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">LD</span><span class="p">,</span> <span class="n">LD</span><span class="p">),</span> <span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
        <span class="n">dF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span><span class="p">))</span>
        <span class="n">J</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">-</span> <span class="n">dF</span> <span class="o">/</span> <span class="n">f</span>

    <span class="n">y_guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">OBB_func</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_guess</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">bias</span><span class="p">,</span> <span class="n">dbias</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dbias</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">bias</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">simps</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Van Trees bound (VTB)** # -->


<div class="doc doc-object doc-function">


<a id="quanestimation.VTB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian version of Cramer-Rao bound introduced by
Van Trees (VTB). The covariance matrix with a prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> 
is defined as
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})=\int p(\textbf{x})\sum_y\mathrm{Tr}
(\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
\mathrm{d}\textbf{x}
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}\)</span> are the unknown parameters to be estimated
and the integral <span class="arithmatex">\(\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots\)</span>.
<span class="arithmatex">\(\{\Pi_y\}\)</span> is a set of positive operator-valued measure (POVM) and <span class="arithmatex">\(\rho\)</span> represent 
the parameterized density matrix.</p>
<div class="arithmatex">\[\begin{align}
\mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \left(\mathcal{I}_{\mathrm{prior}}
+\mathcal{I}_{\mathrm{Bayes}}\right)^{-1},
\end{align}\]</div>
<p>where <span class="arithmatex">\(\mathcal{I}_{\mathrm{prior}}=\int p(\textbf{x})\mathcal{I}_{p}\mathrm{d}\textbf{x}\)</span> 
is the CFIM for <span class="arithmatex">\(p(\textbf{x})\)</span> and 
<span class="arithmatex">\(\mathcal{I}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{I}\mathrm{d}\textbf{x}\)</span> is the 
average CFIM.</p>
<h3 id="quanestimation.VTB--parameters">Parameters<a class="headerlink" href="#quanestimation.VTB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>dp:</strong> <code>list</code>
    -- Derivatives of the prior distribution with respect to the unknown parameters 
    to be estimated. For example, dp[0] is the derivative vector with respect to the first 
    parameter.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>drho:</strong> <code>multidimensional list</code>
    -- Derivatives of the parameterized density matrix (rho) with respect to the 
    unknown parameters to be estimated.</p>
<p><strong>M:</strong> <code>list of matrices</code>
    -- A set of positive operator-valued measure (POVM). The default measurement 
    is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.VTB--returns">Returns<a class="headerlink" href="#quanestimation.VTB--returns" title="Permanent link">&para;</a></h3>
<p><strong>VTB:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of x is equal to one), the 
    output is a float and for multiparameter estimation (the length of x is 
    more than one), it returns a matrix.</p>
<p><strong>Note:</strong> 
    SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
    which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/
    solutions.html">here</a>.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesianCramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">VTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian version of Cramer-Rao bound introduced by</span>
<span class="sd">    Van Trees (VTB). The covariance matrix with a prior distribution $p(\textbf{x})$ </span>
<span class="sd">    is defined as</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})=\int p(\textbf{x})\sum_y\mathrm{Tr}</span>
<span class="sd">    (\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">    \mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}$ are the unknown parameters to be estimated</span>
<span class="sd">    and the integral $\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots$.</span>
<span class="sd">    $\{\Pi_y\}$ is a set of positive operator-valued measure (POVM) and $\rho$ represent </span>
<span class="sd">    the parameterized density matrix.</span>

<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \left(\mathcal{I}_{\mathrm{prior}}</span>
<span class="sd">    +\mathcal{I}_{\mathrm{Bayes}}\right)^{-1},</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\mathcal{I}_{\mathrm{prior}}=\int p(\textbf{x})\mathcal{I}_{p}\mathrm{d}\textbf{x}$ </span>
<span class="sd">    is the CFIM for $p(\textbf{x})$ and </span>
<span class="sd">    $\mathcal{I}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{I}\mathrm{d}\textbf{x}$ is the </span>
<span class="sd">    average CFIM.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **dp:** `list`</span>
<span class="sd">        -- Derivatives of the prior distribution with respect to the unknown parameters </span>
<span class="sd">        to be estimated. For example, dp[0] is the derivative vector with respect to the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **drho:** `multidimensional list`</span>
<span class="sd">        -- Derivatives of the parameterized density matrix (rho) with respect to the </span>
<span class="sd">        unknown parameters to be estimated.</span>

<span class="sd">    &gt; **M:** `list of matrices`</span>
<span class="sd">        -- A set of positive operator-valued measure (POVM). The default measurement </span>
<span class="sd">        is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **VTB:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of x is equal to one), the </span>
<span class="sd">        output is a float and for multiparameter estimation (the length of x is </span>
<span class="sd">        more than one), it returns a matrix.</span>

<span class="sd">    **Note:** </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/</span>
<span class="sd">        solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>


        <span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="n">F</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">dp_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">dp_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">dp_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">dp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dp_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">I_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
            <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                    <span class="n">I_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pj</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
                        <span class="p">)</span>

        <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="n">I_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">I_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">I_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">arr1</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">I_ij</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">arr1</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span> <span class="o">+</span> <span class="n">I_res</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Qauntum Van Trees bound (QVTB)** # -->


<div class="doc doc-object doc-function">


<a id="quanestimation.QVTB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian version of quantum Cramer-Rao bound introduced 
by Van Trees (QVTB). The covariance matrix with a prior distribution p(\textbf{x}) 
is defined as
\begin{align}
\mathrm{cov}(\hat{\textbf{x}},{\Pi_y})=\int p(\textbf{x})\sum_y\mathrm{Tr}
(\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
\mathrm{d}\textbf{x}
\end{align}</p>
<p>where <span class="arithmatex">\(\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}\)</span> are the unknown parameters to be estimated
and the integral <span class="arithmatex">\(\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots\)</span>.
<span class="arithmatex">\(\{\Pi_y\}\)</span> is a set of positive operator-valued measure (POVM) and <span class="arithmatex">\(\rho\)</span> represent 
the parameterized density matrix.</p>
<div class="arithmatex">\[\begin{align}
\mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \left(\mathcal{I}_{\mathrm{prior}}
+\mathcal{F}_{\mathrm{Bayes}}\right)^{-1},
\end{align}\]</div>
<p>where <span class="arithmatex">\(\mathcal{I}_{\mathrm{prior}}=\int p(\textbf{x})\mathcal{I}_{p}\mathrm{d}\textbf{x}\)</span> is 
the CFIM for <span class="arithmatex">\(p(\textbf{x})\)</span> and <span class="arithmatex">\(\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}
\mathrm{d}\textbf{x}\)</span> is the average QFIM of all types.</p>
<h3 id="quanestimation.QVTB--parameters">Parameters<a class="headerlink" href="#quanestimation.QVTB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> multidimensional array
    -- The prior distribution.</p>
<p><strong>dp:</strong> <code>list</code>
    -- Derivatives of the prior distribution with respect to the unknown parameters to to
    estimated. For example, dp[0] is the derivative vector with respect to the first 
    parameter.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>drho:</strong> <code>multidimensional list</code>
    -- Derivatives of the parameterized density matrix (rho) with respect to the unknown
    parameters to be estimated.</p>
<p><strong>LDtype:</strong> <code>string</code>
    -- Types of QFI (QFIM) can be set as the objective function. Options are:<br />
    "SLD" (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).<br />
    "RLD" -- QFI (QFIM) based on right logarithmic derivative (RLD).<br />
    "LLD" -- QFI (QFIM) based on left logarithmic derivative (LLD).</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.QVTB--returns">Returns<a class="headerlink" href="#quanestimation.QVTB--returns" title="Permanent link">&para;</a></h3>
<p><strong>QVTB:</strong> <code>float or matrix</code>
    -- For single parameter estimation (the length of x is equal to one), the 
    output is a float and for multiparameter estimation (the length of x is 
    more than one), it returns a matrix.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesianCramerRao.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">QVTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian version of quantum Cramer-Rao bound introduced </span>
<span class="sd">    by Van Trees (QVTB). The covariance matrix with a prior distribution p(\textbf{x}) </span>
<span class="sd">    is defined as</span>
<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})=\int p(\textbf{x})\sum_y\mathrm{Tr}</span>
<span class="sd">    (\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">    \mathrm{d}\textbf{x}</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}$ are the unknown parameters to be estimated</span>
<span class="sd">    and the integral $\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots$.</span>
<span class="sd">    $\{\Pi_y\}$ is a set of positive operator-valued measure (POVM) and $\rho$ represent </span>
<span class="sd">    the parameterized density matrix.</span>

<span class="sd">    \begin{align}</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \left(\mathcal{I}_{\mathrm{prior}}</span>
<span class="sd">    +\mathcal{F}_{\mathrm{Bayes}}\right)^{-1},</span>
<span class="sd">    \end{align}</span>

<span class="sd">    where $\mathcal{I}_{\mathrm{prior}}=\int p(\textbf{x})\mathcal{I}_{p}\mathrm{d}\textbf{x}$ is </span>
<span class="sd">    the CFIM for $p(\textbf{x})$ and $\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}</span>
<span class="sd">    \mathrm{d}\textbf{x}$ is the average QFIM of all types.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** multidimensional array</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **dp:** `list`</span>
<span class="sd">        -- Derivatives of the prior distribution with respect to the unknown parameters to to</span>
<span class="sd">        estimated. For example, dp[0] is the derivative vector with respect to the first </span>
<span class="sd">        parameter.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **drho:** `multidimensional list`</span>
<span class="sd">        -- Derivatives of the parameterized density matrix (rho) with respect to the unknown</span>
<span class="sd">        parameters to be estimated.</span>

<span class="sd">    &gt; **LDtype:** `string`</span>
<span class="sd">        -- Types of QFI (QFIM) can be set as the objective function. Options are:  </span>
<span class="sd">        &quot;SLD&quot; (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).  </span>
<span class="sd">        &quot;RLD&quot; -- QFI (QFIM) based on right logarithmic derivative (RLD).  </span>
<span class="sd">        &quot;LLD&quot; -- QFI (QFIM) based on left logarithmic derivative (LLD).</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **QVTB:** `float or matrix`</span>
<span class="sd">        -- For single parameter estimation (the length of x is equal to one), the </span>
<span class="sd">        output is a float and for multiparameter estimation (the length of x is </span>
<span class="sd">        more than one), it returns a matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="n">F</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">dp_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span><span class="p">,</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[],</span>
            <span class="p">[],</span>
            <span class="p">[],</span>
            <span class="p">[],</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">dp_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">dp_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">dp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dp_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">I_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
            <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                    <span class="n">I_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pj</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
                        <span class="p">)</span>

        <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="n">I_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">I_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">I_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">arr1</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">I_ij</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">arr1</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span> <span class="o">+</span> <span class="n">I_res</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><hr />
<h2 id="quantum-ziv-zakai-bound"><strong>Quantum Ziv-Zakai bound</strong><a class="headerlink" href="#quantum-ziv-zakai-bound" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<a id="quanestimation.QZZB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the quantum Ziv-Zakai bound (QZZB). The expression of QZZB with a 
prior distribution p(x) in a finite regime <span class="arithmatex">\([\alpha,\beta]\)</span> is</p>
<div class="arithmatex">\[\begin{eqnarray}
\mathrm{var}(\hat{x},\{\Pi_y\}) &amp;\geq &amp; \frac{1}{2}\int_0^\infty \mathrm{d}\tau\tau
\mathcal{V}\int_{-\infty}^{\infty} \mathrm{d}x\min\!\left\{p(x), p(x+\tau)\right\} \nonumber \\
&amp; &amp; \times\left(1-\frac{1}{2}||\rho(x)-\rho(x+\tau)||\right),
\end{eqnarray}\]</div>
<p>where <span class="arithmatex">\(||\cdot||\)</span> represents the trace norm and <span class="arithmatex">\(\mathcal{V}\)</span> is the "valley-filling" 
operator satisfying <span class="arithmatex">\(\mathcal{V}f(\tau)=\max_{h\geq 0}f(\tau+h)\)</span>. <span class="arithmatex">\(\rho(x)\)</span> is the 
parameterized density matrix. </p>
<h3 id="quanestimation.QZZB--parameters">Parameters<a class="headerlink" href="#quanestimation.QZZB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.QZZB--returns">Returns<a class="headerlink" href="#quanestimation.QZZB--returns" title="Permanent link">&para;</a></h3>
<p><strong>QZZB:</strong> <code>float</code>
    -- Quantum Ziv-Zakai bound (QZZB).</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/ZivZakai.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">QZZB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the quantum Ziv-Zakai bound (QZZB). The expression of QZZB with a </span>
<span class="sd">    prior distribution p(x) in a finite regime $[\alpha,\beta]$ is</span>

<span class="sd">    \begin{eqnarray}</span>
<span class="sd">    \mathrm{var}(\hat{x},\{\Pi_y\}) &amp;\geq &amp; \frac{1}{2}\int_0^\infty \mathrm{d}\tau\tau</span>
<span class="sd">    \mathcal{V}\int_{-\infty}^{\infty} \mathrm{d}x\min\!\left\{p(x), p(x+\tau)\right\} \nonumber \\</span>
<span class="sd">    &amp; &amp; \times\left(1-\frac{1}{2}||\rho(x)-\rho(x+\tau)||\right),</span>
<span class="sd">    \end{eqnarray}</span>

<span class="sd">    where $||\cdot||$ represents the trace norm and $\mathcal{V}$ is the &quot;valley-filling&quot; </span>
<span class="sd">    operator satisfying $\mathcal{V}f(\tau)=\max_{h\geq 0}f(\tau+h)$. $\rho(x)$ is the </span>
<span class="sd">    parameterized density matrix. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **QZZB:** `float`</span>
<span class="sd">        -- Quantum Ziv-Zakai bound (QZZB).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="p">[</span><span class="n">xi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">f_tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">helstrom_dm</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">],</span> <span class="n">eps</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">f_tp</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">p_num</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">f_tau</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_tp</span>
    <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">tau</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">f_tau</span><span class="p">[</span><span class="n">m</span><span class="p">:])</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">I</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><hr />
<h2 id="bayesian-estimation"><strong>Bayesian estimation</strong><a class="headerlink" href="#bayesian-estimation" title="Permanent link">&para;</a></h2>
<!-- ### **Maximum a posteriori probability (MAP)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.Bayes"></a>
  <div class="doc doc-contents first">
  
      <p>Bayesian estimation. The prior distribution is updated via the posterior<br />
distribution obtained by the Bayes’ rule and the estimated value of parameters
are updated via the expectation value of the distribution or maximum a 
posteriori probability (MAP).</p>
<h3 id="quanestimation.Bayes--parameters">Parameters<a class="headerlink" href="#quanestimation.Bayes--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>y:</strong> <code>array</code>
    -- The experimental results obtained in practice.</p>
<p><strong>M:</strong> <code>list of matrices</code>
    -- A set of positive operator-valued measure (POVM). The default measurement 
    is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
<p><strong>estimator:</strong> <code>string</code>
    -- Estimators for the bayesian estimation. Options are:<br />
    "mean" -- The expectation value of the distribution.<br />
    "MAP" -- Maximum a posteriori probability.</p>
<p><strong>savefile:</strong> <code>bool</code>
    -- Whether or not to save all the posterior distributions.<br />
    If set <code>True</code> then two files "pout.npy" and "xout.npy" will be generated including
    the posterior distributions and the estimated values in the iterations. If set 
    <code>False</code> the posterior distribution in the final iteration and the estimated values
    in all iterations will be saved in "pout.npy" and "xout.npy". </p>
</blockquote>
<h3 id="quanestimation.Bayes--returns">Returns<a class="headerlink" href="#quanestimation.Bayes--returns" title="Permanent link">&para;</a></h3>
<p><strong>pout and xout:</strong> <code>array and float</code>
    -- The posterior distribution and the estimated values in the final iteration.</p>
<p><strong>Note:</strong> 
    SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
    which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/
    solutions.html">here</a>.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Bayes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">estimator</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian estimation. The prior distribution is updated via the posterior  </span>
<span class="sd">    distribution obtained by the Bayes’ rule and the estimated value of parameters</span>
<span class="sd">    are updated via the expectation value of the distribution or maximum a </span>
<span class="sd">    posteriori probability (MAP).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **y:** `array`</span>
<span class="sd">        -- The experimental results obtained in practice.</span>

<span class="sd">    &gt; **M:** `list of matrices`</span>
<span class="sd">        -- A set of positive operator-valued measure (POVM). The default measurement </span>
<span class="sd">        is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>

<span class="sd">    &gt; **estimator:** `string`</span>
<span class="sd">        -- Estimators for the bayesian estimation. Options are:  </span>
<span class="sd">        &quot;mean&quot; -- The expectation value of the distribution.  </span>
<span class="sd">        &quot;MAP&quot; -- Maximum a posteriori probability.</span>

<span class="sd">    &gt; **savefile:** `bool`</span>
<span class="sd">        -- Whether or not to save all the posterior distributions.  </span>
<span class="sd">        If set `True` then two files &quot;pout.npy&quot; and &quot;xout.npy&quot; will be generated including</span>
<span class="sd">        the posterior distributions and the estimated values in the iterations. If set </span>
<span class="sd">        `False` the posterior distribution in the final iteration and the estimated values</span>
<span class="sd">        in all iterations will be saved in &quot;pout.npy&quot; and &quot;xout.npy&quot;. </span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **pout and xout:** `array and float`</span>
<span class="sd">        -- The posterior distribution and the estimated values in the final iteration.</span>

<span class="sd">    **Note:** </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/</span>
<span class="sd">        solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">max_episode</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">savefile</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">pyx</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">pyx</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>
                    <span class="n">mean</span> <span class="o">=</span> <span class="n">simps</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;MAP&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">pyx</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">pyx</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>
                    <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">indx</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for estimator, supported values are &#39;mean&#39; and &#39;MAP&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">estimator</span><span class="p">))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pout&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p_out</span><span class="p">,</span> <span class="n">x_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">pyx</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">pyx</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>
                    <span class="n">mean</span> <span class="o">=</span> <span class="n">simps</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;MAP&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">pyx</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">pyx</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>
                    <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">indx</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for estimator, supported values are &#39;mean&#39; and &#39;MAP&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">estimator</span><span class="p">))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pout&quot;</span><span class="p">,</span> <span class="n">p_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">savefile</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">pyx_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>

                    <span class="n">mean</span> <span class="o">=</span> <span class="n">integ</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;MAP&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">pyx_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>

                    <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for estimator, supported values are &#39;mean&#39; and &#39;MAP&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">estimator</span><span class="p">))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p_out</span><span class="p">,</span> <span class="n">x_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">pyx_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>

                    <span class="n">mean</span> <span class="o">=</span> <span class="n">integ</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
                    <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;MAP&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                    <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                    <span class="n">pyx_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                        <span class="n">pyx_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>
                    <span class="n">pyx</span> <span class="o">=</span> <span class="n">pyx_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">py</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">p_update</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span> <span class="o">/</span> <span class="n">py</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span>

                    <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
                    <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for estimator, supported values are &#39;mean&#39; and &#39;MAP&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">estimator</span><span class="p">))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pout&quot;</span><span class="p">,</span> <span class="n">p_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Maximum likelihood estimation (MLE)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.MLE"></a>
  <div class="doc doc-contents first">
  
      <p>Bayesian estimation. The estimated value of parameters obtained via the 
maximum likelihood estimation (MLE).</p>
<h3 id="quanestimation.MLE--parameters">Parameters<a class="headerlink" href="#quanestimation.MLE--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>y:</strong> <code>array</code>
    -- The experimental results obtained in practice.</p>
<p><strong>M:</strong> <code>list of matrices</code>
    -- A set of positive operator-valued measure (POVM). The default measurement 
    is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
<p><strong>savefile:</strong> <code>bool</code>
    -- Whether or not to save all the likelihood functions.<br />
    If set <code>True</code> then two files "Lout.npy" and "xout.npy" will be generated including
    the likelihood functions and the estimated values in the iterations. If set 
    <code>False</code> the likelihood function in the final iteration and the estimated values
    in all iterations will be saved in "Lout.npy" and "xout.npy". </p>
</blockquote>
<h3 id="quanestimation.MLE--returns">Returns<a class="headerlink" href="#quanestimation.MLE--returns" title="Permanent link">&para;</a></h3>
<p><strong>Lout and xout:</strong> <code>array and float</code>
    -- The likelihood function and the estimated values in the final iteration.</p>
<p><strong>Note:</strong> 
    SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
    which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/
    solutions.html">here</a>.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">MLE</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian estimation. The estimated value of parameters obtained via the </span>
<span class="sd">    maximum likelihood estimation (MLE).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **y:** `array`</span>
<span class="sd">        -- The experimental results obtained in practice.</span>

<span class="sd">    &gt; **M:** `list of matrices`</span>
<span class="sd">        -- A set of positive operator-valued measure (POVM). The default measurement </span>
<span class="sd">        is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>

<span class="sd">    &gt; **savefile:** `bool`</span>
<span class="sd">        -- Whether or not to save all the likelihood functions.  </span>
<span class="sd">        If set `True` then two files &quot;Lout.npy&quot; and &quot;xout.npy&quot; will be generated including</span>
<span class="sd">        the likelihood functions and the estimated values in the iterations. If set </span>
<span class="sd">        `False` the likelihood function in the final iteration and the estimated values</span>
<span class="sd">        in all iterations will be saved in &quot;Lout.npy&quot; and &quot;xout.npy&quot;. </span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **Lout and xout:** `array and float`</span>
<span class="sd">        -- The likelihood function and the estimated values in the final iteration.</span>

<span class="sd">    **Note:** </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/</span>
<span class="sd">        solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">max_episode</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">savefile</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">L_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                    <span class="n">L_out</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_out</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_out</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">L_out</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">indx</span><span class="p">])</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">L_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                    <span class="n">L_tp</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_tp</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_tp</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">L_tp</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">L_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L_tp</span><span class="p">)</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">indx</span><span class="p">])</span>

            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">L_tp</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
            <span class="n">p_shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="n">rho_ext</span><span class="p">:</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">savefile</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">L_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">)):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                    <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">L_out</span> <span class="o">=</span> <span class="n">L_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_out</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">L_out</span><span class="p">))</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">L_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">)):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">])))</span>
                    <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">L_tp</span> <span class="o">=</span> <span class="n">L_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_tp</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">L_tp</span><span class="p">))</span>
                <span class="n">L_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L_tp</span><span class="p">)</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">L_tp</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Average Bayesian cost (BayesCost)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.BayesCost"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the average Bayesian cost with a quadratic cost function.</p>
<h3 id="quanestimation.BayesCost--parameters">Parameters<a class="headerlink" href="#quanestimation.BayesCost--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>xest:</strong> <code>list</code>
    -- The estimators.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>M:</strong> <code>array</code>
    -- A set of POVM.</p>
<p><strong>W:</strong> <code>array</code>
    -- Weight matrix.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.BayesCost--returns">Returns<a class="headerlink" href="#quanestimation.BayesCost--returns" title="Permanent link">&para;</a></h3>
<p><strong>The average Bayesian cost:</strong> <code>float</code>
    -- The average Bayesian cost.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BayesCost</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">xest</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the average Bayesian cost with a quadratic cost function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **xest:** `list`</span>
<span class="sd">        -- The estimators.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **M:** `array`</span>
<span class="sd">        -- A set of POVM.</span>

<span class="sd">    &gt; **W:** `array`</span>
<span class="sd">        -- Weight matrix.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **The average Bayesian cost:** `float`</span>
<span class="sd">        -- The average Bayesian cost.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># single-parameter scenario</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">mi</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xest</span><span class="p">[</span><span class="n">mi</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">))])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># multi-parameter scenario</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">x_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x_ele</span> <span class="ow">in</span> <span class="n">x_pro</span><span class="p">:</span>
            <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">W</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">x_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">xCx</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)):</span>
                <span class="n">xCx</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">mi</span><span class="p">]))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">x_tp</span><span class="o">-</span><span class="n">xest</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="p">(</span><span class="n">x_tp</span><span class="o">-</span><span class="n">xest</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">xCx</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **Bayesian cost bound(BCB)** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.BCB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian cost bound with a quadratic cost function.</p>
<h3 id="quanestimation.BCB--parameters">Parameters<a class="headerlink" href="#quanestimation.BCB--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>p:</strong> <code>multidimensional array</code>
    -- The prior distribution.</p>
<p><strong>rho:</strong> <code>multidimensional list</code>
    -- Parameterized density matrix.</p>
<p><strong>W:</strong> <code>array</code>
    -- Weight matrix.</p>
<p><strong>eps:</strong> <code>float</code>
    -- Machine epsilon.</p>
</blockquote>
<h3 id="quanestimation.BCB--returns">Returns<a class="headerlink" href="#quanestimation.BCB--returns" title="Permanent link">&para;</a></h3>
<p><strong>BCB:</strong> <code>float</code>
    -- The value of the minimum Bayesian cost.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BCB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian cost bound with a quadratic cost function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **p:** `multidimensional array`</span>
<span class="sd">        -- The prior distribution.</span>

<span class="sd">    &gt; **rho:** `multidimensional list`</span>
<span class="sd">        -- Parameterized density matrix.</span>

<span class="sd">    &gt; **W:** `array`</span>
<span class="sd">        -- Weight matrix.</span>

<span class="sd">    &gt; **eps:** `float`</span>
<span class="sd">        -- Machine epsilon.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    **BCB:** `float`</span>
<span class="sd">        -- The value of the minimum Bayesian cost.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># single-parameter scenario</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">delta2_x</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rho_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="n">rho_pri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">dj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
                <span class="n">rho_avg_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                <span class="n">rho_pri_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">rho</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                <span class="n">rho_avg</span><span class="p">[</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">rho_avg_arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">rho_pri</span><span class="p">[</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">rho_pri_arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="n">Lambda_avg</span><span class="p">(</span><span class="n">rho_avg</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_pri</span><span class="p">],</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">minBC</span> <span class="o">=</span> <span class="n">delta2_x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_avg</span><span class="p">,</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="k">return</span> <span class="n">minBC</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># multi-parameter scenario</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)</span>

        <span class="n">x_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x_ele</span> <span class="ow">in</span> <span class="n">x_pro</span><span class="p">:</span>
            <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">W</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">x_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">xCx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_tp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x_tp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">xCx</span>
        <span class="n">delta2_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
            <span class="n">delta2_x</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">delta2_x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
        <span class="n">rho_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="n">rho_pri</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">dj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
                <span class="n">rho_avg_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_list</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">rho_list</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                <span class="n">rho_avg_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho_avg_arr</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">rho_avg_tp</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">rho_avg_tp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">rho_avg</span><span class="p">[</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_avg_tp</span>

                <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">rho_pri_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_list</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">x_list</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span><span class="o">*</span><span class="n">rho_list</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                    <span class="n">rho_pri_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho_pri_arr</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">rho_pri_tp</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">rho_pri_tp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>

                    <span class="n">rho_pri</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_pri_tp</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="n">Lambda_avg</span><span class="p">(</span><span class="n">rho_avg</span><span class="p">,</span> <span class="n">rho_pri</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">Mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">para_m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">Mat</span> <span class="o">+=</span> <span class="n">W</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="n">para_m</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">para_n</span><span class="p">])</span>

        <span class="n">minBC</span> <span class="o">=</span> <span class="n">delta2_x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho_avg</span><span class="p">,</span> <span class="n">Mat</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">minBC</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><hr />
<h2 id="common"><strong>Common</strong><a class="headerlink" href="#common" title="Permanent link">&para;</a></h2>
<!-- ### **Bayes input** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.BayesInput"></a>
  <div class="doc doc-contents first">
  
      <p>Generation of the input variables H, dH (or K, dK).</p>
<h3 id="quanestimation.BayesInput--parameters">Parameters<a class="headerlink" href="#quanestimation.BayesInput--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>x:</strong> <code>list</code>
    -- The regimes of the parameters for the integral.</p>
<p><strong>func:</strong> <code>list</code>
    -- Function defined by the users which returns H or K.</p>
<p><strong>dfunc:</strong> <code>list</code>
    -- Function defined by the users which returns dH or dK.</p>
<p><strong>channel:</strong> <code>string</code>
    -- Seeting the output of this function. Options are:<br />
    "dynamics" (default) --  The output of this function is H and dH.<br />
    "Kraus" (default) --  The output of this function is K and dHK.</p>
</blockquote>
<h3 id="quanestimation.BayesInput--returns">Returns<a class="headerlink" href="#quanestimation.BayesInput--returns" title="Permanent link">&para;</a></h3>
<p>H, dH (or K, dK).</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/Common/Common.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">BayesInput</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">dfunc</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&quot;dynamics&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generation of the input variables H, dH (or K, dK).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **x:** `list`</span>
<span class="sd">        -- The regimes of the parameters for the integral.</span>

<span class="sd">    &gt; **func:** `list`</span>
<span class="sd">        -- Function defined by the users which returns H or K.</span>

<span class="sd">    &gt; **dfunc:** `list`</span>
<span class="sd">        -- Function defined by the users which returns dH or dK.</span>

<span class="sd">    &gt; **channel:** `string`</span>
<span class="sd">        -- Seeting the output of this function. Options are:  </span>
<span class="sd">        &quot;dynamics&quot; (default) --  The output of this function is H and dH.  </span>
<span class="sd">        &quot;Kraus&quot; (default) --  The output of this function is K and dHK.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    H, dH (or K, dK).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
    <span class="n">x_all</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="s2">&quot;dynamics&quot;</span><span class="p">:</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">([</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]))</span>
        <span class="n">H_list</span><span class="p">,</span> <span class="n">dH_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_all</span><span class="p">:</span>
            <span class="n">H_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]))</span>
            <span class="n">dH_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfunc</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]))</span>
        <span class="n">H_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">H_list</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">]])</span>
        <span class="n">dH_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dH_list</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">para_num</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">]])</span>
        <span class="k">return</span> <span class="n">H_res</span><span class="p">,</span> <span class="n">dH_res</span>
    <span class="k">elif</span> <span class="n">channel</span> <span class="o">==</span> <span class="s2">&quot;Kraus&quot;</span><span class="p">:</span>
        <span class="n">k_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">([</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]))</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">([</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">K_list</span><span class="p">,</span> <span class="n">dK_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_all</span><span class="p">:</span>
                <span class="n">K_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]))</span>
                <span class="n">dK_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfunc</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]))</span>
            <span class="n">K_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">K_list</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">k_num</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">]])</span>
            <span class="n">dK_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dK_list</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">para_num</span><span class="p">,</span> <span class="n">k_num</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_all</span><span class="p">:</span>
                <span class="n">K_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]))</span>
                <span class="n">dK_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfunc</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]))</span>
            <span class="n">K_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">K_list</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">k_num</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">]])</span>
            <span class="n">dK_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">dK_list</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="o">*</span><span class="p">[</span><span class="n">k_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">]])</span>
        <span class="k">return</span> <span class="n">K_res</span><span class="p">,</span> <span class="n">dK_res</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid value for channel, supported values are &#39;dynamics&#39; and &#39;Kraus&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">channel</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **SIC-POVM** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.SIC"></a>
  <div class="doc doc-contents first">
  
      <p>Generation of a set of rank-one symmetric informationally complete 
positive operator-valued measure (SIC-POVM).</p>
<h3 id="quanestimation.SIC--parameters">Parameters<a class="headerlink" href="#quanestimation.SIC--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>dim:</strong> <code>int</code> 
    -- The dimension of the system.</p>
</blockquote>
<h3 id="quanestimation.SIC--returns">Returns<a class="headerlink" href="#quanestimation.SIC--returns" title="Permanent link">&para;</a></h3>
<p>A set of SCI-POVM.</p>
<p><strong>Note:</strong> 
    SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
    which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/
    solutions.html">here</a>.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/Common/Common.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generation of a set of rank-one symmetric informationally complete </span>
<span class="sd">    positive operator-valued measure (SIC-POVM).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **dim:** `int` </span>
<span class="sd">        -- The dimension of the system.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    A set of SCI-POVM.</span>

<span class="sd">    **Note:** </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/</span>
<span class="sd">        solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;=</span> <span class="mi">151</span><span class="p">:</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span>
            <span class="s2">&quot;sic_fiducial_vectors/d</span><span class="si">%d</span><span class="s2">.txt&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dim</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">fiducial</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">j</span>
        <span class="n">fiducial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fiducial</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fiducial</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">fiducial</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">M</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The dimension of the space should be less or equal to 151.&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div><!-- ### **SU($N$) generators** -->


<div class="doc doc-object doc-function">


<a id="quanestimation.suN_generator"></a>
  <div class="doc doc-contents first">
  
      <p>Generation of the SU(<span class="arithmatex">\(N\)</span>) generators with <span class="arithmatex">\(N\)</span> the dimension of the system.</p>
<h3 id="quanestimation.suN_generator--parameters">Parameters<a class="headerlink" href="#quanestimation.suN_generator--parameters" title="Permanent link">&para;</a></h3>
<blockquote>
<p><strong>n:</strong> <code>int</code> 
    -- The dimension of the system.</p>
</blockquote>
<h3 id="quanestimation.suN_generator--returns">Returns<a class="headerlink" href="#quanestimation.suN_generator--returns" title="Permanent link">&para;</a></h3>
<p>SU(<span class="arithmatex">\(N\)</span>) generators.</p>

      <details class="quote">
        <summary>Source code in <code>quanestimation/Common/Common.py</code></summary>
        <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">suN_generator</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generation of the SU($N$) generators with $N$ the dimension of the system.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt; **n:** `int` </span>
<span class="sd">        -- The dimension of the system.</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    SU($N$) generators.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">symm</span><span class="p">,</span> <span class="n">anti_symm</span><span class="p">,</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">suN_unsorted</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">anti_symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symm</span> <span class="o">+</span> <span class="n">anti_symm</span> <span class="o">+</span> <span class="n">diag</span><span class="p">))]</span>

        <span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">anti_symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">repeat_times</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">k1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">m1</span> <span class="o">+=</span> <span class="n">n1</span>
            <span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repeat_times</span><span class="p">):</span>
                <span class="n">Lambda</span><span class="p">[</span><span class="n">m1</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">symm</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span>
                <span class="n">Lambda</span><span class="p">[</span><span class="n">m1</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">anti_symm</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="n">k1</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">repeat_times</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">k1</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">symm</span><span class="p">):</span>
                <span class="k">break</span>

        <span class="n">m2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">m2</span> <span class="o">+=</span> <span class="n">n2</span>
            <span class="n">Lambda</span><span class="p">[</span><span class="n">m2</span><span class="p">]</span> <span class="o">=</span> <span class="n">diag</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="n">k2</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">k2</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">diag</span><span class="p">):</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">Lambda</span>
</code></pre></div>
</td></tr></table>
      </details>
  </div>

</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../classes/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Classes" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Classes
            </div>
          </div>
        </a>
      
      
        
        <a href="../../julia/api/" class="md-footer__link md-footer__link--next" aria-label="Next: Julia" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Julia
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../../assets/javascripts/workers/search.709b4209.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.29db7785.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/mathjaxhelper.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>