
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docs of QuanEstimation">
      
      
        <meta name="author" content="QuanEstimation">
      
      
        <link rel="canonical" href="https://quanestimation.github.io/QuanEstimation/API/python/functions/">
      
      
        <link rel="prev" href="../classes/">
      
      
        <link rel="next" href="../../julia/api/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Functions - QuanEstimation Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/style.css">
    
      <link rel="stylesheet" href="../../../css/material.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
      <link rel="stylesheet" href="../../../css/julia_api.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="QuanEstimation Docs" class="md-header__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.92 7.92 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.92 7.92 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.92 7.92 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.92 7.92 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69zM12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuanEstimation Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../guide/guide_import/" class="md-tabs__link">
          
  
  
  Users Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../classes/" class="md-tabs__link">
          
  
  
  API documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../citing/" class="md-tabs__link">
        
  
  
    
  
  Citing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../developers/" class="md-tabs__link">
        
  
  
    
  
  Developers

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="QuanEstimation Docs" class="md-nav__button md-logo" aria-label="QuanEstimation Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.41 3 3 4.41 5.69 7.1A7.92 7.92 0 0 0 4 12c0 1.85.63 3.55 1.69 4.9L3 19.59 4.41 21l2.69-2.69A7.92 7.92 0 0 0 12 20c1.85 0 3.55-.63 4.9-1.69L19.59 21 21 19.59l-2.69-2.69A7.92 7.92 0 0 0 20 12c0-1.85-.63-3.55-1.69-4.9L21 4.41 19.59 3 16.9 5.69A7.92 7.92 0 0 0 12 4c-1.85 0-3.55.63-4.9 1.69zM12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"/></svg>

    </a>
    QuanEstimation Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/QuanEstimation/QuanEstimation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Users Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Users Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameterization process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_bounds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum metrological tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrological resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Copt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Sopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Mopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Measurement optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_Compopt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comprehensive optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/guide_adaptive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adaptive measurement schemes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guide/output_files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Output files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kraus" class="md-nav__link">
    <span class="md-ellipsis">
      Kraus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Kraus" class="md-nav__link">
    <span class="md-ellipsis">
      Kraus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrological-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Metrological resources
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metrological resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spin-squeezing" class="md-nav__link">
    <span class="md-ellipsis">
      Spin squeezing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing" class="md-nav__link">
    <span class="md-ellipsis">
      SpinSqueezing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpinSqueezing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-time" class="md-nav__link">
    <span class="md-ellipsis">
      Target time
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.TargetTime" class="md-nav__link">
    <span class="md-ellipsis">
      TargetTime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Cramér-Rao bounds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quantum Cramér-Rao bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classical-fisher-information-matrix-cfim" class="md-nav__link">
    <span class="md-ellipsis">
      Classical Fisher information matrix (CFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.CFIM" class="md-nav__link">
    <span class="md-ellipsis">
      CFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fisher-information-matrix-fim" class="md-nav__link">
    <span class="md-ellipsis">
      Fisher information matrix (FIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.FIM" class="md-nav__link">
    <span class="md-ellipsis">
      FIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fisher-information-fi_expt" class="md-nav__link">
    <span class="md-ellipsis">
      Fisher information (FI_Expt)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.FI_Expt" class="md-nav__link">
    <span class="md-ellipsis">
      FI_Expt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FI_Expt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#symmetric-logarithmic-derivative-sld" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric logarithmic derivative (SLD)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SLD" class="md-nav__link">
    <span class="md-ellipsis">
      SLD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#right-logarithmic-derivative-rld" class="md-nav__link">
    <span class="md-ellipsis">
      Right logarithmic derivative (RLD)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.RLD" class="md-nav__link">
    <span class="md-ellipsis">
      RLD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#left-logarithmic-derivative-lld" class="md-nav__link">
    <span class="md-ellipsis">
      Left logarithmic derivative (LLD)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.LLD" class="md-nav__link">
    <span class="md-ellipsis">
      LLD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-qfim" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix (QFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-with-kraus-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix with Kraus operators
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM_Kraus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFIM_Kraus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-in-bloch-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix in Bloch representation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM_Bloch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFIM_Bloch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-with-gaussian-states" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix with Gaussian states
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM_Gauss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holevo-cramer-rao-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Holevo Cramér-Rao bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.HCRB" class="md-nav__link">
    <span class="md-ellipsis">
      HCRB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nagaoka-hayashi-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Nagaoka-Hayashi bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.NHB" class="md-nav__link">
    <span class="md-ellipsis">
      NHB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian Cramér-Rao bounds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayesian Cramér-Rao bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-classical-fisher-information-matrix-bcfim" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian classical Fisher information matrix (BCFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCFIM" class="md-nav__link">
    <span class="md-ellipsis">
      BCFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BCFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-quantum-fisher-information-matrix-bqfim" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian quantum Fisher information matrix (BQFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQFIM" class="md-nav__link">
    <span class="md-ellipsis">
      BQFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BQFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bound-bcrb" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian Cramér-Rao bound (BCRB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCRB" class="md-nav__link">
    <span class="md-ellipsis">
      BCRB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-quantum-cramer-rao-bound-bqcrb" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian quantum Cramér-Rao bound (BQCRB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQCRB" class="md-nav__link">
    <span class="md-ellipsis">
      BQCRB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BQCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimal-biased-bound-obb" class="md-nav__link">
    <span class="md-ellipsis">
      Optimal biased bound (OBB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.OBB" class="md-nav__link">
    <span class="md-ellipsis">
      OBB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OBB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#van-trees-bound-vtb" class="md-nav__link">
    <span class="md-ellipsis">
      Van Trees bound (VTB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.VTB" class="md-nav__link">
    <span class="md-ellipsis">
      VTB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VTB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-van-trees-bound-qvtb" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Van Trees bound (QVTB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QVTB" class="md-nav__link">
    <span class="md-ellipsis">
      QVTB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-ziv-zakai-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Ziv-Zakai bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QZZB" class="md-nav__link">
    <span class="md-ellipsis">
      QZZB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian estimation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayesian estimation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maximum-a-posteriori-probability-map" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum a posteriori probability (MAP)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Bayes" class="md-nav__link">
    <span class="md-ellipsis">
      Bayes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maximum-likelihood-estimation-mle" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum likelihood estimation (MLE)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.MLE" class="md-nav__link">
    <span class="md-ellipsis">
      MLE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#average-bayesian-cost-bayescost" class="md-nav__link">
    <span class="md-ellipsis">
      Average Bayesian cost (BayesCost)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesCost" class="md-nav__link">
    <span class="md-ellipsis">
      BayesCost
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BayesCost">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-cost-bound-bcb" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian cost bound (BCB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCB" class="md-nav__link">
    <span class="md-ellipsis">
      BCB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      Common utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayes-input" class="md-nav__link">
    <span class="md-ellipsis">
      Bayes input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesInput" class="md-nav__link">
    <span class="md-ellipsis">
      BayesInput
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BayesInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sic-povm" class="md-nav__link">
    <span class="md-ellipsis">
      SIC-POVM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SIC" class="md-nav__link">
    <span class="md-ellipsis">
      SIC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SIC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sun-generators" class="md-nav__link">
    <span class="md-ellipsis">
      SU(\(N\)) generators
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.suN_generator" class="md-nav__link">
    <span class="md-ellipsis">
      suN_generator
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../julia/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Julia
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../citing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Citing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developers
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kraus" class="md-nav__link">
    <span class="md-ellipsis">
      Kraus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Kraus" class="md-nav__link">
    <span class="md-ellipsis">
      Kraus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrological-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Metrological resources
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metrological resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spin-squeezing" class="md-nav__link">
    <span class="md-ellipsis">
      Spin squeezing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SpinSqueezing" class="md-nav__link">
    <span class="md-ellipsis">
      SpinSqueezing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpinSqueezing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-time" class="md-nav__link">
    <span class="md-ellipsis">
      Target time
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.TargetTime" class="md-nav__link">
    <span class="md-ellipsis">
      TargetTime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Cramér-Rao bounds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quantum Cramér-Rao bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classical-fisher-information-matrix-cfim" class="md-nav__link">
    <span class="md-ellipsis">
      Classical Fisher information matrix (CFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.CFIM" class="md-nav__link">
    <span class="md-ellipsis">
      CFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fisher-information-matrix-fim" class="md-nav__link">
    <span class="md-ellipsis">
      Fisher information matrix (FIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.FIM" class="md-nav__link">
    <span class="md-ellipsis">
      FIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fisher-information-fi_expt" class="md-nav__link">
    <span class="md-ellipsis">
      Fisher information (FI_Expt)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.FI_Expt" class="md-nav__link">
    <span class="md-ellipsis">
      FI_Expt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FI_Expt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#symmetric-logarithmic-derivative-sld" class="md-nav__link">
    <span class="md-ellipsis">
      Symmetric logarithmic derivative (SLD)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SLD" class="md-nav__link">
    <span class="md-ellipsis">
      SLD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#right-logarithmic-derivative-rld" class="md-nav__link">
    <span class="md-ellipsis">
      Right logarithmic derivative (RLD)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.RLD" class="md-nav__link">
    <span class="md-ellipsis">
      RLD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#left-logarithmic-derivative-lld" class="md-nav__link">
    <span class="md-ellipsis">
      Left logarithmic derivative (LLD)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.LLD" class="md-nav__link">
    <span class="md-ellipsis">
      LLD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-qfim" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix (QFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-with-kraus-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix with Kraus operators
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Kraus" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM_Kraus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFIM_Kraus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-in-bloch-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix in Bloch representation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Bloch" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM_Bloch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFIM_Bloch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-fisher-information-matrix-with-gaussian-states" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Fisher information matrix with Gaussian states
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QFIM_Gauss" class="md-nav__link">
    <span class="md-ellipsis">
      QFIM_Gauss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holevo-cramer-rao-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Holevo Cramér-Rao bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.HCRB" class="md-nav__link">
    <span class="md-ellipsis">
      HCRB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nagaoka-hayashi-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Nagaoka-Hayashi bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.NHB" class="md-nav__link">
    <span class="md-ellipsis">
      NHB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bounds" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian Cramér-Rao bounds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayesian Cramér-Rao bounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-classical-fisher-information-matrix-bcfim" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian classical Fisher information matrix (BCFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCFIM" class="md-nav__link">
    <span class="md-ellipsis">
      BCFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BCFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-quantum-fisher-information-matrix-bqfim" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian quantum Fisher information matrix (BQFIM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQFIM" class="md-nav__link">
    <span class="md-ellipsis">
      BQFIM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BQFIM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-cramer-rao-bound-bcrb" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian Cramér-Rao bound (BCRB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCRB" class="md-nav__link">
    <span class="md-ellipsis">
      BCRB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-quantum-cramer-rao-bound-bqcrb" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian quantum Cramér-Rao bound (BQCRB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BQCRB" class="md-nav__link">
    <span class="md-ellipsis">
      BQCRB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BQCRB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimal-biased-bound-obb" class="md-nav__link">
    <span class="md-ellipsis">
      Optimal biased bound (OBB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.OBB" class="md-nav__link">
    <span class="md-ellipsis">
      OBB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OBB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#van-trees-bound-vtb" class="md-nav__link">
    <span class="md-ellipsis">
      Van Trees bound (VTB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.VTB" class="md-nav__link">
    <span class="md-ellipsis">
      VTB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VTB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantum-van-trees-bound-qvtb" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Van Trees bound (QVTB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QVTB" class="md-nav__link">
    <span class="md-ellipsis">
      QVTB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quantum-ziv-zakai-bound" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Ziv-Zakai bound
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.QZZB" class="md-nav__link">
    <span class="md-ellipsis">
      QZZB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-estimation" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian estimation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayesian estimation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maximum-a-posteriori-probability-map" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum a posteriori probability (MAP)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.Bayes" class="md-nav__link">
    <span class="md-ellipsis">
      Bayes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maximum-likelihood-estimation-mle" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum likelihood estimation (MLE)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.MLE" class="md-nav__link">
    <span class="md-ellipsis">
      MLE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#average-bayesian-cost-bayescost" class="md-nav__link">
    <span class="md-ellipsis">
      Average Bayesian cost (BayesCost)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesCost" class="md-nav__link">
    <span class="md-ellipsis">
      BayesCost
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BayesCost">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian-cost-bound-bcb" class="md-nav__link">
    <span class="md-ellipsis">
      Bayesian cost bound (BCB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BCB" class="md-nav__link">
    <span class="md-ellipsis">
      BCB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      Common utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayes-input" class="md-nav__link">
    <span class="md-ellipsis">
      Bayes input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.BayesInput" class="md-nav__link">
    <span class="md-ellipsis">
      BayesInput
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BayesInput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sic-povm" class="md-nav__link">
    <span class="md-ellipsis">
      SIC-POVM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.SIC" class="md-nav__link">
    <span class="md-ellipsis">
      SIC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SIC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sun-generators" class="md-nav__link">
    <span class="md-ellipsis">
      SU(\(N\)) generators
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quanestimation.suN_generator" class="md-nav__link">
    <span class="md-ellipsis">
      suN_generator
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="python-functions">Python Functions<a class="headerlink" href="#python-functions" title="Permanent link">&para;</a></h1>
<h2 id="kraus">Kraus<a class="headerlink" href="#kraus" title="Permanent link">&para;</a></h2>



<div class="doc doc-object doc-function">




<a id="quanestimation.Kraus"></a>
  <div class="doc doc-contents first">
  
      <p>Parameterization of a quantum state using Kraus operators.</p>
<p>The evolved density matrix <span class="arithmatex">\(\rho\)</span> is given by</p>
<div class="arithmatex">\[\begin{aligned}
    \rho=\sum_i K_i \rho_0 K_i^{\dagger},
\end{aligned}\]</div>
<p>where <span class="arithmatex">\(\rho_0\)</span> is the initial density matrix and <span class="arithmatex">\(K_i\)</span> are the Kraus operators.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho0</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>K</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kraus operators.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dK</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the Kraus operators with respect to the unknown parameters to be 
estimated. This is a nested list where the first index corresponds to the Kraus operator 
and the second index corresponds to the parameter. For example, <code>dK[0][1]</code> is the derivative 
of the second Kraus operator with respect to the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>rho (np.array): 
    Evolved density matrix.</p>
<p>drho (list): 
    Derivatives of the evolved density matrix with respect to the unknown parameters.<br />
    Each element in the list is a matrix representing the partial derivative of <span class="arithmatex">\(\rho\)</span> with 
    respect to one parameter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/Parameterization/NonDynamics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameterization of a quantum state using Kraus operators.</span>

<span class="sd">    The evolved density matrix $\rho$ is given by</span>

<span class="sd">    \begin{aligned}</span>
<span class="sd">        \rho=\sum_i K_i \rho_0 K_i^{\dagger},</span>
<span class="sd">    \end{aligned}</span>

<span class="sd">    where $\rho_0$ is the initial density matrix and $K_i$ are the Kraus operators.</span>

<span class="sd">    Args: </span>
<span class="sd">        rho0 (np.array): </span>
<span class="sd">            Initial density matrix.</span>
<span class="sd">        K (list): </span>
<span class="sd">            Kraus operators.</span>
<span class="sd">        dK (list): </span>
<span class="sd">            Derivatives of the Kraus operators with respect to the unknown parameters to be </span>
<span class="sd">            estimated. This is a nested list where the first index corresponds to the Kraus operator </span>
<span class="sd">            and the second index corresponds to the parameter. For example, `dK[0][1]` is the derivative </span>
<span class="sd">            of the second Kraus operator with respect to the first parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple):</span>
<span class="sd">            rho (np.array): </span>
<span class="sd">                Evolved density matrix.</span>

<span class="sd">            drho (list): </span>
<span class="sd">                Derivatives of the evolved density matrix with respect to the unknown parameters.  </span>
<span class="sd">                Each element in the list is a matrix representing the partial derivative of $\rho$ with </span>
<span class="sd">                respect to one parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">k_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dK</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">dK_reshape</span> <span class="o">=</span> <span class="p">[[</span><span class="n">dK</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_num</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>

    <span class="n">rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="k">for</span> <span class="n">Ki</span> <span class="ow">in</span> <span class="n">K</span><span class="p">])</span>
    <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">([(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dKi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">dKi</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)))</span> <span class="k">for</span> <span class="p">(</span><span class="n">Ki</span><span class="p">,</span> <span class="n">dKi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dKj</span><span class="p">)])</span> <span class="k">for</span> <span class="n">dKj</span> <span class="ow">in</span> <span class="n">dK_reshape</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="metrological-resources">Metrological resources<a class="headerlink" href="#metrological-resources" title="Permanent link">&para;</a></h2>
<h3 id="spin-squeezing">Spin squeezing<a class="headerlink" href="#spin-squeezing" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.SpinSqueezing"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the spin squeezing parameter for a density matrix.</p>
<p>The spin squeezing parameter <span class="arithmatex">\(\xi\)</span> given by Kitagawa and Ueda is defined as:</p>
<div class="arithmatex">\[
\xi^2 = \frac{N(\Delta J_{\vec{n}_1})^2}{\langle J_{\vec{n}_3}\rangle^2}
\]</div>
<p>where <span class="arithmatex">\(J_{\vec{n}_i}\)</span> are the collective spin operators.</p>
<p>The spin squeezing parameter <span class="arithmatex">\(\xi\)</span> given by Wineland etal. is defined as:</p>
<div class="arithmatex">\[
\xi^2 = \left(\frac{j}{\langle \vec{J}\rangle}\right)^2 \frac{N(\Delta J_{\vec{n}_1})^2}{\langle J_{\vec{n}_3}\rangle^2}
\]</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>basis</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Basis to use: "Dicke" (default) or "Pauli".</p>
            </div>
          </td>
          <td>
                <code>&#39;Dicke&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>output</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of spin squeezing to calculate:<br />
    - "KU": Kitagawa-Ueda squeezing parameter.<br />
    - "WBIMH": Wineland et al. squeezing parameter.  </p>
            </div>
          </td>
          <td>
                <code>&#39;KU&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spin squeezing parameter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>basis</code> has invalid value.  </p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>output</code> has invalid value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/Resource/Resource.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">SpinSqueezing</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;Dicke&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;KU&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the spin squeezing parameter for a density matrix.</span>

<span class="sd">    The spin squeezing parameter $\xi$ given by Kitagawa and Ueda is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">    \xi^2 = \frac{N(\Delta J_{\vec{n}_1})^2}{\langle J_{\vec{n}_3}\rangle^2}</span>
<span class="sd">    $$</span>

<span class="sd">    where $J_{\vec{n}_i}$ are the collective spin operators.</span>

<span class="sd">    The spin squeezing parameter $\xi$ given by Wineland etal. is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">    \xi^2 = \left(\frac{j}{\langle \vec{J}\rangle}\right)^2 \frac{N(\Delta J_{\vec{n}_1})^2}{\langle J_{\vec{n}_3}\rangle^2}</span>
<span class="sd">    $$</span>

<span class="sd">    Args:</span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.</span>
<span class="sd">        basis (str, optional): </span>
<span class="sd">            Basis to use: &quot;Dicke&quot; (default) or &quot;Pauli&quot;.</span>
<span class="sd">        output (str, optional): </span>
<span class="sd">            Type of spin squeezing to calculate:  </span>
<span class="sd">                - &quot;KU&quot;: Kitagawa-Ueda squeezing parameter.  </span>
<span class="sd">                - &quot;WBIMH&quot;: Wineland et al. squeezing parameter.  </span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): </span>
<span class="sd">            Spin squeezing parameter.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `basis` has invalid value.  </span>
<span class="sd">        ValueError: If `output` has invalid value.  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;Pauli&quot;</span><span class="p">:</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]])</span>
        <span class="n">jp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">jz</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">jp_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
                <span class="n">jz_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">jp_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">sp</span><span class="p">)</span>
                <span class="n">jz_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">sz</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">jp_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span> 
                    <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)))</span>
                <span class="p">)</span>
                <span class="n">jz_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">i</span><span class="p">),</span> 
                    <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)))</span>
                <span class="p">)</span>
            <span class="n">jp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jp_tp</span><span class="p">)</span>
            <span class="n">jz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jz_tp</span><span class="p">)</span>
        <span class="n">Jp</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">jp</span><span class="p">)</span>
        <span class="n">Jz</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">jz</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">basis</span> <span class="o">==</span> <span class="s2">&quot;Dicke&quot;</span><span class="p">:</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span> 
        <span class="n">coef</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>       
        <span class="n">offdiag</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> 
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c1"># Ensure we create a complex array</span>
        <span class="n">Jp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">offdiag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
        <span class="n">Jz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">valid_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Dicke&quot;</span><span class="p">,</span> <span class="s2">&quot;Pauli&quot;</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid basis: &#39;</span><span class="si">{</span><span class="n">basis</span><span class="si">}</span><span class="s2">&#39;. Supported types: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>    

    <span class="n">Jx</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jp</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">Jp</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">Jy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jp</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">Jp</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

    <span class="n">Jx_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">Jx</span><span class="p">)</span>
    <span class="n">Jy_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">Jy</span><span class="p">)</span>
    <span class="n">Jz_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">Jz</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Jx_mean</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">Jy_mean</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Jz_mean</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The density matrix does not have a valid spin squeezing.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="p">(</span><span class="n">Jx</span> <span class="o">@</span> <span class="n">Jx</span> <span class="o">-</span> <span class="n">Jy</span> <span class="o">@</span> <span class="n">Jy</span><span class="p">))</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="p">(</span><span class="n">Jx</span> <span class="o">@</span> <span class="n">Jy</span> <span class="o">+</span> <span class="n">Jy</span> <span class="o">@</span> <span class="n">Jx</span><span class="p">))</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="p">(</span><span class="n">Jx</span> <span class="o">@</span> <span class="n">Jx</span> <span class="o">+</span> <span class="n">Jy</span> <span class="o">@</span> <span class="n">Jy</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">costheta</span> <span class="o">=</span> <span class="n">Jz_mean</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Jx_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jy_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jz_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">sintheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">costheta</span><span class="p">))</span>
        <span class="n">cosphi</span> <span class="o">=</span> <span class="n">Jx_mean</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Jx_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jy_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">sinphi</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosphi</span><span class="p">))</span> <span class="k">if</span> <span class="n">Jy_mean</span> <span class="o">&gt;</span> <span class="mi">0</span> 
                  <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosphi</span><span class="p">)))</span>

        <span class="n">Jn1</span> <span class="o">=</span> <span class="o">-</span><span class="n">Jx</span> <span class="o">*</span> <span class="n">sinphi</span> <span class="o">+</span> <span class="n">Jy</span> <span class="o">*</span> <span class="n">cosphi</span>
        <span class="n">Jn2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">Jx</span> <span class="o">*</span> <span class="n">costheta</span> <span class="o">*</span> <span class="n">cosphi</span> 
                <span class="o">-</span> <span class="n">Jy</span> <span class="o">*</span> <span class="n">costheta</span> <span class="o">*</span> <span class="n">sinphi</span> 
                <span class="o">+</span> <span class="n">Jz</span> <span class="o">*</span> <span class="n">sintheta</span><span class="p">)</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="p">(</span><span class="n">Jn1</span> <span class="o">@</span> <span class="n">Jn1</span> <span class="o">-</span> <span class="n">Jn2</span> <span class="o">@</span> <span class="n">Jn2</span><span class="p">))</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="p">(</span><span class="n">Jn1</span> <span class="o">@</span> <span class="n">Jn2</span> <span class="o">+</span> <span class="n">Jn2</span> <span class="o">@</span> <span class="n">Jn1</span><span class="p">))</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="p">(</span><span class="n">Jn1</span> <span class="o">@</span> <span class="n">Jn1</span> <span class="o">+</span> <span class="n">Jn2</span> <span class="o">@</span> <span class="n">Jn2</span><span class="p">))</span>

    <span class="n">V_minus</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">V_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">V_minus</span><span class="p">)</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">coef</span> <span class="o">*</span> <span class="n">V_minus</span>

    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;KU&quot;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;WBIMH&quot;</span><span class="p">:</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">xi</span> <span class="o">/</span> <span class="p">(</span><span class="n">Jx_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jy_mean</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Jz_mean</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">valid_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;KU&quot;</span><span class="p">,</span> <span class="s2">&quot;WBIMH&quot;</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid basis: &#39;</span><span class="si">{</span><span class="n">basis</span><span class="si">}</span><span class="s2">&#39;. Supported types: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>  

    <span class="k">return</span> <span class="n">xi</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="target-time">Target time<a class="headerlink" href="#target-time" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.TargetTime"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the time to reach a given precision limit. </p>
<p>This function finds the earliest time <span class="arithmatex">\(t\)</span> in <code>tspan</code> where the objective 
function <code>func</code> reaches or crosses the target value <span class="arithmatex">\(f\)</span>. The first argument 
of func must be the time variable.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>f</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The target value of the objective function.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tspan</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time points for the evolution.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>callable</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The objective function to evaluate. Must return a float.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positional arguments to pass to <code>func</code>.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments to pass to <code>func</code>.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time to reach the given target precision.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/Resource/Resource.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">TargetTime</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the time to reach a given precision limit. </span>

<span class="sd">    This function finds the earliest time $t$ in `tspan` where the objective </span>
<span class="sd">    function `func` reaches or crosses the target value $f$. The first argument </span>
<span class="sd">    of func must be the time variable.</span>

<span class="sd">    Args:</span>
<span class="sd">        f (float): </span>
<span class="sd">            The target value of the objective function.</span>
<span class="sd">        tspan (array): </span>
<span class="sd">            Time points for the evolution.</span>
<span class="sd">        func (callable): </span>
<span class="sd">            The objective function to evaluate. Must return a float.</span>
<span class="sd">        *args (tuple): </span>
<span class="sd">            Positional arguments to pass to `func`.</span>
<span class="sd">        **kwargs (dict): </span>
<span class="sd">            Keyword arguments to pass to `func`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): </span>
<span class="sd">            Time to reach the given target precision.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if we&#39;re already at the target at the first point</span>
    <span class="n">f0</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Iterate through time points</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tspan</span><span class="p">)):</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">tspan</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Check if we&#39;ve crossed the target</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f0</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tspan</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">tspan</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">f0</span> <span class="o">=</span> <span class="n">f1</span>

    <span class="c1"># No crossing found</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No time is found in the given time span to reach the target.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="quantum-cramer-rao-bounds">Quantum Cramér-Rao bounds<a class="headerlink" href="#quantum-cramer-rao-bounds" title="Permanent link">&para;</a></h2>
<h3 id="classical-fisher-information-matrix-cfim">Classical Fisher information matrix (CFIM)<a class="headerlink" href="#classical-fisher-information-matrix-cfim" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.CFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the classical Fisher information matrix for the chosen measurements.</p>
<p>This function computes the classical Fisher information (CFI) and classical Fisher 
information matrix (CFIM) for a density matrix. The entry of CFIM <span class="arithmatex">\(\mathcal{I}\)</span>
is defined as</p>
<div class="arithmatex">\[
\mathcal{I}_{ab}=\sum_y\frac{1}{p(y|\textbf{x})}[\partial_a p(y|\textbf{x})][\partial_b p(y|\textbf{x})],
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(p(y|\textbf{x})=\mathrm{Tr}(\rho\Pi_y)\)</span>.</li>
<li><span class="arithmatex">\(\rho\)</span>: the parameterized density matrix.</li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of derivative matrices of the density matrix on the unknown 
parameters to be estimated. For example, drho[0] is the derivative 
matrix on the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>M</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of positive operator-valued measure (POVM). The default 
measurement is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon for numerical stability.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (the length of drho is equal to one), the output is CFI 
and for multiparameter estimation (the length of drho is more than one), it returns CFIM.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If drho is not a list.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If M is not a list.   </p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <p>rho = np.array([[0.5, 0], [0, 0.5]]);</p>
<p>drho = [np.array([[1, 0], [0, -1]])];</p>
<p>cfim = CFIM(rho, drho);     </p>
</details>
<details class="notes" open>
  <summary>Notes</summary>
  <p>SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
which can be downloaded from <a href="https://www.physics.umb.edu/Research/QBism/solutions.html">here</a>.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the classical Fisher information matrix for the chosen measurements.</span>

<span class="sd">    This function computes the classical Fisher information (CFI) and classical Fisher </span>
<span class="sd">    information matrix (CFIM) for a density matrix. The entry of CFIM $\mathcal{I}$</span>
<span class="sd">    is defined as</span>

<span class="sd">    $$</span>
<span class="sd">    \mathcal{I}_{ab}=\sum_y\frac{1}{p(y|\textbf{x})}[\partial_a p(y|\textbf{x})][\partial_b p(y|\textbf{x})],</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols: </span>
<span class="sd">        - $p(y|\textbf{x})=\mathrm{Tr}(\rho\Pi_y)$.</span>
<span class="sd">        - $\rho$: the parameterized density matrix.</span>

<span class="sd">    Args: </span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            List of derivative matrices of the density matrix on the unknown </span>
<span class="sd">            parameters to be estimated. For example, drho[0] is the derivative </span>
<span class="sd">            matrix on the first parameter.</span>
<span class="sd">        M (list, optional): </span>
<span class="sd">            List of positive operator-valued measure (POVM). The default </span>
<span class="sd">            measurement is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon for numerical stability.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (the length of drho is equal to one), the output is CFI </span>
<span class="sd">            and for multiparameter estimation (the length of drho is more than one), it returns CFIM.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If drho is not a list.</span>
<span class="sd">        TypeError: If M is not a list.   </span>

<span class="sd">    Example:</span>
<span class="sd">        rho = np.array([[0.5, 0], [0, 0.5]]);</span>

<span class="sd">        drho = [np.array([[1, 0], [0, -1]])];</span>

<span class="sd">        cfim = CFIM(rho, drho);     </span>

<span class="sd">    Notes: </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](https://www.physics.umb.edu/Research/QBism/solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure drho is a list!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">M</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

    <span class="n">num_measurements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">cfim_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_measurements</span><span class="p">):</span>
        <span class="n">povm_element</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">povm_element</span><span class="p">))</span>
        <span class="n">c_add</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">param_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
                <span class="n">drho_i</span> <span class="o">=</span> <span class="n">drho</span><span class="p">[</span><span class="n">param_i</span><span class="p">]</span>
                <span class="n">dp_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">drho_i</span> <span class="o">@</span> <span class="n">povm_element</span><span class="p">))</span>

                <span class="k">for</span> <span class="n">param_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                    <span class="n">drho_j</span> <span class="o">=</span> <span class="n">drho</span><span class="p">[</span><span class="n">param_j</span><span class="p">]</span>
                    <span class="n">dp_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">drho_j</span> <span class="o">@</span> <span class="n">povm_element</span><span class="p">))</span>
                    <span class="n">c_add</span><span class="p">[</span><span class="n">param_i</span><span class="p">][</span><span class="n">param_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp_i</span> <span class="o">*</span> <span class="n">dp_j</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span>
                    <span class="n">c_add</span><span class="p">[</span><span class="n">param_j</span><span class="p">][</span><span class="n">param_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp_i</span> <span class="o">*</span> <span class="n">dp_j</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span>

        <span class="n">cfim_res</span> <span class="o">+=</span> <span class="n">c_add</span>

    <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cfim_res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cfim_res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="fisher-information-matrix-fim">Fisher information matrix (FIM)<a class="headerlink" href="#fisher-information-matrix-fim" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.FIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the classical Fisher information matrix (CFIM) for a given probability distributions.</p>
<p>This function computes the classical Fisher information matrix (CFIM) for a given probability 
distributions. The entry of FIM <span class="arithmatex">\(I\)</span> is defined as</p>
<div class="arithmatex">\[
I_{ab}=\sum_{y}\frac{1}{p_y}[\partial_a p_y][\partial_b p_y],
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(\{p_y\}\)</span>: a set of the discrete probability distribution.</li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The probability distribution.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dp</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the probability distribution on the unknown parameters to 
be estimated. For example, dp[0] is the derivative vector on the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (the length of drho is equal to one), the output is CFI 
and for multiparameter estimation (the length of drho is more than one), it returns CFIM.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">FIM</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the classical Fisher information matrix (CFIM) for a given probability distributions.</span>

<span class="sd">    This function computes the classical Fisher information matrix (CFIM) for a given probability </span>
<span class="sd">    distributions. The entry of FIM $I$ is defined as</span>

<span class="sd">    $$</span>
<span class="sd">    I_{ab}=\sum_{y}\frac{1}{p_y}[\partial_a p_y][\partial_b p_y],</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols: </span>
<span class="sd">        - $\{p_y\}$: a set of the discrete probability distribution.</span>

<span class="sd">    Args: </span>
<span class="sd">        p (np.array): </span>
<span class="sd">            The probability distribution.</span>
<span class="sd">        dp (list): </span>
<span class="sd">            Derivatives of the probability distribution on the unknown parameters to </span>
<span class="sd">            be estimated. For example, dp[0] is the derivative vector on the first parameter.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (the length of drho is equal to one), the output is CFI </span>
<span class="sd">            and for multiparameter estimation (the length of drho is more than one), it returns CFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>
    <span class="n">num_measurements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">fim_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">outcome_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_measurements</span><span class="p">):</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">outcome_idx</span><span class="p">]</span>
        <span class="n">fim_add</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">p_value</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">param_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
                <span class="n">dp_i</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">param_i</span><span class="p">][</span><span class="n">outcome_idx</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">param_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                    <span class="n">dp_j</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">param_j</span><span class="p">][</span><span class="n">outcome_idx</span><span class="p">]</span>
                    <span class="n">term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp_i</span> <span class="o">*</span> <span class="n">dp_j</span> <span class="o">/</span> <span class="n">p_value</span><span class="p">)</span>
                    <span class="n">fim_add</span><span class="p">[</span><span class="n">param_i</span><span class="p">][</span><span class="n">param_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span>
                    <span class="n">fim_add</span><span class="p">[</span><span class="n">param_j</span><span class="p">][</span><span class="n">param_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span>

        <span class="n">fim_matrix</span> <span class="o">+=</span> <span class="n">fim_add</span>

    <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fim_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fim_matrix</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="fisher-information-fi_expt">Fisher information (FI_Expt)<a class="headerlink" href="#fisher-information-fi_expt" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.FI_Expt"></a>
  <div class="doc doc-contents first">
  
      <p>Calculate the classical Fisher information (CFI) based on experimental data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_true</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Experimental data obtained at the true parameter value.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_shifted</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Experimental data obtained at parameter value shifted by delta_x.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>delta_x</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Small known parameter shift.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ftype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability distribution of the data. Options:<br />
    - "norm": normal distribution (default).<br />
    - "gamma": gamma distribution.<br />
    - "rayleigh": Rayleigh distribution.<br />
    - "poisson": Poisson distribution.  </p>
            </div>
          </td>
          <td>
                <code>&#39;norm&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Classical Fisher information</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>ftype</code> is not one of the supported types ("norm", "poisson", "gamma", "rayleigh").    </p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The current implementation may be unstable and is subject to future modification.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">FI_Expt</span><span class="p">(</span><span class="n">data_true</span><span class="p">,</span> <span class="n">data_shifted</span><span class="p">,</span> <span class="n">delta_x</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the classical Fisher information (CFI) based on experimental data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_true (np.array): </span>
<span class="sd">            Experimental data obtained at the true parameter value.</span>
<span class="sd">        data_shifted (np.array): </span>
<span class="sd">            Experimental data obtained at parameter value shifted by delta_x.</span>
<span class="sd">        delta_x (float): </span>
<span class="sd">            Small known parameter shift.</span>
<span class="sd">        ftype (str, optional): </span>
<span class="sd">            Probability distribution of the data. Options:  </span>
<span class="sd">                - &quot;norm&quot;: normal distribution (default).  </span>
<span class="sd">                - &quot;gamma&quot;: gamma distribution.  </span>
<span class="sd">                - &quot;rayleigh&quot;: Rayleigh distribution.  </span>
<span class="sd">                - &quot;poisson&quot;: Poisson distribution.  </span>

<span class="sd">    Returns: </span>
<span class="sd">        (float): </span>
<span class="sd">            Classical Fisher information</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: </span>
<span class="sd">            If `ftype` is not one of the supported types (&quot;norm&quot;, &quot;poisson&quot;, &quot;gamma&quot;, &quot;rayleigh&quot;).    </span>

<span class="sd">    Notes:</span>
<span class="sd">        The current implementation may be unstable and is subject to future modification.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fidelity</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s2">&quot;norm&quot;</span><span class="p">:</span>
        <span class="n">mu_true</span><span class="p">,</span> <span class="n">std_true</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_true</span><span class="p">)</span>
        <span class="n">mu_shifted</span><span class="p">,</span> <span class="n">std_shifted</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_shifted</span><span class="p">)</span>
        <span class="n">f_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_true</span><span class="p">,</span> <span class="n">std_true</span><span class="p">)</span> <span class="o">*</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_shifted</span><span class="p">,</span> <span class="n">std_shifted</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fidelity</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f_function</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span>
        <span class="n">a_true</span><span class="p">,</span> <span class="n">alpha_true</span><span class="p">,</span> <span class="n">beta_true</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_true</span><span class="p">)</span>
        <span class="n">a_shifted</span><span class="p">,</span> <span class="n">alpha_shifted</span><span class="p">,</span> <span class="n">beta_shifted</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_shifted</span><span class="p">)</span>
        <span class="n">f_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a_true</span><span class="p">,</span> <span class="n">alpha_true</span><span class="p">,</span> <span class="n">beta_true</span><span class="p">)</span> <span class="o">*</span>
            <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a_shifted</span><span class="p">,</span> <span class="n">alpha_shifted</span><span class="p">,</span> <span class="n">beta_shifted</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fidelity</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f_function</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s2">&quot;rayleigh&quot;</span><span class="p">:</span>
        <span class="n">mean_true</span><span class="p">,</span> <span class="n">var_true</span> <span class="o">=</span> <span class="n">rayleigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_true</span><span class="p">)</span>
        <span class="n">mean_shifted</span><span class="p">,</span> <span class="n">var_shifted</span> <span class="o">=</span> <span class="n">rayleigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_shifted</span><span class="p">)</span>
        <span class="n">f_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="n">rayleigh</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean_true</span><span class="p">,</span> <span class="n">var_true</span><span class="p">)</span> <span class="o">*</span>
            <span class="n">rayleigh</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean_shifted</span><span class="p">,</span> <span class="n">var_shifted</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fidelity</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f_function</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">ftype</span> <span class="o">==</span> <span class="s2">&quot;poisson&quot;</span><span class="p">:</span>
        <span class="n">k_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">data_true</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">data_shifted</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">k_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">k_max</span><span class="p">)</span>
        <span class="n">p_true</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_true</span><span class="p">))</span>
        <span class="n">p_shifted</span> <span class="o">=</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_shifted</span><span class="p">))</span>
        <span class="n">p_true</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p_true</span><span class="p">)</span>
        <span class="n">p_shifted</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p_shifted</span><span class="p">)</span>
        <span class="n">fidelity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p_true</span> <span class="o">*</span> <span class="n">p_shifted</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">valid_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="s2">&quot;poisson&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;rayleigh&quot;</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid distribution type: &#39;</span><span class="si">{</span><span class="n">ftype</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Supported types are: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">fisher_information</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">fidelity</span><span class="p">)</span> <span class="o">/</span> <span class="n">delta_x</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">fisher_information</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="symmetric-logarithmic-derivative-sld">Symmetric logarithmic derivative (SLD)<a class="headerlink" href="#symmetric-logarithmic-derivative-sld" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.SLD"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the symmetric logarithmic derivative (SLD) for a density matrix.</p>
<p>This function computes the SLD operator <span class="arithmatex">\(L_a\)</span>, which is determined by</p>
<div class="arithmatex">\[
\partial_{a}\rho=\frac{1}{2}(\rho L_{a}+L_{a}\rho)
\]</div>
<p>with <span class="arithmatex">\(\rho\)</span> the parameterized density matrix. The entries of SLD can be calculated as </p>
<div class="arithmatex">\[
\langle\lambda_i|L_{a}|\lambda_j\rangle=\frac{2\langle\lambda_i| \partial_{a}\rho |\lambda_j\rangle}{\lambda_i+\lambda_j
\]</div>
<p>for <span class="arithmatex">\(\lambda_i~(\lambda_j) \neq 0\)</span>. If <span class="arithmatex">\(\lambda_i=\lambda_j=0\)</span>, the entry of SLD is set to be zero.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrix on the unknown parameters to be 
estimated. For example, drho[0] is the derivative vector on the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rep</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The basis for the SLDs. Options:<br />
    - "original" (default): basis same as input density matrix<br />
    - "eigen": basis same as eigenspace of density matrix</p>
            </div>
          </td>
          <td>
                <code>&#39;original&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.array">array</span> / list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (i.e., length of <code>drho</code> equals 1), returns a matrix.<br />
For multiparameter estimation (i.e., length of <code>drho</code> is larger than 1), returns a list of matrices.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>drho</code> is not a list.  </p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>rep</code> has invalid value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the symmetric logarithmic derivative (SLD) for a density matrix.</span>

<span class="sd">    This function computes the SLD operator $L_a$, which is determined by</span>

<span class="sd">    $$</span>
<span class="sd">    \partial_{a}\rho=\frac{1}{2}(\rho L_{a}+L_{a}\rho)</span>
<span class="sd">    $$</span>

<span class="sd">    with $\rho$ the parameterized density matrix. The entries of SLD can be calculated as </span>

<span class="sd">    $$</span>
<span class="sd">    \langle\lambda_i|L_{a}|\lambda_j\rangle=\frac{2\langle\lambda_i| \partial_{a}\rho |\lambda_j\rangle}{\lambda_i+\lambda_j</span>
<span class="sd">    $$</span>

<span class="sd">    for $\lambda_i~(\lambda_j) \neq 0$. If $\lambda_i=\lambda_j=0$, the entry of SLD is set to be zero.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">            estimated. For example, drho[0] is the derivative vector on the first parameter.</span>
<span class="sd">        rep (str, optional): </span>
<span class="sd">            The basis for the SLDs. Options:  </span>
<span class="sd">                - &quot;original&quot; (default): basis same as input density matrix  </span>
<span class="sd">                - &quot;eigen&quot;: basis same as eigenspace of density matrix</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.array/list): </span>
<span class="sd">            For single parameter estimation (i.e., length of `drho` equals 1), returns a matrix.  </span>
<span class="sd">            For multiparameter estimation (i.e., length of `drho` is larger than 1), returns a list of matrices.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `drho` is not a list.  </span>
<span class="sd">        ValueError: If `rep` has invalid value. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;drho must be a list of derivative matrices&quot;</span><span class="p">)</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">slds</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_params</span>

    <span class="n">purity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">rho</span><span class="p">)</span>

    <span class="c1"># Handle pure state case</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">purity</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
        <span class="n">sld_original</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">drho</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
                <span class="n">slds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sld_original</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
                <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
                <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
                <span class="n">slds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">sld_original</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">eigenvectors</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">valid_reps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;eigen&quot;</span><span class="p">]</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid rep value: &#39;</span><span class="si">{</span><span class="n">rep</span><span class="si">}</span><span class="s2">&#39;. Valid options: </span><span class="si">{</span><span class="n">valid_reps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">slds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">slds</span>

    <span class="c1"># Handle mixed state case</span>
    <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">param_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="n">sld_eigenbasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                    <span class="c1"># Calculate matrix element in eigenbasis</span>
                    <span class="n">numerator</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">eigenvectors</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">drho</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span>
                    <span class="n">sld_eigenbasis</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

        <span class="c1"># Handle any potential infinities</span>
        <span class="n">sld_eigenbasis</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">sld_eigenbasis</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Transform to requested basis</span>
        <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
            <span class="n">slds</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigenvectors</span> <span class="o">@</span> <span class="n">sld_eigenbasis</span> <span class="o">@</span> <span class="n">eigenvectors</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
            <span class="n">slds</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">sld_eigenbasis</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valid_reps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;eigen&quot;</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid rep value: &#39;</span><span class="si">{</span><span class="n">rep</span><span class="si">}</span><span class="s2">&#39;. Valid options: </span><span class="si">{</span><span class="n">valid_reps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">slds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">slds</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="right-logarithmic-derivative-rld">Right logarithmic derivative (RLD)<a class="headerlink" href="#right-logarithmic-derivative-rld" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.RLD"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the right logarithmic derivative (RLD) for a density matrix.
The RLD operator <span class="arithmatex">\(\mathcal{R}_a\)</span> is defined by</p>
<div class="arithmatex">\[
\partial_{a}\rho=\rho \mathcal{R}_a
\]</div>
<p>with <span class="arithmatex">\(\rho\)</span> the parameterized density matrix. The entries of RLD can be calculated as </p>
<div class="arithmatex">\[
\langle\lambda_i| \mathcal{R}_{a} |\lambda_j\rangle=\frac{1}{\lambda_i}\langle\lambda_i| 
\partial_a\rho |\lambda_j\rangle 
\]</div>
<p>for <span class="arithmatex">\(\lambda_i\neq 0\)</span>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.  </p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrix on the unknown parameters to be 
estimated. For example, drho[0] is the derivative vector on the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rep</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The basis for the RLD(s). Options:<br />
    - "original" (default): basis same as input density matrix.<br />
    - "eigen": basis same as eigenspace of density matrix.</p>
            </div>
          </td>
          <td>
                <code>&#39;original&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.array">array</span> / list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (i.e., length of <code>drho</code> equals 1), returns a matrix.<br />
For multiparameter estimation (i.e., length of <code>drho</code> is larger than 1), returns a list of matrices.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>drho</code> is not a list.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>rep</code> has invalid value or RLD doesn't exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the right logarithmic derivative (RLD) for a density matrix.</span>
<span class="sd">    The RLD operator $\mathcal{R}_a$ is defined by</span>

<span class="sd">    $$</span>
<span class="sd">    \partial_{a}\rho=\rho \mathcal{R}_a</span>
<span class="sd">    $$</span>

<span class="sd">    with $\rho$ the parameterized density matrix. The entries of RLD can be calculated as </span>

<span class="sd">    $$</span>
<span class="sd">    \langle\lambda_i| \mathcal{R}_{a} |\lambda_j\rangle=\frac{1}{\lambda_i}\langle\lambda_i| </span>
<span class="sd">    \partial_a\rho |\lambda_j\rangle </span>
<span class="sd">    $$</span>

<span class="sd">    for $\lambda_i\neq 0$.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.  </span>
<span class="sd">        drho (list):  </span>
<span class="sd">            Derivatives of the density matrix on the unknown parameters to be </span>
<span class="sd">            estimated. For example, drho[0] is the derivative vector on the first parameter.</span>
<span class="sd">        rep (str, optional): </span>
<span class="sd">            The basis for the RLD(s). Options:  </span>
<span class="sd">                - &quot;original&quot; (default): basis same as input density matrix.  </span>
<span class="sd">                - &quot;eigen&quot;: basis same as eigenspace of density matrix.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.array/list): </span>
<span class="sd">            For single parameter estimation (i.e., length of `drho` equals 1), returns a matrix.  </span>
<span class="sd">            For multiparameter estimation (i.e., length of `drho` is larger than 1), returns a list of matrices.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `drho` is not a list.</span>
<span class="sd">        ValueError: If `rep` has invalid value or RLD doesn&#39;t exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;drho must be a list of derivative matrices&quot;</span><span class="p">)</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">rld_list</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_params</span>

    <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">param_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="n">rld_eigenbasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
                <span class="c1"># Calculate matrix element in eigenbasis</span>
                <span class="n">element</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> 
                    <span class="o">@</span> <span class="n">drho</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> 
                    <span class="o">@</span> <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                    <span class="n">rld_eigenbasis</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">element</span> <span class="o">/</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;RLD does not exist. It only exists when the support of &quot;</span>
                            <span class="s2">&quot;drho is contained in the support of rho.&quot;</span>
                        <span class="p">)</span>

        <span class="c1"># Handle any potential infinities</span>
        <span class="n">rld_eigenbasis</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">rld_eigenbasis</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Transform to requested basis</span>
        <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
            <span class="n">rld_list</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">eigenvectors</span> 
                <span class="o">@</span> <span class="n">rld_eigenbasis</span> 
                <span class="o">@</span> <span class="n">eigenvectors</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
            <span class="n">rld_list</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">rld_eigenbasis</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valid_reps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;eigen&quot;</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid rep value: &#39;</span><span class="si">{</span><span class="n">rep</span><span class="si">}</span><span class="s2">&#39;. Valid options: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_reps</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">rld_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">rld_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="left-logarithmic-derivative-lld">Left logarithmic derivative (LLD)<a class="headerlink" href="#left-logarithmic-derivative-lld" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.LLD"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the left logarithmic derivative (LLD) for a density matrix <span class="arithmatex">\(\rho\)</span>.</p>
<p>The LLD operator <span class="arithmatex">\(\mathcal{R}_a^{\dagger}\)</span> is defined by</p>
<div class="arithmatex">\[
\partial_{a}\rho=\mathcal{R}_a^{\dagger}\rho.
\]</div>
<p>The entries of LLD can be calculated as </p>
<div class="arithmatex">\[
\langle\lambda_i| \mathcal{R}_{a}^{\dagger} |\lambda_j\rangle=\frac{1}{\lambda_j}\langle\lambda_i| 
\partial_a\rho |\lambda_j\rangle 
\]</div>
<p>for <span class="arithmatex">\(\lambda_j\neq 0\)</span>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrix on the unknown parameters to be estimated. 
For example, drho[0] is the derivative vector on the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rep</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The basis for the LLD(s). Options:<br />
    - "original" (default): basis same as input density matrix.<br />
    - "eigen": basis same as eigenspace of density matrix.</p>
            </div>
          </td>
          <td>
                <code>&#39;original&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.array">array</span> / list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (i.e., length of <code>drho</code> equals 1), returns a matrix.<br />
For multiparameter estimation (i.e., length of <code>drho</code> is larger than 1), returns a list of matrices.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>drho</code> is not a list.  </p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>rep</code> has invalid value or LLD doesn't exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the left logarithmic derivative (LLD) for a density matrix $\rho$.</span>

<span class="sd">    The LLD operator $\mathcal{R}_a^{\dagger}$ is defined by</span>

<span class="sd">    $$</span>
<span class="sd">    \partial_{a}\rho=\mathcal{R}_a^{\dagger}\rho.</span>
<span class="sd">    $$</span>

<span class="sd">    The entries of LLD can be calculated as </span>

<span class="sd">    $$</span>
<span class="sd">    \langle\lambda_i| \mathcal{R}_{a}^{\dagger} |\lambda_j\rangle=\frac{1}{\lambda_j}\langle\lambda_i| </span>
<span class="sd">    \partial_a\rho |\lambda_j\rangle </span>
<span class="sd">    $$</span>

<span class="sd">    for $\lambda_j\neq 0$.</span>

<span class="sd">    Args: </span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrix on the unknown parameters to be estimated. </span>
<span class="sd">            For example, drho[0] is the derivative vector on the first parameter.</span>
<span class="sd">        rep (str, optional): </span>
<span class="sd">            The basis for the LLD(s). Options:  </span>
<span class="sd">                - &quot;original&quot; (default): basis same as input density matrix.  </span>
<span class="sd">                - &quot;eigen&quot;: basis same as eigenspace of density matrix.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.array/list): </span>
<span class="sd">            For single parameter estimation (i.e., length of `drho` equals 1), returns a matrix.  </span>
<span class="sd">            For multiparameter estimation (i.e., length of `drho` is larger than 1), returns a list of matrices.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `drho` is not a list.  </span>
<span class="sd">        ValueError: If `rep` has invalid value or LLD doesn&#39;t exist.  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;drho must be a list of derivative matrices&quot;</span><span class="p">)</span>

    <span class="n">param_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">lld_list</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">param_num</span>

    <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">param_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_num</span><span class="p">):</span>
        <span class="n">lld_eigenbasis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
                <span class="c1"># Calculate matrix element in eigenbasis</span>
                <span class="n">element</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> 
                    <span class="o">@</span> <span class="n">drho</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> 
                    <span class="o">@</span> <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                    <span class="n">lld_eigenbasis</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">element</span> <span class="o">/</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;LLD does not exist. It only exists when the support of &quot;</span>
                            <span class="s2">&quot;drho is contained in the support of rho.&quot;</span>
                        <span class="p">)</span>

        <span class="c1"># Handle any potential infinities</span>
        <span class="n">lld_eigenbasis</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">lld_eigenbasis</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Transform to requested basis</span>
        <span class="k">if</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;original&quot;</span><span class="p">:</span>
            <span class="n">lld_list</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">eigenvectors</span> 
                <span class="o">@</span> <span class="n">lld_eigenbasis</span> 
                <span class="o">@</span> <span class="n">eigenvectors</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="s2">&quot;eigen&quot;</span><span class="p">:</span>
            <span class="n">lld_list</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">lld_eigenbasis</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valid_reps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;eigen&quot;</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid rep value: &#39;</span><span class="si">{</span><span class="n">rep</span><span class="si">}</span><span class="s2">&#39;. Valid options: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_reps</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">lld_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">param_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">lld_list</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="quantum-fisher-information-matrix-qfim">Quantum Fisher information matrix (QFIM)<a class="headerlink" href="#quantum-fisher-information-matrix-qfim" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.QFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculate the quantum Fisher information (QFI) and quantum Fisher 
information matrix (QFIM) for all types.</p>
<p>The entry of QFIM <span class="arithmatex">\(\mathcal{F}\)</span> is defined as:</p>
<div class="arithmatex">\[
\mathcal{F}_{ab}=\frac{1}{2}\mathrm{Tr}(\rho\{L_a, L_b\})
\]</div>
<p>with <span class="arithmatex">\(L_a, L_b\)</span> being SLD operators.</p>
<p>Alternatively:</p>
<div class="arithmatex">\[
\mathcal{F}_{ab}=\mathrm{Tr}(\rho \mathcal{R}_a \mathcal{R}^{\dagger}_b)
\]</div>
<p>with <span class="arithmatex">\(\mathcal{R}_a\)</span> being the RLD or LLD operator.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrix with respect to the unknown parameters. 
Each element in the list is a matrix of the same dimension as <code>rho</code> and 
represents the partial derivative of the density matrix with respect to 
one parameter. For example, <code>drho[0]</code> is the derivative with respect to 
the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>LDtype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Specifies the type of logarithmic derivative to use for QFI/QFIM calculation:<br />
    - "SLD": Symmetric Logarithmic Derivative (default).<br />
    - "RLD": Right Logarithmic Derivative.<br />
    - "LLD": Left Logarithmic Derivative.  </p>
            </div>
          </td>
          <td>
                <code>&#39;SLD&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>exportLD</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to export the values of logarithmic derivatives.  </p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.  </p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (i.e., length of <code>drho</code> equals 1), returns QFI.<br />
For multiparameter estimation (i.e., length of <code>drho</code> is larger than 1), returns QFIM.  </p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>drho</code> is not a list.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>LDtype</code> is not one of the supported types ("SLD", "RLD", "LLD").</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the quantum Fisher information (QFI) and quantum Fisher </span>
<span class="sd">    information matrix (QFIM) for all types.</span>

<span class="sd">    The entry of QFIM $\mathcal{F}$ is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">    \mathcal{F}_{ab}=\frac{1}{2}\mathrm{Tr}(\rho\{L_a, L_b\})</span>
<span class="sd">    $$</span>

<span class="sd">    with $L_a, L_b$ being SLD operators.</span>

<span class="sd">    Alternatively:</span>

<span class="sd">    $$</span>
<span class="sd">    \mathcal{F}_{ab}=\mathrm{Tr}(\rho \mathcal{R}_a \mathcal{R}^{\dagger}_b)</span>
<span class="sd">    $$</span>

<span class="sd">    with $\mathcal{R}_a$ being the RLD or LLD operator.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrix with respect to the unknown parameters. </span>
<span class="sd">            Each element in the list is a matrix of the same dimension as `rho` and </span>
<span class="sd">            represents the partial derivative of the density matrix with respect to </span>
<span class="sd">            one parameter. For example, `drho[0]` is the derivative with respect to </span>
<span class="sd">            the first parameter.</span>
<span class="sd">        LDtype (str, optional): </span>
<span class="sd">            Specifies the type of logarithmic derivative to use for QFI/QFIM calculation:  </span>
<span class="sd">                - &quot;SLD&quot;: Symmetric Logarithmic Derivative (default).  </span>
<span class="sd">                - &quot;RLD&quot;: Right Logarithmic Derivative.  </span>
<span class="sd">                - &quot;LLD&quot;: Left Logarithmic Derivative.  </span>
<span class="sd">        exportLD (bool, optional): </span>
<span class="sd">            Whether to export the values of logarithmic derivatives.  </span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.  </span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (i.e., length of `drho` equals 1), returns QFI.  </span>
<span class="sd">            For multiparameter estimation (i.e., length of `drho` is larger than 1), returns QFIM.  </span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `drho` is not a list.</span>
<span class="sd">        ValueError: If `LDtype` is not one of the supported types (&quot;SLD&quot;, &quot;RLD&quot;, &quot;LLD&quot;).        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;drho must be a list of derivative matrices&quot;</span><span class="p">)</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>
    <span class="n">qfim_result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">log_derivatives</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Single parameter estimation</span>
    <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;SLD&quot;</span><span class="p">:</span>
            <span class="n">sld</span> <span class="o">=</span> <span class="n">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">anticommutator</span> <span class="o">=</span> <span class="n">sld</span> <span class="o">@</span> <span class="n">sld</span> <span class="o">+</span> <span class="n">sld</span> <span class="o">@</span> <span class="n">sld</span>
            <span class="n">qfim_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">anticommutator</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;RLD&quot;</span><span class="p">:</span>
            <span class="n">rld</span> <span class="o">=</span> <span class="n">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">qfim_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">rld</span> <span class="o">@</span> <span class="n">rld</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;LLD&quot;</span><span class="p">:</span>
            <span class="n">lld</span> <span class="o">=</span> <span class="n">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="n">qfim_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">lld</span> <span class="o">@</span> <span class="n">lld</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valid_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="s2">&quot;RLD&quot;</span><span class="p">,</span> <span class="s2">&quot;LLD&quot;</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid LDtype: &#39;</span><span class="si">{</span><span class="n">LDtype</span><span class="si">}</span><span class="s2">&#39;. Supported types: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">log_derivatives</span> <span class="o">=</span> <span class="n">sld</span> <span class="k">if</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;SLD&quot;</span> <span class="k">else</span> <span class="n">rld</span> <span class="k">if</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;RLD&quot;</span> <span class="k">else</span> <span class="n">lld</span>

    <span class="c1"># Multiparameter estimation</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;SLD&quot;</span><span class="p">:</span>
            <span class="n">qfim_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">))</span>
            <span class="n">sld_list</span> <span class="o">=</span> <span class="n">SLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                    <span class="n">anticommutator</span> <span class="o">=</span> <span class="n">sld_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">sld_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">sld_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">@</span> <span class="n">sld_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">anticommutator</span><span class="p">))</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
            <span class="n">log_derivatives</span> <span class="o">=</span> <span class="n">sld_list</span>

        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;RLD&quot;</span><span class="p">:</span>
            <span class="n">qfim_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="n">rld_list</span> <span class="o">=</span> <span class="n">RLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                    <span class="n">term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">rld_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">rld_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
            <span class="n">log_derivatives</span> <span class="o">=</span> <span class="n">rld_list</span>

        <span class="k">elif</span> <span class="n">LDtype</span> <span class="o">==</span> <span class="s2">&quot;LLD&quot;</span><span class="p">:</span>
            <span class="n">qfim_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
            <span class="n">lld_list</span> <span class="o">=</span> <span class="n">LLD</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                    <span class="n">term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">lld_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">lld_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
            <span class="n">log_derivatives</span> <span class="o">=</span> <span class="n">lld_list</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">valid_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="s2">&quot;RLD&quot;</span><span class="p">,</span> <span class="s2">&quot;LLD&quot;</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid LDtype: &#39;</span><span class="si">{</span><span class="n">LDtype</span><span class="si">}</span><span class="s2">&#39;. Supported types: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">exportLD</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">qfim_result</span><span class="p">,</span> <span class="n">log_derivatives</span>
    <span class="k">return</span> <span class="n">qfim_result</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="quantum-fisher-information-matrix-with-kraus-operators">Quantum Fisher information matrix with Kraus operators<a class="headerlink" href="#quantum-fisher-information-matrix-with-kraus-operators" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.QFIM_Kraus"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the quantum Fisher information (QFI) and quantum Fisher 
information matrix (QFIM) for a quantum channel described by Kraus operators.</p>
<p>The quantum channel is given by</p>
<div class="arithmatex">\[
\rho=\sum_{i} K_i \rho_0 K_i^{\dagger},
\]</div>
<p>where <span class="arithmatex">\(\rho_0\)</span> is the initial state and <span class="arithmatex">\(\{K_i\}\)</span> are the Kraus operators.</p>
<p>The derivatives of the density matrix <span class="arithmatex">\(\partial_a\rho\)</span> are calculated from the 
derivatives of the Kraus operators <span class="arithmatex">\(\{\partial_a K_i\}\)</span> as</p>
<div class="arithmatex">\[
\partial_a\rho=\sum_{i}\left[(\partial_a K_i)\rho_0 K_i^{\dagger}+K_i\rho_0(\partial_a K_i)^{\dagger}\right].
\]</div>
<p>Then the QFI (QFIM) is calculated via the function <code>QFIM</code> with the evolved state 
<span class="arithmatex">\(\rho\)</span> and its derivatives <span class="arithmatex">\(\{\partial_a\rho\}\)</span>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho0</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>K</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kraus operators.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dK</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the Kraus operators. It is a nested list where the first index 
corresponds to the parameter and the second index corresponds to the Kraus operator index. 
For example, <code>dK[0][1]</code> is the derivative of the second Kraus operator with respect 
to the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>LDtype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Types of QFI (QFIM) can be set as the objective function. Options:<br />
    - "SLD" (default): QFI (QFIM) based on symmetric logarithmic derivative.<br />
    - "RLD": QFI (QFIM) based on right logarithmic derivative.<br />
    - "LLD": QFI (QFIM) based on left logarithmic derivative.  </p>
            </div>
          </td>
          <td>
                <code>&#39;SLD&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>exportLD</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to export the values of logarithmic derivatives.  </p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.  </p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (the length of dK is equal to one), the output is QFI 
and for multiparameter estimation (the length of dK is more than one), it returns QFIM.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">QFIM_Kraus</span><span class="p">(</span><span class="n">rho0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dK</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the quantum Fisher information (QFI) and quantum Fisher </span>
<span class="sd">    information matrix (QFIM) for a quantum channel described by Kraus operators.</span>

<span class="sd">    The quantum channel is given by</span>

<span class="sd">    $$</span>
<span class="sd">    \rho=\sum_{i} K_i \rho_0 K_i^{\dagger},</span>
<span class="sd">    $$</span>

<span class="sd">    where $\rho_0$ is the initial state and $\{K_i\}$ are the Kraus operators.</span>

<span class="sd">    The derivatives of the density matrix $\partial_a\rho$ are calculated from the </span>
<span class="sd">    derivatives of the Kraus operators $\{\partial_a K_i\}$ as</span>

<span class="sd">    $$</span>
<span class="sd">    \partial_a\rho=\sum_{i}\left[(\partial_a K_i)\rho_0 K_i^{\dagger}+K_i\rho_0(\partial_a K_i)^{\dagger}\right].</span>
<span class="sd">    $$</span>

<span class="sd">    Then the QFI (QFIM) is calculated via the function `QFIM` with the evolved state </span>
<span class="sd">    $\rho$ and its derivatives $\{\partial_a\rho\}$.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho0 (np.array): </span>
<span class="sd">            Initial density matrix.</span>
<span class="sd">        K (list): </span>
<span class="sd">            Kraus operators.</span>
<span class="sd">        dK (list): </span>
<span class="sd">            Derivatives of the Kraus operators. It is a nested list where the first index </span>
<span class="sd">            corresponds to the parameter and the second index corresponds to the Kraus operator index. </span>
<span class="sd">            For example, `dK[0][1]` is the derivative of the second Kraus operator with respect </span>
<span class="sd">            to the first parameter.</span>
<span class="sd">        LDtype (str, optional): </span>
<span class="sd">            Types of QFI (QFIM) can be set as the objective function. Options:  </span>
<span class="sd">                - &quot;SLD&quot; (default): QFI (QFIM) based on symmetric logarithmic derivative.  </span>
<span class="sd">                - &quot;RLD&quot;: QFI (QFIM) based on right logarithmic derivative.  </span>
<span class="sd">                - &quot;LLD&quot;: QFI (QFIM) based on left logarithmic derivative.  </span>
<span class="sd">        exportLD (bool, optional): </span>
<span class="sd">            Whether to export the values of logarithmic derivatives.  </span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.  </span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (the length of dK is equal to one), the output is QFI </span>
<span class="sd">            and for multiparameter estimation (the length of dK is more than one), it returns QFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Transpose dK: from [parameters][operators] to [operators][parameters]</span>
    <span class="n">dK_transposed</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">dK</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">))]</span> 
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dK</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">]</span>

    <span class="c1"># Compute the evolved density matrix</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">Ki</span> <span class="o">@</span> <span class="n">rho0</span> <span class="o">@</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">Ki</span> <span class="ow">in</span> <span class="n">K</span><span class="p">)</span>

    <span class="c1"># Compute the derivatives of the density matrix</span>
    <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">sum</span><span class="p">(</span>
            <span class="n">dKi</span> <span class="o">@</span> <span class="n">rho0</span> <span class="o">@</span> <span class="n">Ki</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">Ki</span> <span class="o">@</span> <span class="n">rho0</span> <span class="o">@</span> <span class="n">dKi</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
            <span class="k">for</span> <span class="n">Ki</span><span class="p">,</span> <span class="n">dKi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">dKj</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">dKj</span> <span class="ow">in</span> <span class="n">dK_transposed</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="n">exportLD</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="quantum-fisher-information-matrix-in-bloch-representation">Quantum Fisher information matrix in Bloch representation<a class="headerlink" href="#quantum-fisher-information-matrix-in-bloch-representation" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.QFIM_Bloch"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the quantum Fisher information (QFI) and quantum Fisher 
information matrix (QFIM) in Bloch representation.</p>
<p>The Bloch vector representation of a quantum state is defined as</p>
<div class="arithmatex">\[
\rho = \frac{1}{d}\left(\mathbb{I} + \sum_{i=1}^{d^2-1} r_i \lambda_i\right),
\]</div>
<p>where <span class="arithmatex">\(\lambda_i\)</span> are the generators of SU(d) group.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>r</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized Bloch vector.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dr</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the Bloch vector with respect to the unknown parameters. 
Each element in the list is a vector of the same length as <code>r</code> and 
represents the partial derivative of the Bloch vector with respect to 
one parameter. For example, <code>dr[0]</code> is the derivative with respect to 
the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.  </p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (the length of <code>dr</code> is equal to one), 
the output is QFI and for multiparameter estimation (the length of <code>dr</code> 
is more than one), it returns QFIM.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>dr</code> is not a list.  </p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the dimension of the Bloch vector is invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">QFIM_Bloch</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the quantum Fisher information (QFI) and quantum Fisher </span>
<span class="sd">    information matrix (QFIM) in Bloch representation.</span>

<span class="sd">    The Bloch vector representation of a quantum state is defined as</span>

<span class="sd">    $$</span>
<span class="sd">    \rho = \frac{1}{d}\left(\mathbb{I} + \sum_{i=1}^{d^2-1} r_i \lambda_i\right),</span>
<span class="sd">    $$</span>

<span class="sd">    where $\lambda_i$ are the generators of SU(d) group.</span>

<span class="sd">    Args:</span>
<span class="sd">        r (np.array): </span>
<span class="sd">            Parameterized Bloch vector.</span>
<span class="sd">        dr (list): </span>
<span class="sd">            Derivatives of the Bloch vector with respect to the unknown parameters. </span>
<span class="sd">            Each element in the list is a vector of the same length as `r` and </span>
<span class="sd">            represents the partial derivative of the Bloch vector with respect to </span>
<span class="sd">            one parameter. For example, `dr[0]` is the derivative with respect to </span>
<span class="sd">            the first parameter.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.  </span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (the length of `dr` is equal to one), </span>
<span class="sd">            the output is QFI and for multiparameter estimation (the length of `dr` </span>
<span class="sd">            is more than one), it returns QFIM.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `dr` is not a list.  </span>
<span class="sd">        ValueError: If the dimension of the Bloch vector is invalid.  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;dr must be a list of derivative vectors&quot;</span><span class="p">)</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dr</span><span class="p">)</span>
    <span class="n">qfim_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">))</span>

    <span class="c1"># Calculate dimension from Bloch vector length</span>
    <span class="n">dim_float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dim_float</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dim_float</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Bloch vector dimension&quot;</span><span class="p">)</span>

    <span class="c1"># Get SU(N) generators</span>
    <span class="n">lambda_generators</span> <span class="o">=</span> <span class="n">suN_generator</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>

    <span class="c1"># Handle single-qubit system</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">r_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="c1"># Pure state case</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_norm</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dr</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="c1"># Mixed state case</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                    <span class="n">term1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                    <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dr</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r_norm</span><span class="p">)</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span>
                    <span class="n">qfim_result</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="c1"># Handle higher-dimensional systems</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Reconstruct density matrix from Bloch vector</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="o">/</span> <span class="n">dim</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dim</span> <span class="o">*</span> <span class="p">(</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">/</span> <span class="n">dim</span>
            <span class="n">rho</span> <span class="o">+=</span> <span class="n">coeff</span> <span class="o">*</span> <span class="n">lambda_generators</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="c1"># Calculate G matrix</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dim</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">anticommutator</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">lambda_generators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">lambda_generators</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> 
                    <span class="n">lambda_generators</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">@</span> <span class="n">lambda_generators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span> <span class="o">@</span> <span class="n">anticommutator</span><span class="p">)</span>
                <span class="n">G</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

        <span class="c1"># Calculate matrix for inversion</span>
        <span class="n">r_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">G</span> <span class="o">*</span> <span class="n">dim</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">r_vec</span> <span class="o">@</span> <span class="n">r_vec</span><span class="o">.</span><span class="n">T</span>
        <span class="n">mat_inv</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

        <span class="c1"># Calculate QFIM</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
                <span class="n">dr_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="n">dr_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dr_i</span> <span class="o">@</span> <span class="n">mat_inv</span> <span class="o">@</span> <span class="n">dr_j</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">qfim_result</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">qfim_result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">qfim_result</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">qfim_result</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="quantum-fisher-information-matrix-with-gaussian-states">Quantum Fisher information matrix with Gaussian states<a class="headerlink" href="#quantum-fisher-information-matrix-with-gaussian-states" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.QFIM_Gauss"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the quantum Fisher information (QFI) and quantum 
Fisher information matrix (QFIM) for Gaussian states.</p>
<p>The Gaussian state is characterized by its first-order moment (displacement vector) 
and second-order moment (covariance matrix). The QFIM is calculated using the 
method described in [1].</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>R</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>First-order moment (displacement vector).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dR</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the first-order moment with respect to the unknown parameters. 
Each element in the list is a vector of the same length as <code>R</code> and represents the partial 
derivative of the displacement vector with respect to one parameter. For example, <code>dR[0]</code> 
is the derivative with respect to the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>D</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Second-order moment (covariance matrix).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dD</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the second-order moment with respect to the unknown parameters. 
Each element in the list is a matrix of the same dimension as <code>D</code> and 
represents the partial derivative of the covariance matrix with respect to 
one parameter. For example, <code>dD[0]</code> is the derivative with respect to 
the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (the length of <code>dR</code> is equal to one), 
the output is QFI and for multiparameter estimation (the length of <code>dR</code> 
is more than one), it returns QFIM.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>This function follows the approach from:
[1] Monras, A., Phase space formalism for quantum estimation of Gaussian states, arXiv:1303.3682 (2013).</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/CramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">QFIM_Gauss</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">dR</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the quantum Fisher information (QFI) and quantum </span>
<span class="sd">    Fisher information matrix (QFIM) for Gaussian states.</span>

<span class="sd">    The Gaussian state is characterized by its first-order moment (displacement vector) </span>
<span class="sd">    and second-order moment (covariance matrix). The QFIM is calculated using the </span>
<span class="sd">    method described in [1].</span>

<span class="sd">    Args:</span>
<span class="sd">        R (np.array): </span>
<span class="sd">            First-order moment (displacement vector).</span>
<span class="sd">        dR (list): </span>
<span class="sd">            Derivatives of the first-order moment with respect to the unknown parameters. </span>
<span class="sd">            Each element in the list is a vector of the same length as `R` and represents the partial </span>
<span class="sd">            derivative of the displacement vector with respect to one parameter. For example, `dR[0]` </span>
<span class="sd">            is the derivative with respect to the first parameter.</span>
<span class="sd">        D (np.array): </span>
<span class="sd">            Second-order moment (covariance matrix).</span>
<span class="sd">        dD (list): </span>
<span class="sd">            Derivatives of the second-order moment with respect to the unknown parameters. </span>
<span class="sd">            Each element in the list is a matrix of the same dimension as `D` and </span>
<span class="sd">            represents the partial derivative of the covariance matrix with respect to </span>
<span class="sd">            one parameter. For example, `dD[0]` is the derivative with respect to </span>
<span class="sd">            the first parameter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (the length of `dR` is equal to one), </span>
<span class="sd">            the output is QFI and for multiparameter estimation (the length of `dR` </span>
<span class="sd">            is more than one), it returns QFIM.</span>

<span class="sd">    Notes:</span>
<span class="sd">        This function follows the approach from:</span>
<span class="sd">        [1] Monras, A., Phase space formalism for quantum estimation of Gaussian states, arXiv:1303.3682 (2013).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dR</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># Number of modes</span>
    <span class="n">qfim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">))</span>

    <span class="c1"># Compute the covariance matrix from the second-order moments and displacement</span>
    <span class="n">cov_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># Compute the derivatives of the covariance matrix</span>
    <span class="n">dcov</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="n">dcov_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">):</span>
                <span class="n">dcov_k</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dD</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">dR</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dR</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">dcov</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dcov_k</span><span class="p">)</span>

    <span class="c1"># Compute the square root of the covariance matrix</span>
    <span class="n">cov_sqrt</span> <span class="o">=</span> <span class="n">sqrtm</span><span class="p">(</span><span class="n">cov_matrix</span><span class="p">)</span>

    <span class="c1"># Define the symplectic matrix J for m modes</span>
    <span class="n">J_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">J_block</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>

    <span class="c1"># Compute the matrix B = cov_sqrt @ J @ cov_sqrt</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">cov_sqrt</span> <span class="o">@</span> <span class="n">J</span> <span class="o">@</span> <span class="n">cov_sqrt</span>

    <span class="c1"># Permutation matrix to rearrange the basis</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
    <span class="c1"># Rearrange the basis: first all q&#39;s then all p&#39;s</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">P</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]])</span>

    <span class="c1"># Schur decomposition of B</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">schur</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">eigvals</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="c1"># Extract the imaginary parts of every other eigenvalue</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">eigenvalues</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>

    <span class="c1"># Diagonal matrix with entries 1/sqrt(c_i) for each mode</span>
    <span class="n">diag_inv_sqrt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>

    <span class="c1"># Construct the matrix S</span>
    <span class="n">temp1</span> <span class="o">=</span> <span class="n">J</span> <span class="o">@</span> <span class="n">cov_sqrt</span> <span class="o">@</span> <span class="n">Q</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">P</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="o">-</span><span class="n">diag_inv_sqrt</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">temp1</span> <span class="o">@</span> <span class="n">temp2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">P</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Define the basis matrices for the Gaussian representation</span>
    <span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
    <span class="n">sigma_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
    <span class="n">sigma_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]])</span>
    <span class="n">identity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">a_gauss</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">sigma_y</span><span class="p">,</span> <span class="n">sigma_z</span><span class="p">,</span> <span class="n">identity</span><span class="p">,</span> <span class="n">sigma_x</span><span class="p">]</span>

    <span class="c1"># Construct the basis matrices for the m-mode system</span>
    <span class="n">es</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">e_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">*</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ij</span><span class="p">)</span>
        <span class="n">es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="c1"># As: a list of two-mode basis matrices for each of the four types</span>
    <span class="n">As</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">a_gauss</span><span class="p">:</span>
        <span class="n">A_type</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="n">A_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">es</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">A_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A_ij</span><span class="p">)</span>
        <span class="n">As</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A_type</span><span class="p">)</span>

    <span class="c1"># Compute the coefficients g for each parameter and each basis matrix</span>
    <span class="n">g</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="n">g_k</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">A_type</span> <span class="ow">in</span> <span class="n">As</span><span class="p">:</span>
            <span class="n">g_type</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">A_mat</span> <span class="ow">in</span> <span class="n">A_type</span><span class="p">:</span>
                <span class="n">term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">@</span> <span class="n">dcov</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">@</span> <span class="n">A_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="n">g_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
            <span class="n">g_k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_type</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_k</span><span class="p">)</span>

    <span class="c1"># Initialize the matrices G for each parameter</span>
    <span class="n">G_matrices</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">)]</span>

    <span class="c1"># Construct the matrices G for each parameter</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>  <span class="c1"># For each of the four types</span>
                    <span class="n">denom</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">A_l_ij</span> <span class="o">=</span> <span class="n">As</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">i</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
                    <span class="n">G_matrices</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
                        <span class="n">g</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">i</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">denom</span> <span class="o">*</span> <span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">@</span> <span class="n">A_l_ij</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
                    <span class="p">)</span>

    <span class="c1"># Compute the QFIM</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
            <span class="n">term1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">G_matrices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">dcov</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">dR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">cov_matrix</span><span class="p">)</span> <span class="o">@</span> <span class="n">dR</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">qfim</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">qfim</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">qfim</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="holevo-cramer-rao-bound">Holevo Cramér-Rao bound<a class="headerlink" href="#holevo-cramer-rao-bound" title="Permanent link">&para;</a></h2>



<div class="doc doc-object doc-function">




<a id="quanestimation.HCRB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculate the Holevo Cramer-Rao bound (HCRB) via semidefinite programming (SDP).</p>
<p>The HCRB is defined as:</p>
<div class="arithmatex">\[
\min_{\{X_i\}} \left\{ \mathrm{Tr}(\mathrm{Re}Z) + \mathrm{Tr}(| \mathrm{Im} Z |) \right\}, 
\]</div>
<p>where <span class="arithmatex">\(Z_{ij} = \mathrm{Tr}(\rho X_i X_j)\)</span> and <span class="arithmatex">\(V\)</span> is the covariance matrix.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrix with respect to unknown parameters.<br />
For example, <code>drho[0]</code> is the derivative with respect to the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>W</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weight matrix for the bound.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon for numerical stability.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value of the Holevo Cramer-Rao bound.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>drho</code> is not a list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>In the single-parameter scenario, the HCRB is equivalent to the QFI.<br />
For a rank-one weight matrix, the HCRB is equivalent to the inverse of the QFIM.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/AnalogCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">HCRB</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Holevo Cramer-Rao bound (HCRB) via semidefinite programming (SDP).</span>

<span class="sd">    The HCRB is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">    \min_{\{X_i\}} \left\{ \mathrm{Tr}(\mathrm{Re}Z) + \mathrm{Tr}(| \mathrm{Im} Z |) \right\}, </span>
<span class="sd">    $$</span>

<span class="sd">    where $Z_{ij} = \mathrm{Tr}(\rho X_i X_j)$ and $V$ is the covariance matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrix with respect to unknown parameters.  </span>
<span class="sd">            For example, `drho[0]` is the derivative with respect to the first parameter.</span>
<span class="sd">        W (np.array): </span>
<span class="sd">            Weight matrix for the bound.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon for numerical stability.</span>

<span class="sd">    Returns: </span>
<span class="sd">        (float): </span>
<span class="sd">            The value of the Holevo Cramer-Rao bound.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `drho` is not a list.</span>

<span class="sd">    Notes:</span>
<span class="sd">        In the single-parameter scenario, the HCRB is equivalent to the QFI.  </span>
<span class="sd">        For a rank-one weight matrix, the HCRB is equivalent to the inverse of the QFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;drho must be a list of derivative matrices&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;In single parameter scenario, HCRB is equivalent to QFI. &quot;</span>
            <span class="s2">&quot;Returning QFI value.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">matrix_rank</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;For rank-one weight matrix, HCRB is equivalent to QFIM. &quot;</span>
            <span class="s2">&quot;Returning Tr(W @ inv(QFIM)).&quot;</span>
        <span class="p">)</span>
        <span class="n">qfim</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">W</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">qfim</span><span class="p">))</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">*</span> <span class="n">dim</span>
    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>

    <span class="c1"># Generate basis matrices</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span> <span class="o">+</span> <span class="n">suN_generator</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">basis</span><span class="p">]</span>

    <span class="c1"># Compute vectorized derivatives</span>
    <span class="n">vec_drho</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">param_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="n">param_idx</span><span class="p">]</span> <span class="o">@</span> <span class="n">basis_mat</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">basis_mat</span> <span class="ow">in</span> <span class="n">basis</span>
        <span class="p">]</span>
        <span class="n">vec_drho</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">components</span><span class="p">))</span>

    <span class="c1"># Compute S matrix</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span> <span class="n">num</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">basis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">basis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">@</span> <span class="n">rho</span><span class="p">)</span>

    <span class="c1"># Regularize and factor S</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">eps</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">lu</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">ldl</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">lu</span> <span class="o">@</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Define optimization variables</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">num_params</span><span class="p">,</span> <span class="n">num_params</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">num</span><span class="p">,</span> <span class="n">num_params</span><span class="p">))</span>

    <span class="c1"># Define constraints</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">cp</span><span class="o">.</span><span class="n">bmat</span><span class="p">([</span>
            <span class="p">[</span><span class="n">V</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">R</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">],</span>
            <span class="p">[</span><span class="n">R</span> <span class="o">@</span> <span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
        <span class="p">])</span> <span class="o">&gt;&gt;</span> <span class="mi">0</span>
    <span class="p">]</span>

    <span class="c1"># Add linear constraints</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
            <span class="n">constraint_val</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">vec_drho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint_val</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint_val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Solve the optimization problem</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">W</span> <span class="o">@</span> <span class="n">V</span><span class="p">)),</span> <span class="n">constraints</span><span class="p">)</span>
    <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">problem</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="nagaoka-hayashi-bound">Nagaoka-Hayashi bound<a class="headerlink" href="#nagaoka-hayashi-bound" title="Permanent link">&para;</a></h2>



<div class="doc doc-object doc-function">




<a id="quanestimation.NHB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Nagaoka-Hayashi bound (NHB) via the semidefinite program (SDP).</p>
<p>The NHB is defined as:</p>
<div class="arithmatex">\[
\min_{X} \left\{ \mathrm{Tr}[W \mathrm{Re}(Z)] + \|\sqrt{W} \mathrm{Im}(Z) \sqrt{W}\|_1 \right\}, 
\]</div>
<p>where <span class="arithmatex">\(Z_{ij} = \mathrm{Tr}(\rho X_i X_j)\)</span> and <span class="arithmatex">\(V\)</span> is the covariance matrix.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrix with respect to unknown parameters.<br />
For example, <code>drho[0]</code> is the derivative with respect to the first parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>W</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weight matrix for the bound.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value of the Nagaoka-Hayashi bound.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>drho</code> is not a list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/AsymptoticBound/AnalogCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">NHB</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Nagaoka-Hayashi bound (NHB) via the semidefinite program (SDP).</span>

<span class="sd">    The NHB is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">    \min_{X} \left\{ \mathrm{Tr}[W \mathrm{Re}(Z)] + \|\sqrt{W} \mathrm{Im}(Z) \sqrt{W}\|_1 \right\}, </span>
<span class="sd">    $$</span>

<span class="sd">    where $Z_{ij} = \mathrm{Tr}(\rho X_i X_j)$ and $V$ is the covariance matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        rho (np.array): </span>
<span class="sd">            Density matrix.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrix with respect to unknown parameters.  </span>
<span class="sd">            For example, `drho[0]` is the derivative with respect to the first parameter.</span>
<span class="sd">        W (np.array): </span>
<span class="sd">            Weight matrix for the bound.</span>

<span class="sd">    Returns: </span>
<span class="sd">        (float): </span>
<span class="sd">            The value of the Nagaoka-Hayashi bound.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: </span>
<span class="sd">            If `drho` is not a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;drho must be a list of derivative matrices&quot;</span><span class="p">)</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">drho</span><span class="p">)</span>

    <span class="c1"># Initialize a temporary matrix for L components</span>
    <span class="n">L_temp</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">)]</span>

    <span class="c1"># Create Hermitian variables for the upper triangle and mirror to lower triangle</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">num_params</span><span class="p">):</span>
            <span class="n">L_temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">L_temp</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

    <span class="c1"># Construct the block matrix L</span>
    <span class="n">L_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">L_temp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">)]</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">L_blocks</span><span class="p">)</span>

    <span class="c1"># Create Hermitian variables for X</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">)]</span>

    <span class="c1"># Construct the block matrix constraint</span>
    <span class="n">block_matrix</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">bmat</span><span class="p">([</span>
        <span class="p">[</span><span class="n">L</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
        <span class="p">[</span><span class="n">cp</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span>
    <span class="p">])</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">block_matrix</span> <span class="o">&gt;&gt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Add trace constraints</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
        <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">rho</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_params</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">drho</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">drho</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Define and solve the optimization problem</span>
    <span class="n">objective</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span> <span class="o">@</span> <span class="n">L</span><span class="p">)))</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="bayesian-cramer-rao-bounds">Bayesian Cramér-Rao bounds<a class="headerlink" href="#bayesian-cramer-rao-bounds" title="Permanent link">&para;</a></h2>
<h3 id="bayesian-classical-fisher-information-matrix-bcfim">Bayesian classical Fisher information matrix (BCFIM)<a class="headerlink" href="#bayesian-classical-fisher-information-matrix-bcfim" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.BCFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian classical Fisher information matrix (BCFIM).</p>
<p>This function computes the Bayesian classical Fisher information (BCFI) or Bayesian classical 
Fisher information matrix (BCFIM). The BCFIM is defined as:</p>
<div class="arithmatex">\[
    \mathcal{I}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{I} \, \mathrm{d}\textbf{x}.
\]</div>
<p>where <span class="arithmatex">\(\mathcal{I}\)</span> is the classical Fisher information matrix (CFIM) and <span class="arithmatex">\(p(\textbf{x})\)</span> 
is the prior distribution.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter regimes for integration. Each element is an array 
representing the values of one parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prior distribution over the parameter space. Must have the same dimensions 
as the product of the lengths of the arrays in <code>x</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrices. Each element corresponds to 
a point in the parameter space defined by <code>x</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrices with respect to the parameters. For single parameter estimation (length of <code>x</code> is 1), 
<code>drho</code> is a list of derivatives at each parameter point. For multiparameter estimation, <code>drho</code> is a 
multidimensional list where <code>drho[i]</code> is a list of derivatives with respect to each parameter at the i-th parameter point, 
and <code>drho[i][j]</code> is the derivative of the density matrix at the i-th parameter point with respect to the j-th parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>M</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positive operator-valued measure (POVM). Default is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon for numerical stability.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (length of <code>x</code> is 1), returns BCFI.           <br />
For multiparameter estimation (length of <code>x</code> &gt; 1), returns BCFIM.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>M</code> is provided but not a list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>SIC-POVM is calculated using Weyl-Heisenberg covariant SIC-POVM fiducial states 
available at <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">http://www.physics.umb.edu/Research/QBism/solutions.html</a>.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BCFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian classical Fisher information matrix (BCFIM).</span>

<span class="sd">    This function computes the Bayesian classical Fisher information (BCFI) or Bayesian classical </span>
<span class="sd">    Fisher information matrix (BCFIM). The BCFIM is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">        \mathcal{I}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{I} \, \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    where $\mathcal{I}$ is the classical Fisher information matrix (CFIM) and $p(\textbf{x})$ </span>
<span class="sd">    is the prior distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            Parameter regimes for integration. Each element is an array </span>
<span class="sd">            representing the values of one parameter.</span>
<span class="sd">        p (np.array): </span>
<span class="sd">            Prior distribution over the parameter space. Must have the same dimensions </span>
<span class="sd">            as the product of the lengths of the arrays in `x`.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrices. Each element corresponds to </span>
<span class="sd">            a point in the parameter space defined by `x`.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrices with respect to the parameters. For single parameter estimation (length of `x` is 1), </span>
<span class="sd">            `drho` is a list of derivatives at each parameter point. For multiparameter estimation, `drho` is a </span>
<span class="sd">            multidimensional list where `drho[i]` is a list of derivatives with respect to each parameter at the i-th parameter point, </span>
<span class="sd">            and `drho[i][j]` is the derivative of the density matrix at the i-th parameter point with respect to the j-th parameter.</span>
<span class="sd">        M (list, optional): </span>
<span class="sd">            Positive operator-valued measure (POVM). Default is a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon for numerical stability.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (length of `x` is 1), returns BCFI.             </span>
<span class="sd">            For multiparameter estimation (length of `x` &gt; 1), returns BCFIM.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: </span>
<span class="sd">            If `M` is provided but not a list.</span>

<span class="sd">    Notes:</span>
<span class="sd">        SIC-POVM is calculated using Weyl-Heisenberg covariant SIC-POVM fiducial states </span>
<span class="sd">        available at [http://www.physics.umb.edu/Research/QBism/solutions.html](http://www.physics.umb.edu/Research/QBism/solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
        <span class="c1"># Convert drho_list[i] to a list of arrays to ensure proper type handling</span>
        <span class="n">drho_arrays</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_arrays</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="c1"># Ensure we&#39;re assigning float values</span>
                <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]))</span>

    <span class="n">BCFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
            <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
            <span class="n">BCFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
            <span class="n">BCFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">BCFIM_res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="bayesian-quantum-fisher-information-matrix-bqfim">Bayesian quantum Fisher information matrix (BQFIM)<a class="headerlink" href="#bayesian-quantum-fisher-information-matrix-bqfim" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.BQFIM"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian quantum Fisher information matrix (BQFIM).</p>
<p>This function computes the Bayesian quantum Fisher information (BQFI) or Bayesian quantum 
Fisher information matrix (BQFIM). The BQFIM is defined as:</p>
<div class="arithmatex">\[
    \mathcal{F}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{F} \, \mathrm{d}\textbf{x}.
\]</div>
<p>where <span class="arithmatex">\(\mathcal{F}\)</span> is the quantum Fisher information matrix (QFIM) and <span class="arithmatex">\(p(\textbf{x})\)</span> 
is the prior distribution.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter regimes for integration. Each element is an array 
representing the values of one parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prior distribution over the parameter space. Must have the same dimensions 
as the product of the lengths of the arrays in <code>x</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrices. Each element corresponds to 
a point in the parameter space defined by <code>x</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrices with respect to 
the parameters. <code>drho[i][j]</code> is the derivative of the density matrix at the i-th 
parameter point with respect to the j-th parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>LDtype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of logarithmic derivative (default: "SLD"). Options:<br />
- "SLD": Symmetric logarithmic derivative<br />
- "RLD": Right logarithmic derivative<br />
- "LLD": Left logarithmic derivative  </p>
            </div>
          </td>
          <td>
                <code>&#39;SLD&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon for numerical stability.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (length of <code>x</code> is 1), returns BQFI. 
For multiparameter estimation (length of <code>x</code> &gt; 1), returns BQFIM.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BQFIM</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian quantum Fisher information matrix (BQFIM).</span>

<span class="sd">    This function computes the Bayesian quantum Fisher information (BQFI) or Bayesian quantum </span>
<span class="sd">    Fisher information matrix (BQFIM). The BQFIM is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">        \mathcal{F}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{F} \, \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    where $\mathcal{F}$ is the quantum Fisher information matrix (QFIM) and $p(\textbf{x})$ </span>
<span class="sd">    is the prior distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): Parameter regimes for integration. Each element is an array </span>
<span class="sd">            representing the values of one parameter.</span>
<span class="sd">        p (np.array): Prior distribution over the parameter space. Must have the same dimensions </span>
<span class="sd">            as the product of the lengths of the arrays in `x`.</span>
<span class="sd">        rho (list): Parameterized density matrices. Each element corresponds to </span>
<span class="sd">            a point in the parameter space defined by `x`.</span>
<span class="sd">        drho (list): Derivatives of the density matrices with respect to </span>
<span class="sd">            the parameters. `drho[i][j]` is the derivative of the density matrix at the i-th </span>
<span class="sd">            parameter point with respect to the j-th parameter.</span>
<span class="sd">        LDtype (str, optional): Type of logarithmic derivative (default: &quot;SLD&quot;). Options:  </span>
<span class="sd">            - &quot;SLD&quot;: Symmetric logarithmic derivative  </span>
<span class="sd">            - &quot;RLD&quot;: Right logarithmic derivative  </span>
<span class="sd">            - &quot;LLD&quot;: Left logarithmic derivative  </span>
<span class="sd">        eps (float, optional): Machine epsilon for numerical stability.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (length of `x` is 1), returns BQFI. </span>
<span class="sd">            For multiparameter estimation (length of `x` &gt; 1), returns BQFIM.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
            <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

        <span class="n">BQFIM_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">BQFIM_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                <span class="n">BQFIM_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
        <span class="k">return</span> <span class="n">BQFIM_res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="bayesian-cramer-rao-bound-bcrb">Bayesian Cramér-Rao bound (BCRB)<a class="headerlink" href="#bayesian-cramer-rao-bound-bcrb" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.BCRB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian Cramer-Rao bound (BCRB).</p>
<p>This function computes the Bayesian Cramer-Rao bound (BCRB) for single or multiple parameters.</p>
<p>The covariance matrix with prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> is:</p>
<div class="arithmatex">\[
    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\}) = \int p(\textbf{x}) \sum_y \mathrm{Tr}
    (\rho\Pi_y) (\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
    \mathrm{d}\textbf{x}.
\]</div>
<p>This function calculates three types of BCRB:</p>
<p><strong>Type 1:</strong></p>
<div class="arithmatex">\[
    \mathrm{cov} \geq \int p(\textbf{x}) \left( B \mathcal{I}^{-1} B 
    + \textbf{b} \textbf{b}^{\mathrm{T}} \right) \mathrm{d}\textbf{x}.
\]</div>
<p><strong>Type 2:</strong>
$$
    \mathrm{cov} \geq \mathcal{B} \mathcal{I}_{\mathrm{Bayes}}^{-1} \mathcal{B} 
    + \int p(\textbf{x}) \textbf{b} \textbf{b}^{\mathrm{T}} \mathrm{d}\textbf{x}.
$$</p>
<p><strong>Type 3:</strong>
$$
    \mathrm{cov} \geq \int p(\textbf{x}) \mathcal{G} \left( \mathcal{I}_p 
    + \mathcal{I} \right)^{-1} \mathcal{G}^{\mathrm{T}} \mathrm{d}\textbf{x}.
$$</p>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(\textbf{b}\)</span>: bias vector</li>
<li><span class="arithmatex">\(\textbf{b}'\)</span>: its derivatives</li>
<li><span class="arithmatex">\(B\)</span>: diagonal matrix with <span class="arithmatex">\(B_{ii} = 1 + [\textbf{b}']_{i}\)</span></li>
<li><span class="arithmatex">\(\mathcal{I}\)</span>: classical Fisher information matrix (CFIM)</li>
<li><span class="arithmatex">\(\mathcal{B} = \int p(\textbf{x}) B \mathrm{d}\textbf{x}\)</span></li>
<li><span class="arithmatex">\(\mathcal{I}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{I} \mathrm{d}\textbf{x}\)</span></li>
<li><span class="arithmatex">\([\mathcal{I}_{p}]_{ab} = [\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]\)</span></li>
<li><span class="arithmatex">\(\mathcal{G}_{ab} = [\partial_b \ln p(\textbf{x})][\textbf{b}]_a + B_{aa}\delta_{ab}\)</span></li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter regimes for integration.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prior distribution over the parameter space. Must have the same dimensions 
as the product of the lengths of the arrays in <code>x</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dp</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the prior distribution with respect to the parameters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrices. Each element corresponds to 
a point in the parameter space defined by <code>x</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrices with respect to 
the parameters. <code>drho[i][j]</code> is the derivative of the density matrix at the i-th 
parameter point with respect to the j-th parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>M</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positive operator-valued measure (POVM). Default is 
a set of rank-one symmetric informationally complete POVM (SIC-POVM).</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>b</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Bias vector. Default is zero bias.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>db</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the bias vector. Default is zero.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>btype</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of BCRB to calculate (1, 2, or 3).</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon for numerical stability.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (length of <code>x</code> is 1), returns BCRB. 
For multiparameter estimation (length of <code>x</code> &gt; 1), returns BCRB matrix.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>M</code> is provided but not a list.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>NameError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>btype</code> is not in {1, 2, 3}.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>SIC-POVM is calculated using Weyl-Heisenberg covariant SIC-POVM fiducial states 
available at <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">http://www.physics.umb.edu/Research/QBism/solutions.html</a>.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">b</span><span class="o">=</span><span class="p">[],</span> <span class="n">db</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian Cramer-Rao bound (BCRB).</span>

<span class="sd">    This function computes the Bayesian Cramer-Rao bound (BCRB) for single or multiple parameters.</span>

<span class="sd">    The covariance matrix with prior distribution $p(\textbf{x})$ is:</span>

<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\}) = \int p(\textbf{x}) \sum_y \mathrm{Tr}</span>
<span class="sd">        (\rho\Pi_y) (\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">        \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    This function calculates three types of BCRB:</span>

<span class="sd">    **Type 1:**</span>

<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov} \geq \int p(\textbf{x}) \left( B \mathcal{I}^{-1} B </span>
<span class="sd">        + \textbf{b} \textbf{b}^{\mathrm{T}} \right) \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    **Type 2:**</span>
<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov} \geq \mathcal{B} \mathcal{I}_{\mathrm{Bayes}}^{-1} \mathcal{B} </span>
<span class="sd">        + \int p(\textbf{x}) \textbf{b} \textbf{b}^{\mathrm{T}} \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    **Type 3:**</span>
<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov} \geq \int p(\textbf{x}) \mathcal{G} \left( \mathcal{I}_p </span>
<span class="sd">        + \mathcal{I} \right)^{-1} \mathcal{G}^{\mathrm{T}} \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols:</span>
<span class="sd">        - $\textbf{b}$: bias vector</span>
<span class="sd">        - $\textbf{b}&#39;$: its derivatives</span>
<span class="sd">        - $B$: diagonal matrix with $B_{ii} = 1 + [\textbf{b}&#39;]_{i}$</span>
<span class="sd">        - $\mathcal{I}$: classical Fisher information matrix (CFIM)</span>
<span class="sd">        - $\mathcal{B} = \int p(\textbf{x}) B \mathrm{d}\textbf{x}$</span>
<span class="sd">        - $\mathcal{I}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{I} \mathrm{d}\textbf{x}$</span>
<span class="sd">        - $[\mathcal{I}_{p}]_{ab} = [\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]$</span>
<span class="sd">        - $\mathcal{G}_{ab} = [\partial_b \ln p(\textbf{x})][\textbf{b}]_a + B_{aa}\delta_{ab}$</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            Parameter regimes for integration.</span>
<span class="sd">        p (np.array): </span>
<span class="sd">            Prior distribution over the parameter space. Must have the same dimensions </span>
<span class="sd">            as the product of the lengths of the arrays in `x`.</span>
<span class="sd">        dp (list): </span>
<span class="sd">            Derivatives of the prior distribution with respect to the parameters.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrices. Each element corresponds to </span>
<span class="sd">            a point in the parameter space defined by `x`.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrices with respect to </span>
<span class="sd">            the parameters. `drho[i][j]` is the derivative of the density matrix at the i-th </span>
<span class="sd">            parameter point with respect to the j-th parameter.</span>
<span class="sd">        M (list, optional): </span>
<span class="sd">            Positive operator-valued measure (POVM). Default is </span>
<span class="sd">            a set of rank-one symmetric informationally complete POVM (SIC-POVM).</span>
<span class="sd">        b (list, optional): </span>
<span class="sd">            Bias vector. Default is zero bias.</span>
<span class="sd">        db (list, optional): </span>
<span class="sd">            Derivatives of the bias vector. Default is zero.</span>
<span class="sd">        btype (int, optional): </span>
<span class="sd">            Type of BCRB to calculate (1, 2, or 3).</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon for numerical stability.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (length of `x` is 1), returns BCRB. </span>
<span class="sd">            For multiparameter estimation (length of `x` &gt; 1), returns BCRB matrix.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `M` is provided but not a list.</span>
<span class="sd">        NameError: If `btype` is not in {1, 2, 3}.</span>

<span class="sd">    Notes:</span>
<span class="sd">        SIC-POVM is calculated using Weyl-Heisenberg covariant SIC-POVM fiducial states </span>
<span class="sd">        available at [http://www.physics.umb.edu/Research/QBism/solutions.html](http://www.physics.umb.edu/Research/QBism/solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F1</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">F1</span> <span class="o">+</span> <span class="n">bb</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">I_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">I_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">b</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">b_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
        <span class="n">db_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">db</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>
        <span class="n">dp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dpi</span> <span class="k">for</span> <span class="n">dpi</span> <span class="ow">in</span> <span class="n">dp_ext</span><span class="p">]</span>

        <span class="n">b_list</span><span class="p">,</span> <span class="n">db_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b_ele</span><span class="p">,</span> <span class="n">db_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">b_pro</span><span class="p">,</span> <span class="n">db_pro</span><span class="p">):</span>
            <span class="n">b_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">b_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="n">db_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">db_ele</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">F_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">term1</span> <span class="o">=</span> <span class="n">B</span> <span class="o">@</span> <span class="n">F_inv</span> <span class="o">@</span> <span class="n">B</span>
                <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">term1</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">+</span> <span class="n">term2</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">B_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">bb_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">B_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">bb_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">B_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">B_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">bb_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bb_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="n">B_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="n">bb_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">B_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">bb_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bb_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">B_mn</span>
                    <span class="n">arr3</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">bb_mn</span>
                    <span class="k">for</span> <span class="n">sj</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr2</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                        <span class="n">arr3</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                    <span class="n">B_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                    <span class="n">bb_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr3</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">B_res</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span><span class="p">)</span> <span class="o">@</span> <span class="n">B_res</span> <span class="o">+</span> <span class="n">bb_res</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">I_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="n">G_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">pm</span> <span class="o">==</span> <span class="n">pn</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">I_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>

                <span class="n">F_tot</span> <span class="o">=</span> <span class="n">G_tp</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span> <span class="o">+</span> <span class="n">I_tp</span><span class="p">)</span> <span class="o">@</span> <span class="n">G_tp</span><span class="o">.</span><span class="n">T</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tot</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="bayesian-quantum-cramer-rao-bound-bqcrb">Bayesian quantum Cramér-Rao bound (BQCRB)<a class="headerlink" href="#bayesian-quantum-cramer-rao-bound-bqcrb" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.BQCRB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian quantum Cramer-Rao bound (BQCRB). </p>
<p>The covariance matrix with a prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> is defined as</p>
<div class="arithmatex">\[
    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})=\int p(\textbf{x})\sum_y\mathrm{Tr}
    (\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
    \mathrm{d}\textbf{x},
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}\)</span>: the unknown parameters to be estimated
    and the integral <span class="arithmatex">\(\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots\)</span>.</li>
<li><span class="arithmatex">\(\{\Pi_y\}\)</span>: a set of positive operator-valued measure (POVM). </li>
<li><span class="arithmatex">\(\rho\)</span>: the parameterized density matrix.</li>
</ul>
</details>      <p>This function calculates three types of the BQCRB. The first one is</p>
<div class="arithmatex">\[
    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq\int p(\textbf{x})\left(B\mathcal{F}^{-1}B
    +\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x},
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(\textbf{b}\)</span> and <span class="arithmatex">\(\textbf{b}'\)</span>: the vectors of biase and its derivatives on parameters.</li>
<li><span class="arithmatex">\(B\)</span>: a diagonal matrix with the <span class="arithmatex">\(i\)</span>th entry <span class="arithmatex">\(B_{ii}=1+[\textbf{b}']_{i}\)</span></li>
<li><span class="arithmatex">\(\mathcal{F}\)</span>: the QFIM for all types.</li>
</ul>
</details>      <p>The second one is</p>
<div class="arithmatex">\[
    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \mathcal{B}\,\mathcal{F}_{\mathrm{Bayes}}^{-1}\,
    \mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x},
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(\mathcal{B}=\int p(\textbf{x})B\mathrm{d}\textbf{x}\)</span>: the average of <span class="arithmatex">\(B\)</span> </li>
<li><span class="arithmatex">\(\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}\mathrm{d}\textbf{x}\)</span>: the average QFIM.</li>
</ul>
</details>      <p>The third one is</p>
<div class="arithmatex">\[
    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \int p(\textbf{x})
    \mathcal{G}\left(\mathcal{I}_p+\mathcal{F}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}.
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\([\mathcal{I}_{p}]_{ab}:=[\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]\)</span>.</li>
<li><span class="arithmatex">\(\mathcal{G}_{ab}:=[\partial_b\ln p(\textbf{x})][\textbf{b}]_a+B_{aa}\delta_{ab}\)</span>.</li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The regimes of the parameters for the integral.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code>(<span title="numpy.array">array</span>, multidimensional)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The prior distribution.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>(list, multidimensional)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrix.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>(list, multidimensional)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the parameterized density matrix (rho) with respect to the unknown parameters to be estimated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>b</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vector of biases of the form <span class="arithmatex">\(\textbf{b}=(b(x_0),b(x_1),\dots)^{\mathrm{T}}\)</span>.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>db</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of b with respect to the unknown parameters to be estimated, It should be 
expressed as <span class="arithmatex">\(\textbf{b}'=(\partial_0 b(x_0),\partial_1 b(x_1),\dots)^{\mathrm{T}}\)</span>.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>btype</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Types of the BQCRB. Options are:<br />
    1 (default) -- It means to calculate the first type of the BQCRB.<br />
    2 -- It means to calculate the second type of the BQCRB.
    3 -- It means to calculate the third type of the BCRB.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>LDtype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Types of QFI (QFIM) can be set as the objective function. Options are:<br />
    - "SLD" (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).<br />
    - "RLD" -- QFI (QFIM) based on right logarithmic derivative (RLD).<br />
    - "LLD" -- QFI (QFIM) based on left logarithmic derivative (LLD).</p>
            </div>
          </td>
          <td>
                <code>&#39;SLD&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>(float, optional)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter estimation (the length of <code>x</code> equals to one), the 
output is a float and for multiparameter estimation (the length of <code>x</code> is larger than one), 
it returns a matrix.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BQCRB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">[],</span> <span class="n">db</span><span class="o">=</span><span class="p">[],</span> <span class="n">btype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian quantum Cramer-Rao bound (BQCRB). </span>

<span class="sd">    The covariance matrix with a prior distribution $p(\textbf{x})$ is defined as</span>

<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})=\int p(\textbf{x})\sum_y\mathrm{Tr}</span>
<span class="sd">        (\rho\Pi_y)(\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">        \mathrm{d}\textbf{x},</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols:</span>
<span class="sd">        - $\textbf{x}=(x_0,x_1,\dots)^{\mathrm{T}}$: the unknown parameters to be estimated</span>
<span class="sd">            and the integral $\int\mathrm{d}\textbf{x}:=\iiint\mathrm{d}x_0\mathrm{d}x_1\cdots$.</span>
<span class="sd">        - $\{\Pi_y\}$: a set of positive operator-valued measure (POVM). </span>
<span class="sd">        - $\rho$: the parameterized density matrix.</span>

<span class="sd">    This function calculates three types of the BQCRB. The first one is</span>

<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq\int p(\textbf{x})\left(B\mathcal{F}^{-1}B</span>
<span class="sd">        +\textbf{b}\textbf{b}^{\mathrm{T}}\right)\mathrm{d}\textbf{x},</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols: </span>
<span class="sd">        - $\textbf{b}$ and $\textbf{b}&#39;$: the vectors of biase and its derivatives on parameters.</span>
<span class="sd">        - $B$: a diagonal matrix with the $i$th entry $B_{ii}=1+[\textbf{b}&#39;]_{i}$</span>
<span class="sd">        - $\mathcal{F}$: the QFIM for all types.</span>

<span class="sd">    The second one is</span>

<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \mathcal{B}\,\mathcal{F}_{\mathrm{Bayes}}^{-1}\,</span>
<span class="sd">        \mathcal{B}+\int p(\textbf{x})\textbf{b}\textbf{b}^{\mathrm{T}}\mathrm{d}\textbf{x},</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols: </span>
<span class="sd">        - $\mathcal{B}=\int p(\textbf{x})B\mathrm{d}\textbf{x}$: the average of $B$ </span>
<span class="sd">        - $\mathcal{F}_{\mathrm{Bayes}}=\int p(\textbf{x})\mathcal{F}\mathrm{d}\textbf{x}$: the average QFIM.</span>

<span class="sd">    The third one is</span>

<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\})\geq \int p(\textbf{x})</span>
<span class="sd">        \mathcal{G}\left(\mathcal{I}_p+\mathcal{F}\right)^{-1}\mathcal{G}^{\mathrm{T}}\mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols: </span>
<span class="sd">        - $[\mathcal{I}_{p}]_{ab}:=[\partial_a \ln p(\textbf{x})][\partial_b \ln p(\textbf{x})]$.</span>
<span class="sd">        - $\mathcal{G}_{ab}:=[\partial_b\ln p(\textbf{x})][\textbf{b}]_a+B_{aa}\delta_{ab}$.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            The regimes of the parameters for the integral.</span>
<span class="sd">        p (np.array, multidimensional): </span>
<span class="sd">            The prior distribution.</span>
<span class="sd">        rho (list, multidimensional): </span>
<span class="sd">            Parameterized density matrix.</span>
<span class="sd">        drho (list, multidimensional): </span>
<span class="sd">            Derivatives of the parameterized density matrix (rho) with respect to the unknown parameters to be estimated.</span>
<span class="sd">        b (list): </span>
<span class="sd">            Vector of biases of the form $\textbf{b}=(b(x_0),b(x_1),\dots)^{\mathrm{T}}$.</span>
<span class="sd">        db (list): </span>
<span class="sd">            Derivatives of b with respect to the unknown parameters to be estimated, It should be </span>
<span class="sd">            expressed as $\textbf{b}&#39;=(\partial_0 b(x_0),\partial_1 b(x_1),\dots)^{\mathrm{T}}$.</span>
<span class="sd">        btype (int): </span>
<span class="sd">            Types of the BQCRB. Options are:  </span>
<span class="sd">                1 (default) -- It means to calculate the first type of the BQCRB.  </span>
<span class="sd">                2 -- It means to calculate the second type of the BQCRB.</span>
<span class="sd">                3 -- It means to calculate the third type of the BCRB.</span>
<span class="sd">        LDtype (str): </span>
<span class="sd">            Types of QFI (QFIM) can be set as the objective function. Options are:  </span>
<span class="sd">                - &quot;SLD&quot; (default) -- QFI (QFIM) based on symmetric logarithmic derivative (SLD).  </span>
<span class="sd">                - &quot;RLD&quot; -- QFI (QFIM) based on right logarithmic derivative (RLD).  </span>
<span class="sd">                - &quot;LLD&quot; -- QFI (QFIM) based on left logarithmic derivative (LLD).</span>
<span class="sd">        eps (float,optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter estimation (the length of `x` equals to one), the </span>
<span class="sd">            output is a float and for multiparameter estimation (the length of `x` is larger than one), </span>
<span class="sd">            it returns a matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F2</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">B</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">B</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">F2</span> <span class="o">+</span> <span class="n">bb</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">I_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">db</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">I_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">F</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">b</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">b_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
        <span class="n">db_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">db</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>
        <span class="n">dp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dpi</span> <span class="k">for</span> <span class="n">dpi</span> <span class="ow">in</span> <span class="n">dp_ext</span><span class="p">]</span>

        <span class="n">b_list</span><span class="p">,</span> <span class="n">db_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">b_ele</span><span class="p">,</span> <span class="n">db_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">b_pro</span><span class="p">,</span> <span class="n">db_pro</span><span class="p">):</span>
            <span class="n">b_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">b_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="n">db_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">db_ele</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">F_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span><span class="p">)</span>
                <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">term1</span> <span class="o">=</span> <span class="n">B</span> <span class="o">@</span> <span class="n">F_inv</span> <span class="o">@</span> <span class="n">B</span>
                <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">term1</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">+</span> <span class="n">term2</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">B_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">bb_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">B_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
                <span class="n">bb_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">para_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">B_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">B_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                        <span class="n">bb_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bb_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="n">B_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="n">bb_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">B_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">bb_mn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bb_list</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">B_mn</span>
                    <span class="n">arr3</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">bb_mn</span>
                    <span class="k">for</span> <span class="n">sj</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr2</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                        <span class="n">arr3</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr3</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                    <span class="n">B_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                    <span class="n">bb_res</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr3</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">B_res</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span><span class="p">)</span> <span class="o">@</span> <span class="n">B_res</span> <span class="o">+</span> <span class="n">bb_res</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
                <span class="n">I_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="n">G_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">pm</span> <span class="o">==</span> <span class="n">pn</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">db_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">G_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span><span class="o">*</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span><span class="o">/</span><span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">I_tp</span><span class="p">[</span><span class="n">pm</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pm</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pn</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>

                <span class="n">F_tot</span> <span class="o">=</span> <span class="n">G_tp</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_tp</span> <span class="o">+</span> <span class="n">I_tp</span><span class="p">)</span> <span class="o">@</span> <span class="n">G_tp</span><span class="o">.</span><span class="n">T</span>
                <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                        <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tot</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;NameError: btype should be choosen in {1, 2, 3}.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="optimal-biased-bound-obb">Optimal biased bound (OBB)<a class="headerlink" href="#optimal-biased-bound-obb" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.OBB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculate the optimal biased bound (OBB) for single parameter estimation.</p>
<p>The OBB is defined as:</p>
<div class="arithmatex">\[
\mathrm{var}(\hat{x},\{\Pi_y\}) \geq \int p(x) \left( \frac{(1+b')^2}{F} + b^2 \right) \mathrm{d}x
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(b\)</span>: bias, <span class="arithmatex">\(b'\)</span>: its derivative.</li>
<li><span class="arithmatex">\(F\)</span>: quantum Fisher information (QFI).</li>
</ul>
</details>      <p>This bound is solved using a boundary value problem approach.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter regime for integration.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prior distribution.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dp</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivative of the prior distribution with respect to the parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>First derivatives of the density matrices with respect to the parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>d2rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Second-order derivatives of the density matrices with respect to the parameter.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>LDtype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of logarithmic derivative (default: "SLD"). Options:<br />
    - "SLD": Symmetric logarithmic derivative.<br />
    - "RLD": Right logarithmic derivative.<br />
    - "LLD": Left logarithmic derivative.  </p>
            </div>
          </td>
          <td>
                <code>&#39;SLD&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The optimal biased bound value for single parameter estimation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>This function uses a boundary value problem solver to compute the optimal bias function.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">OBB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">d2rho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the optimal biased bound (OBB) for single parameter estimation.</span>

<span class="sd">    The OBB is defined as:</span>

<span class="sd">    $$</span>
<span class="sd">    \mathrm{var}(\hat{x},\{\Pi_y\}) \geq \int p(x) \left( \frac{(1+b&#39;)^2}{F} + b^2 \right) \mathrm{d}x</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols:</span>
<span class="sd">        - $b$: bias, $b&#39;$: its derivative.</span>
<span class="sd">        - $F$: quantum Fisher information (QFI).</span>

<span class="sd">    This bound is solved using a boundary value problem approach.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.array): </span>
<span class="sd">            Parameter regime for integration.</span>
<span class="sd">        p (np.array): </span>
<span class="sd">            Prior distribution.</span>
<span class="sd">        dp (np.array): </span>
<span class="sd">            Derivative of the prior distribution with respect to the parameter.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrices.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            First derivatives of the density matrices with respect to the parameter.</span>
<span class="sd">        d2rho (list): </span>
<span class="sd">            Second-order derivatives of the density matrices with respect to the parameter.</span>
<span class="sd">        LDtype (str, optional): </span>
<span class="sd">            Type of logarithmic derivative (default: &quot;SLD&quot;). Options:  </span>
<span class="sd">                - &quot;SLD&quot;: Symmetric logarithmic derivative.  </span>
<span class="sd">                - &quot;RLD&quot;: Right logarithmic derivative.  </span>
<span class="sd">                - &quot;LLD&quot;: Left logarithmic derivative.  </span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns: </span>
<span class="sd">        (float): </span>
<span class="sd">            The optimal biased bound value for single parameter estimation.</span>

<span class="sd">    Notes: </span>
<span class="sd">        This function uses a boundary value problem solver to compute the optimal bias function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#### single parameter scenario ####</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">d2rho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">d2rho</span> <span class="o">=</span> <span class="p">[</span><span class="n">d2rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">float</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">F</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
    <span class="n">bias</span><span class="p">,</span> <span class="n">dbias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">LD</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">exportLD</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">F</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">d2rho</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">@</span> <span class="n">LD</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="n">d2rho</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">@</span> <span class="n">LD</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
        <span class="n">term3</span> <span class="o">=</span> <span class="n">LD</span> <span class="o">@</span> <span class="n">LD</span> <span class="o">@</span> <span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
        <span class="n">dF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span> <span class="o">-</span> <span class="n">term3</span><span class="p">))</span>
        <span class="n">J</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">-</span> <span class="n">dF</span> <span class="o">/</span> <span class="n">f</span>

    <span class="n">y_guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">OBB_func</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">solve_bvp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y_guess</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sol</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">bias</span><span class="p">,</span> <span class="n">dbias</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dbias</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">bias</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">simpson</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="van-trees-bound-vtb">Van Trees bound (VTB)<a class="headerlink" href="#van-trees-bound-vtb" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.VTB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculate the Van Trees bound (VTB), a Bayesian version of the Cramer-Rao bound.</p>
<p>The covariance matrix with prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> is:</p>
<div class="arithmatex">\[
    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\}) = \int p(\textbf{x}) \sum_y \mathrm{Tr}
    (\rho\Pi_y) (\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
    \mathrm{d}\textbf{x}.
\]</div>
<p>The VTB is given by:</p>
<div class="arithmatex">\[
\mathrm{cov} \geq \left(\mathcal{I}_{\mathrm{prior}} + \mathcal{I}_{\mathrm{Bayes}}\right)^{-1}.
\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(\mathcal{I}_{\mathrm{prior}} = \int p(\textbf{x}) \mathcal{I}_{p} \, \mathrm{d}\textbf{x}\)</span> 
    is the classical Fisher information matrix (CFIM) for the prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span>.    </li>
<li><span class="arithmatex">\(\mathcal{I}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{I} \, \mathrm{d}\textbf{x}\)</span> 
    is the average CFIM over the prior.</li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter regimes for integration.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prior distribution.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dp</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the prior distribution with respect to the parameters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrices with respect to the parameters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>M</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Positive operator-valued measure (POVM). Default is SIC-POVM.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter: float. For multiple parameters: matrix.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>SIC-POVM uses Weyl-Heisenberg covariant fiducial states from 
<a href="http://www.physics.umb.edu/Research/QBism/solutions.html">http://www.physics.umb.edu/Research/QBism/solutions.html</a>.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">VTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Van Trees bound (VTB), a Bayesian version of the Cramer-Rao bound.</span>

<span class="sd">    The covariance matrix with prior distribution $p(\textbf{x})$ is:</span>

<span class="sd">    $$</span>
<span class="sd">        \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\}) = \int p(\textbf{x}) \sum_y \mathrm{Tr}</span>
<span class="sd">        (\rho\Pi_y) (\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">        \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    The VTB is given by:</span>

<span class="sd">    $$</span>
<span class="sd">    \mathrm{cov} \geq \left(\mathcal{I}_{\mathrm{prior}} + \mathcal{I}_{\mathrm{Bayes}}\right)^{-1}.</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols:  </span>
<span class="sd">        - $\mathcal{I}_{\mathrm{prior}} = \int p(\textbf{x}) \mathcal{I}_{p} \, \mathrm{d}\textbf{x}$ </span>
<span class="sd">            is the classical Fisher information matrix (CFIM) for the prior distribution $p(\textbf{x})$.    </span>
<span class="sd">        - $\mathcal{I}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{I} \, \mathrm{d}\textbf{x}$ </span>
<span class="sd">            is the average CFIM over the prior.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            Parameter regimes for integration.</span>
<span class="sd">        p (np.array): </span>
<span class="sd">            Prior distribution.</span>
<span class="sd">        dp (list): </span>
<span class="sd">            Derivatives of the prior distribution with respect to the parameters.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrices.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrices with respect to the parameters.</span>
<span class="sd">        M (list, optional): </span>
<span class="sd">            Positive operator-valued measure (POVM). Default is SIC-POVM.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter: float. For multiple parameters: matrix.</span>

<span class="sd">    Notes: </span>
<span class="sd">        SIC-POVM uses Weyl-Heisenberg covariant fiducial states from </span>
<span class="sd">        [http://www.physics.umb.edu/Research/QBism/solutions.html](http://www.physics.umb.edu/Research/QBism/solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="n">F</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>
        <span class="n">dp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dpi</span> <span class="k">for</span> <span class="n">dpi</span> <span class="ow">in</span> <span class="n">dp_ext</span><span class="p">]</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">I_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
            <span class="n">F_tp</span> <span class="o">=</span> <span class="n">CFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                    <span class="n">I_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pj</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
                        <span class="p">)</span>

        <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="n">I_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">I_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">I_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">arr1</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">I_ij</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">arr1</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span> <span class="o">+</span> <span class="n">I_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="quantum-van-trees-bound-qvtb">Quantum Van Trees bound (QVTB)<a class="headerlink" href="#quantum-van-trees-bound-qvtb" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.QVTB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculate the quantum Van Trees bound (QVTB), a Bayesian version of the quantum Cramer-Rao bound.</p>
<p>The covariance matrix with prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span> is:</p>
<div class="arithmatex">\[
\mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\}) = \int p(\textbf{x}) \sum_y \mathrm{Tr}
(\rho\Pi_y) (\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}
\mathrm{d}\textbf{x}.
\]</div>
<p>The QVTB is given by:</p>
<p>$$
\mathrm{cov} \geq \left(\mathcal{I}<em _mathrm_Bayes="\mathrm{Bayes">{\mathrm{prior}} + \mathcal{F}</em>.
$$}}\right)^{-1</p>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(\mathcal{I}_{\mathrm{prior}} = \int p(\textbf{x}) \mathcal{I}_{p} \, \mathrm{d}\textbf{x}\)</span>:<br />
    the classical Fisher information matrix (CFIM) for the prior distribution <span class="arithmatex">\(p(\textbf{x})\)</span>.</li>
<li><span class="arithmatex">\(\mathcal{F}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{F} \, \mathrm{d}\textbf{x}\)</span>:<br />
    the average quantum Fisher information matrix (QFIM) over the prior.</li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter regimes for integration.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prior distribution.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dp</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the prior distribution with respect to the parameters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>drho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Derivatives of the density matrices with respect to the parameters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>LDtype</code></td>
          <td>
                <code>string</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of logarithmic derivative (default: "SLD"). Options:<br />
    - "SLD": Symmetric logarithmic derivative.<br />
    - "RLD": Right logarithmic derivative.<br />
    - "LLD": Left logarithmic derivative.  </p>
            </div>
          </td>
          <td>
                <code>&#39;SLD&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float / <span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For single parameter: float. For multiple parameters: matrix.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesCramerRao.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">QVTB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">drho</span><span class="p">,</span> <span class="n">LDtype</span><span class="o">=</span><span class="s2">&quot;SLD&quot;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the quantum Van Trees bound (QVTB), a Bayesian version of the quantum Cramer-Rao bound.</span>

<span class="sd">    The covariance matrix with prior distribution $p(\textbf{x})$ is:</span>

<span class="sd">    $$</span>
<span class="sd">    \mathrm{cov}(\hat{\textbf{x}},\{\Pi_y\}) = \int p(\textbf{x}) \sum_y \mathrm{Tr}</span>
<span class="sd">    (\rho\Pi_y) (\hat{\textbf{x}}-\textbf{x})(\hat{\textbf{x}}-\textbf{x})^{\mathrm{T}}</span>
<span class="sd">    \mathrm{d}\textbf{x}.</span>
<span class="sd">    $$</span>

<span class="sd">    The QVTB is given by:</span>

<span class="sd">    \$$</span>
<span class="sd">    \mathrm{cov} \geq \left(\mathcal{I}_{\mathrm{prior}} + \mathcal{F}_{\mathrm{Bayes}}\right)^{-1}.</span>
<span class="sd">    $$</span>

<span class="sd">    Symbols:</span>
<span class="sd">        - $\mathcal{I}_{\mathrm{prior}} = \int p(\textbf{x}) \mathcal{I}_{p} \, \mathrm{d}\textbf{x}$:  </span>
<span class="sd">            the classical Fisher information matrix (CFIM) for the prior distribution $p(\textbf{x})$.</span>
<span class="sd">        - $\mathcal{F}_{\mathrm{Bayes}} = \int p(\textbf{x}) \mathcal{F} \, \mathrm{d}\textbf{x}$:  </span>
<span class="sd">            the average quantum Fisher information matrix (QFIM) over the prior.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            Parameter regimes for integration.</span>
<span class="sd">        p (np.array): </span>
<span class="sd">            Prior distribution.</span>
<span class="sd">        dp (list): </span>
<span class="sd">            Derivatives of the prior distribution with respect to the parameters.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrices.</span>
<span class="sd">        drho (list): </span>
<span class="sd">            Derivatives of the density matrices with respect to the parameters.</span>
<span class="sd">        LDtype (string, optional): </span>
<span class="sd">            Type of logarithmic derivative (default: &quot;SLD&quot;). Options:  </span>
<span class="sd">                - &quot;SLD&quot;: Symmetric logarithmic derivative.  </span>
<span class="sd">                - &quot;RLD&quot;: Right logarithmic derivative.  </span>
<span class="sd">                - &quot;LLD&quot;: Left logarithmic derivative.  </span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns: </span>
<span class="sd">        (float/np.array): </span>
<span class="sd">            For single parameter: float. For multiple parameters: matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">drho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">drho</span> <span class="o">=</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">dp</span> <span class="o">=</span> <span class="p">[</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>

        <span class="n">F_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">F_tp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="n">drho</span><span class="p">[</span><span class="n">m</span><span class="p">]],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>

        <span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">F_tp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="n">F</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">dp_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">drho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">drho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span><span class="p">,</span> <span class="n">drho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span><span class="p">,</span> <span class="n">drho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">,</span> <span class="n">drho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>
            <span class="n">drho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drho_ele</span><span class="p">)</span>
        <span class="n">dp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dpi</span> <span class="k">for</span> <span class="n">dpi</span> <span class="ow">in</span> <span class="n">dp_ext</span><span class="p">]</span>

        <span class="n">F_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="n">I_list</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
            <span class="n">F_tp</span> <span class="o">=</span> <span class="n">QFIM</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">drho_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">LDtype</span><span class="o">=</span><span class="n">LDtype</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">pk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">F_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">F_tp</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span>
                    <span class="n">I_list</span><span class="p">[</span><span class="n">pj</span><span class="p">][</span><span class="n">pk</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pj</span><span class="p">]</span> <span class="o">*</span> <span class="n">dp_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pk</span><span class="p">]</span> <span class="o">/</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
                        <span class="p">)</span>

        <span class="n">F_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="n">I_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_i</span><span class="p">,</span> <span class="n">para_num</span><span class="p">):</span>
                <span class="n">F_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">F_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">I_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">I_list</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">arr1</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">F_ij</span>
                <span class="n">arr2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">I_ij</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">arr1</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                    <span class="n">arr2</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">F_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr1</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">para_j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
                <span class="n">I_res</span><span class="p">[</span><span class="n">para_j</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr2</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">F_res</span> <span class="o">+</span> <span class="n">I_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="quantum-ziv-zakai-bound">Quantum Ziv-Zakai bound<a class="headerlink" href="#quantum-ziv-zakai-bound" title="Permanent link">&para;</a></h2>



<div class="doc doc-object doc-function">




<a id="quanestimation.QZZB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the quantum Ziv-Zakai bound (QZZB). The expression of QZZB with a 
prior distribution p(x) in a finite regime <span class="arithmatex">\([\alpha,\beta]\)</span> is</p>
<div class="arithmatex">\[\begin{aligned}
    \mathrm{var}(\hat{x},\{\Pi_y\}) \geq &amp;  \frac{1}{2}\int_0^\infty \mathrm{d}\tau\tau
    \mathcal{V}\int_{-\infty}^{\infty} \mathrm{d}x\min\!\left\{p(x), p(x+\tau)\right\} \nonumber \\
    &amp; \times\left(1-\frac{1}{2}||\rho(x)-\rho(x+\tau)||\right).
\end{aligned}\]</div>

<details class="symbols" open>
  <summary>Symbols</summary>
  <ul>
<li><span class="arithmatex">\(||\cdot||\)</span>: the trace norm</li>
<li><span class="arithmatex">\(\mathcal{V}\)</span>: the "valley-filling" operator satisfying <span class="arithmatex">\(\mathcal{V}f(\tau)=\max_{h\geq 0}f(\tau+h)\)</span>. </li>
<li><span class="arithmatex">\(\rho(x)\)</span>: the parameterized density matrix.</li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The regimes of the parameters for the integral.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The prior distribution as a multidimensional array.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrix as a multidimensional list.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon. Defaults to 1e-8.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Quantum Ziv-Zakai bound (QZZB).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the length of x and p do not match.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/ZivZakai.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">QZZB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the quantum Ziv-Zakai bound (QZZB). The expression of QZZB with a </span>
<span class="sd">    prior distribution p(x) in a finite regime $[\alpha,\beta]$ is</span>

<span class="sd">    \begin{aligned}</span>
<span class="sd">        \mathrm{var}(\hat{x},\{\Pi_y\}) \geq &amp;  \frac{1}{2}\int_0^\infty \mathrm{d}\tau\tau</span>
<span class="sd">        \mathcal{V}\int_{-\infty}^{\infty} \mathrm{d}x\min\!\left\{p(x), p(x+\tau)\right\} \nonumber \\</span>
<span class="sd">        &amp; \times\left(1-\frac{1}{2}||\rho(x)-\rho(x+\tau)||\right).</span>
<span class="sd">    \end{aligned}</span>

<span class="sd">    Symbols:</span>
<span class="sd">        - $||\cdot||$: the trace norm</span>
<span class="sd">        - $\mathcal{V}$: the &quot;valley-filling&quot; operator satisfying $\mathcal{V}f(\tau)=\max_{h\geq 0}f(\tau+h)$. </span>
<span class="sd">        - $\rho(x)$: the parameterized density matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            The regimes of the parameters for the integral.</span>
<span class="sd">        p (np.ndarray): </span>
<span class="sd">            The prior distribution as a multidimensional array.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrix as a multidimensional list.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon. Defaults to 1e-8.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): </span>
<span class="sd">            Quantum Ziv-Zakai bound (QZZB).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: </span>
<span class="sd">            If the length of x and p do not match.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="p">[</span><span class="n">xi</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">f_tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p_num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">helstrom_dm</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rho</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">],</span> <span class="n">eps</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">f_tp</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">p_num</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">f_tau</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">f_tp</span>
    <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">tau</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">f_tau</span><span class="p">[</span><span class="n">m</span><span class="p">:])</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">I</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="bayesian-estimation">Bayesian estimation<a class="headerlink" href="#bayesian-estimation" title="Permanent link">&para;</a></h2>
<h3 id="maximum-a-posteriori-probability-map">Maximum a posteriori probability (MAP)<a class="headerlink" href="#maximum-a-posteriori-probability-map" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.Bayes"></a>
  <div class="doc doc-contents first">
  
      <p>Bayesian estimation. The prior distribution is updated via the posterior 
distribution obtained by Bayes' rule. The estimated value of parameters are 
updated via either the expectation value of the distribution or maximum a 
posteriori probability (MAP).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The regimes of the parameters for the integral.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The prior distribution as a multidimensional array.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrix as a multidimensional list.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The experimental results obtained in practice.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>M</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A set of positive operator-valued measure (POVM). 
Defaults to a set of rank-one symmetric informationally complete 
POVM (SIC-POVM).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>estimator</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Estimators for the bayesian estimation. 
Options are:
    "mean" (default) - The expectation value of the distribution.
    "MAP" - Maximum a posteriori probability.</p>
            </div>
          </td>
          <td>
                <code>&#39;mean&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>savefile</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to save all posterior distributions. 
If True, generates "pout.npy" and "xout.npy" containing all 
posterior distributions and estimated values across iterations. 
If False, only saves the final posterior distribution and all 
estimated values. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pout (np.ndarray): 
    The posterior distribution in the final iteration.</p>
<p>xout (float/list): 
    The estimated values in the final iteration.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>M</code> is not a list.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If estimator is not "mean" or "MAP".</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Bayes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bayesian estimation. The prior distribution is updated via the posterior </span>
<span class="sd">    distribution obtained by Bayes&#39; rule. The estimated value of parameters are </span>
<span class="sd">    updated via either the expectation value of the distribution or maximum a </span>
<span class="sd">    posteriori probability (MAP).</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): The regimes of the parameters for the integral.</span>
<span class="sd">        p (np.ndarray): The prior distribution as a multidimensional array.</span>
<span class="sd">        rho (list): Parameterized density matrix as a multidimensional list.</span>
<span class="sd">        y (np.ndarray): The experimental results obtained in practice.</span>
<span class="sd">        M (list, optional): A set of positive operator-valued measure (POVM). </span>
<span class="sd">            Defaults to a set of rank-one symmetric informationally complete </span>
<span class="sd">            POVM (SIC-POVM).</span>
<span class="sd">        estimator (str, optional): Estimators for the bayesian estimation. </span>
<span class="sd">            Options are:</span>
<span class="sd">                &quot;mean&quot; (default) - The expectation value of the distribution.</span>
<span class="sd">                &quot;MAP&quot; - Maximum a posteriori probability.</span>
<span class="sd">        savefile (bool, optional): Whether to save all posterior distributions. </span>
<span class="sd">            If True, generates &quot;pout.npy&quot; and &quot;xout.npy&quot; containing all </span>
<span class="sd">            posterior distributions and estimated values across iterations. </span>
<span class="sd">            If False, only saves the final posterior distribution and all </span>
<span class="sd">            estimated values. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): </span>
<span class="sd">            pout (np.ndarray): </span>
<span class="sd">                The posterior distribution in the final iteration.</span>

<span class="sd">            xout (float/list): </span>
<span class="sd">                The estimated values in the final iteration.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: </span>
<span class="sd">            If `M` is not a list.</span>
<span class="sd">        ValueError: </span>
<span class="sd">            If estimator is not &quot;mean&quot; or &quot;MAP&quot;.</span>

<span class="sd">    Note: </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">max_episode</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># Single parameter scenario</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">M</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;M must be a list&quot;</span><span class="p">)</span>

        <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">p_out</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
            <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
            <span class="n">pyx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="c1"># Calculate conditional probabilities</span>
            <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">]))</span>
                <span class="n">pyx</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>

            <span class="c1"># Update posterior distribution</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">pyx</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>
            <span class="n">py</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">p_update</span> <span class="o">=</span> <span class="n">pyx</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="n">py</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p_update</span><span class="p">)</span>

            <span class="c1"># Handle estimator type</span>
            <span class="k">if</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
                <span class="n">mean</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;MAP&quot;</span><span class="p">:</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">indx</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid estimator: </span><span class="si">{}</span><span class="s2">. Supported values are &#39;mean&#39; and &#39;MAP&#39;&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="c1"># Save intermediate results if requested</span>
            <span class="k">if</span> <span class="n">savefile</span><span class="p">:</span>
                <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="c1"># Save final results</span>
        <span class="k">if</span> <span class="n">savefile</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pout&quot;</span><span class="p">,</span> <span class="n">p_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pout&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Multiparameter scenario</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">M</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;M must be a list&quot;</span><span class="p">)</span>

        <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">p_out</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Always initialize as list</span>

        <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
            <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
            <span class="n">pyx_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">))</span>

            <span class="c1"># Calculate conditional probabilities</span>
            <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)):</span>
                <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">]))</span>
                <span class="n">pyx_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_tp</span>

            <span class="c1"># Reshape and update posterior distribution</span>
            <span class="n">pyx</span> <span class="o">=</span> <span class="n">pyx_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span>
            <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
            <span class="n">py</span> <span class="o">=</span> <span class="n">arr</span>
            <span class="n">p_update</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">pyx</span> <span class="o">/</span> <span class="n">py</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p_update</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p_update</span><span class="p">)</span>

            <span class="c1"># Handle estimator type</span>
            <span class="k">if</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
                <span class="n">mean</span> <span class="o">=</span> <span class="n">integ</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">estimator</span> <span class="o">==</span> <span class="s2">&quot;MAP&quot;</span><span class="p">:</span>
                <span class="c1"># Use unravel_index for better performance and type safety</span>
                <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">max_idx</span><span class="p">,</span> <span class="n">p_shape</span><span class="p">)</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid estimator: </span><span class="si">{</span><span class="n">estimator</span><span class="si">}</span><span class="s2">. Supported values are &#39;mean&#39; and &#39;MAP&#39;&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Save intermediate results if requested</span>
            <span class="k">if</span> <span class="n">savefile</span><span class="p">:</span>
                <span class="n">p_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="c1"># Save final results</span>
        <span class="k">if</span> <span class="n">savefile</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pout&quot;</span><span class="p">,</span> <span class="n">p_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;pout&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="maximum-likelihood-estimation-mle">Maximum likelihood estimation (MLE)<a class="headerlink" href="#maximum-likelihood-estimation-mle" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.MLE"></a>
  <div class="doc doc-contents first">
  
      <p>Maximum likelihood estimation (MLE) for parameter estimation.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The regimes of the parameters for the integral.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrix as a multidimensional list.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The experimental results obtained in practice.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>M</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A set of positive operator-valued measure (POVM). Defaults to a set of rank-one 
symmetric informationally complete POVM (SIC-POVM).</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>savefile</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to save all likelihood functions. If True, generates "Lout.npy" and 
"xout.npy" containing all likelihood functions and estimated values across 
iterations. If False, only saves the final likelihood function and all 
estimated values. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lout (np.ndarray): 
    The likelihood function in the final iteration.</p>
<p>xout (float/list): 
    The estimated values in the final iteration.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>M</code> is not a list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state 
which can be downloaded from <a href="http://www.physics.umb.edu/Research/QBism/solutions.html">here</a>.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">MLE</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="p">[],</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Maximum likelihood estimation (MLE) for parameter estimation.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            The regimes of the parameters for the integral.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrix as a multidimensional list.</span>
<span class="sd">        y (np.ndarray): </span>
<span class="sd">            The experimental results obtained in practice.</span>
<span class="sd">        M (list, optional): </span>
<span class="sd">            A set of positive operator-valued measure (POVM). Defaults to a set of rank-one </span>
<span class="sd">            symmetric informationally complete POVM (SIC-POVM).</span>
<span class="sd">        savefile (bool, optional): </span>
<span class="sd">            Whether to save all likelihood functions. If True, generates &quot;Lout.npy&quot; and </span>
<span class="sd">            &quot;xout.npy&quot; containing all likelihood functions and estimated values across </span>
<span class="sd">            iterations. If False, only saves the final likelihood function and all </span>
<span class="sd">            estimated values. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): </span>
<span class="sd">            Lout (np.ndarray): </span>
<span class="sd">                The likelihood function in the final iteration.</span>

<span class="sd">            xout (float/list): </span>
<span class="sd">                The estimated values in the final iteration.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If `M` is not a list.</span>

<span class="sd">    Note: </span>
<span class="sd">        SIC-POVM is calculated by the Weyl-Heisenberg covariant SIC-POVM fiducial state </span>
<span class="sd">        which can be downloaded from [here](http://www.physics.umb.edu/Research/QBism/solutions.html).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">max_episode</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#### single parameter scenario ####</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">savefile</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">L_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">]))</span>
                    <span class="n">L_out</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_out</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_out</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">L_out</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">indx</span><span class="p">])</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">L_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">]))</span>
                    <span class="n">L_tp</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_tp</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_tp</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">L_tp</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">L_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L_tp</span><span class="p">)</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">indx</span><span class="p">])</span>

            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">L_tp</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#### multiparameter scenario ####</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
            <span class="n">p_shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="n">rho_ext</span><span class="p">:</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">savefile</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">x_out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">L_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">)):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">]))</span>
                    <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">L_out</span> <span class="o">=</span> <span class="n">L_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_out</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">L_out</span><span class="p">))</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L_out</span><span class="p">,</span> <span class="n">x_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">L_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_episode</span><span class="p">):</span>
                <span class="n">res_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">)):</span>
                    <span class="n">p_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">res_exp</span><span class="p">]))</span>
                    <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">=</span> <span class="n">L_list</span><span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_tp</span>
                <span class="n">L_tp</span> <span class="o">=</span> <span class="n">L_list</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">L_tp</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">L_tp</span><span class="p">))</span>
                <span class="n">L_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L_tp</span><span class="p">)</span>
                <span class="n">x_out</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">indx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;Lout&quot;</span><span class="p">,</span> <span class="n">L_out</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;xout&quot;</span><span class="p">,</span> <span class="n">x_out</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">L_tp</span><span class="p">,</span> <span class="n">x_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="average-bayesian-cost-bayescost">Average Bayesian cost (BayesCost)<a class="headerlink" href="#average-bayesian-cost-bayescost" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.BayesCost"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the average Bayesian cost with a quadratic cost function.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The regimes of the parameters for the integral.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The prior distribution as a multidimensional array.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>xest</code></td>
          <td>
                <code>float or list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The estimators. xest is a float for single-parameter estimation
and a list for multi-parameter estimation.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrix as a multidimensional list.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>M</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A set of positive operator-valued measure (POVM).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>W</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weight matrix. Defaults to an identity matrix.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The average Bayesian cost.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>M</code> is not a list.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BayesCost</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">xest</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the average Bayesian cost with a quadratic cost function.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            The regimes of the parameters for the integral.</span>
<span class="sd">        p (array): </span>
<span class="sd">            The prior distribution as a multidimensional array.</span>
<span class="sd">        xest (float or list): </span>
<span class="sd">            The estimators. xest is a float for single-parameter estimation</span>
<span class="sd">            and a list for multi-parameter estimation.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrix as a multidimensional list.</span>
<span class="sd">        M (list): </span>
<span class="sd">            A set of positive operator-valued measure (POVM).</span>
<span class="sd">        W (array, optional): </span>
<span class="sd">            Weight matrix. Defaults to an identity matrix.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): </span>
<span class="sd">            The average Bayesian cost.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: </span>
<span class="sd">            If `M` is not a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">W</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># single-parameter scenario</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="c1"># if isinstance(x, np.ndarray):</span>
        <span class="c1">#     x = [x]    </span>

        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xest</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">))])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># multi-parameter scenario</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">x_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x_ele</span> <span class="ow">in</span> <span class="n">x_pro</span><span class="p">:</span>
            <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">W</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please make sure M is a list!&quot;</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">x_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">xCx</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)):</span>
                <span class="n">xCx</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">@</span> <span class="n">M</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">x_tp</span><span class="o">-</span><span class="n">xest</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">W</span> <span class="o">@</span> <span class="p">(</span><span class="n">x_tp</span><span class="o">-</span><span class="n">xest</span><span class="p">[</span><span class="n">mi</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">xCx</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="bayesian-cost-bound-bcb">Bayesian cost bound (BCB)<a class="headerlink" href="#bayesian-cost-bound-bcb" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.BCB"></a>
  <div class="doc doc-contents first">
  
      <p>Calculation of the Bayesian cost bound with a quadratic cost function.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The regimes of the parameters for the integral.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>p</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The prior distribution as a multidimensional array.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rho</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameterized density matrix as a multidimensional list.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>W</code></td>
          <td>
                <code>array</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Weight matrix. Defaults to an identity matrix.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Machine epsilon. Defaults to 1e-8.</p>
            </div>
          </td>
          <td>
                <code>1e-08</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value of the minimum Bayesian cost.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>This function calculates the Bayesian cost bound for parameter estimation.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>quanestimation/BayesianBound/BayesEstimation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BCB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="p">[],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the Bayesian cost bound with a quadratic cost function.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list): </span>
<span class="sd">            The regimes of the parameters for the integral.</span>
<span class="sd">        p (array): </span>
<span class="sd">            The prior distribution as a multidimensional array.</span>
<span class="sd">        rho (list): </span>
<span class="sd">            Parameterized density matrix as a multidimensional list.</span>
<span class="sd">        W (array, optional): </span>
<span class="sd">            Weight matrix. Defaults to an identity matrix.</span>
<span class="sd">        eps (float, optional): </span>
<span class="sd">            Machine epsilon. Defaults to 1e-8.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float): </span>
<span class="sd">            The value of the minimum Bayesian cost.</span>

<span class="sd">    Note:</span>
<span class="sd">        This function calculates the Bayesian cost bound for parameter estimation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">para_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">para_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># single-parameter scenario</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="n">delta2_x</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rho_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="n">rho_pri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">dj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
                <span class="n">rho_avg_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">rho</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                <span class="n">rho_pri_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">rho</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                <span class="n">rho_avg</span><span class="p">[</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">rho_avg_arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">rho_pri</span><span class="p">[</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">rho_pri_arr</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="n">Lambda_avg</span><span class="p">(</span><span class="n">rho_avg</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_pri</span><span class="p">],</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">minBC</span> <span class="o">=</span> <span class="n">delta2_x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho_avg</span> <span class="o">@</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">@</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">minBC</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># multi-parameter scenario</span>
        <span class="n">p_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>
        <span class="n">rho_ext</span> <span class="o">=</span> <span class="n">extract_ele</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">para_num</span><span class="p">)</span>

        <span class="n">p_list</span><span class="p">,</span> <span class="n">rho_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_ele</span><span class="p">,</span> <span class="n">rho_ele</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p_ext</span><span class="p">,</span> <span class="n">rho_ext</span><span class="p">):</span>
            <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ele</span><span class="p">)</span>
            <span class="n">rho_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_ele</span><span class="p">)</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rho_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">p_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_list</span><span class="p">)</span>

        <span class="n">x_pro</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x_ele</span> <span class="ow">in</span> <span class="n">x_pro</span><span class="p">:</span>
            <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x_ele</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)])</span>

        <span class="k">if</span> <span class="n">W</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">para_num</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">):</span>
            <span class="n">x_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">xCx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_tp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x_tp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">xCx</span>
        <span class="n">delta2_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
            <span class="n">delta2_x</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">delta2_x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
        <span class="n">rho_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="n">rho_pri</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">dj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
                <span class="n">rho_avg_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_list</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">rho_list</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                <span class="n">rho_avg_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho_avg_arr</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                    <span class="n">rho_avg_tp</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">rho_avg_tp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
                <span class="n">rho_avg</span><span class="p">[</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_avg_tp</span>

                <span class="k">for</span> <span class="n">para_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                    <span class="n">rho_pri_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_list</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">x_list</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">para_i</span><span class="p">]</span><span class="o">*</span><span class="n">rho_list</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_num</span><span class="p">)]</span>
                    <span class="n">rho_pri_tp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho_pri_arr</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">p_shape</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">)):</span>
                        <span class="n">rho_pri_tp</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">rho_pri_tp</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>

                    <span class="n">rho_pri</span><span class="p">[</span><span class="n">para_i</span><span class="p">][</span><span class="n">di</span><span class="p">][</span><span class="n">dj</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_pri_tp</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="n">Lambda_avg</span><span class="p">(</span><span class="n">rho_avg</span><span class="p">,</span> <span class="n">rho_pri</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">Mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">para_num</span><span class="p">,</span> <span class="n">para_num</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">para_m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">para_n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">para_num</span><span class="p">):</span>
                <span class="n">Mat</span> <span class="o">+=</span> <span class="n">W</span><span class="p">[</span><span class="n">para_m</span><span class="p">][</span><span class="n">para_n</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="n">para_m</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">para_n</span><span class="p">])</span>

        <span class="n">minBC</span> <span class="o">=</span> <span class="n">delta2_x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">rho_avg</span> <span class="o">@</span> <span class="n">Mat</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">minBC</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><hr />
<h2 id="common-utilities">Common utilities<a class="headerlink" href="#common-utilities" title="Permanent link">&para;</a></h2>
<h3 id="bayes-input">Bayes input<a class="headerlink" href="#bayes-input" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.BayesInput"></a>
  <div class="doc doc-contents first">
  
      <p>Generate input variables for Bayesian estimation.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="numpy.array">array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameter regimes</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>func</code></td>
          <td>
                <code>callable</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Function returning H or K</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dfunc</code></td>
          <td>
                <code>callable</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Function returning dH or dK</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>channel</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>"dynamics" or "Kraus" (default: "dynamics")</p>
            </div>
          </td>
          <td>
                <code>&#39;dynamics&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple of (H_list, dH_list) or (K_list, dK_list)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>For invalid channel.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/Common/Common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">BayesInput</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">dfunc</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&quot;dynamics&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate input variables for Bayesian estimation.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.array): </span>
<span class="sd">            Parameter regimes</span>
<span class="sd">        func (callable): </span>
<span class="sd">            Function returning H or K</span>
<span class="sd">        dfunc (callable): </span>
<span class="sd">            Function returning dH or dK</span>
<span class="sd">        channel (str, optional): </span>
<span class="sd">            &quot;dynamics&quot; or &quot;Kraus&quot; (default: &quot;dynamics&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple): </span>
<span class="sd">            Tuple of (H_list, dH_list) or (K_list, dK_list)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: </span>
<span class="sd">            For invalid channel.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_all</span> <span class="o">=</span> <span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">channel</span> <span class="o">==</span> <span class="s2">&quot;dynamics&quot;</span><span class="p">:</span>
        <span class="n">H_list</span><span class="p">,</span> <span class="n">dH_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_all</span><span class="p">:</span>
            <span class="n">H_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xi</span><span class="p">))</span>
            <span class="n">dH_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfunc</span><span class="p">(</span><span class="o">*</span><span class="n">xi</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">H_list</span><span class="p">,</span> <span class="n">dH_list</span>
    <span class="k">elif</span> <span class="n">channel</span> <span class="o">==</span> <span class="s2">&quot;Kraus&quot;</span><span class="p">:</span>
        <span class="n">K_list</span><span class="p">,</span> <span class="n">dK_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x_all</span><span class="p">:</span>
            <span class="n">K_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xi</span><span class="p">))</span>
            <span class="n">dK_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfunc</span><span class="p">(</span><span class="o">*</span><span class="n">xi</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">K_list</span><span class="p">,</span> <span class="n">dK_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">{!r}</span><span class="s2"> is not a valid channel. Supported values: &quot;</span>
            <span class="s2">&quot;&#39;dynamics&#39; or &#39;Kraus&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="sic-povm">SIC-POVM<a class="headerlink" href="#sic-povm" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.SIC"></a>
  <div class="doc doc-contents first">
  
      <p>Generate SIC-POVM for given dimension.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dim</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the system.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of SIC-POVM elements.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If dimension &gt; 151.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/Common/Common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">SIC</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate SIC-POVM for given dimension.</span>

<span class="sd">    Args:</span>
<span class="sd">        dim (float): </span>
<span class="sd">            Dimension of the system.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): </span>
<span class="sd">            List of SIC-POVM elements.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: </span>
<span class="sd">            If dimension &gt; 151.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;=</span> <span class="mi">151</span><span class="p">:</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span>
            <span class="s2">&quot;sic_fiducial_vectors/d</span><span class="si">%d</span><span class="s2">.txt&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dim</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">fiducial</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.0</span><span class="n">j</span>
        <span class="n">fiducial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fiducial</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fiducial</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">sic_povm</span><span class="p">(</span><span class="n">fiducial</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">M</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The dimension of the space should be less or equal to 151.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div><h3 id="sun-generators">SU(<span class="arithmatex">\(N\)</span>) generators<a class="headerlink" href="#sun-generators" title="Permanent link">&para;</a></h3>



<div class="doc doc-object doc-function">




<a id="quanestimation.suN_generator"></a>
  <div class="doc doc-contents first">
  
      <p>Generate sorted SU(N) generators.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dimension of the system. </p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of SU(N) generators.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>quanestimation/Common/Common.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">suN_generator</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate sorted SU(N) generators.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (float): </span>
<span class="sd">            Dimension of the system. </span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): </span>
<span class="sd">            List of SU(N) generators.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">symm</span><span class="p">,</span> <span class="n">anti_symm</span><span class="p">,</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">suN_unsorted</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">anti_symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">symm</span> <span class="o">+</span> <span class="n">anti_symm</span> <span class="o">+</span> <span class="n">diag</span><span class="p">)</span>

        <span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">anti_symm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">diag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">repeat_times</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">m1</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">k1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">m1</span> <span class="o">+=</span> <span class="n">n1</span>
            <span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repeat_times</span><span class="p">):</span>
                <span class="n">Lambda</span><span class="p">[</span><span class="n">m1</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">symm</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span>
                <span class="n">Lambda</span><span class="p">[</span><span class="n">m1</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">anti_symm</span><span class="p">[</span><span class="n">k1</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="n">k1</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">repeat_times</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">k1</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">symm</span><span class="p">):</span>
                <span class="k">break</span>

        <span class="n">m2</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">m2</span> <span class="o">+=</span> <span class="n">n2</span>
            <span class="n">Lambda</span><span class="p">[</span><span class="n">m2</span><span class="p">]</span> <span class="o">=</span> <span class="n">diag</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="n">k2</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">k2</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">diag</span><span class="p">):</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">Lambda</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/mathjaxhelper.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>